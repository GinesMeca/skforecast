
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python library that eases using scikit-learn regressors as multi-step forecasters. It also works with any regressor compatible with the scikit-learn API (XGBoost, LightGBM, Ranger...).">
      
      
        <meta name="author" content="Joaquin Amat Rodrigo and Javier Escobar Ortiz">
      
      
        <link rel="canonical" href="https://joaquinamatrodrigo.github.io/skforecast/0.8.0/api/model_selection_multiseries.html">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.5.3">
    
    
      
        <title>model_selection_multiseries - Skforecast Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7a952b86.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-GR8X9Z9LKL"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-GR8X9Z9LKL",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-GR8X9Z9LKL",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="light" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#model_selection_multiseries" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Skforecast Docs" class="md-header__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast-orange-no-backgound.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Skforecast Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              model_selection_multiseries
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="light" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/JoaquinAmatRodrigo/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-tabs__link">
        Introduction to forecasting
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../user_guides/quick-start-skforecast.html" class="md-tabs__link">
      Quick start
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../user_guides/input-data.html" class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../examples/examples.html" class="md-tabs__link">
        Examples and tutorials
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="ForecasterAutoreg.html" class="md-tabs__link md-tabs__link--active">
        API Reference
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../faq/faq.html" class="md-tabs__link">
        FAQ and Tips
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../releases/releases.html" class="md-tabs__link">
      Releases
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Skforecast Docs" class="md-nav__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast-orange-no-backgound.png" alt="logo">

    </a>
    Skforecast Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/JoaquinAmatRodrigo/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Home" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Welcome to skforecast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-nav__link">
        Introduction to forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/quick-start-skforecast.html" class="md-nav__link">
        Quick start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/input-data.html" class="md-nav__link">
        User Guides
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples.html" class="md-nav__link">
        Examples and tutorials
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoreg.html" class="md-nav__link">
        API Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/faq.html" class="md-nav__link">
        FAQ and Tips
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../releases/releases.html" class="md-nav__link">
        Releases
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Introduction to forecasting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Introduction to forecasting" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Introduction to forecasting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-nav__link">
        Introduction to forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/forecaster-parameters.html" class="md-nav__link">
        Forecaster Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/forecaster-attributes.html" class="md-nav__link">
        Forecaster Attributes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/quick-start-skforecast.html" class="md-nav__link">
        Quick start
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          User Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="User Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/input-data.html" class="md-nav__link">
        Input data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/autoregresive-forecaster.html" class="md-nav__link">
        Recursive multi-step forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/direct-multi-step-forecasting.html" class="md-nav__link">
        Direct multi-step forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/independent-multi-time-series-forecasting.html" class="md-nav__link">
        Independent multi-time series forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/dependent-multi-series-multivariate-forecasting.html" class="md-nav__link">
        Dependent multivariate series forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/exogenous-variables.html" class="md-nav__link">
        Exogenous variables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/custom-predictors.html" class="md-nav__link">
        Custom predictors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/weighted-time-series-forecasting.html" class="md-nav__link">
        Weighted time series forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/backtesting.html" class="md-nav__link">
        Backtesting forecaster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/hyperparameter-tuning-and-lags-selection.html" class="md-nav__link">
        Hyperparameter tuning and lags selection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/sklearn-transformers-and-pipeline.html" class="md-nav__link">
        Scikit-learn Transformers and Pipelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/probabilistic-forecasting.html" class="md-nav__link">
        Probabilistic forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/feature-importances.html" class="md-nav__link">
        Feature importances
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/categorical-features.html" class="md-nav__link">
        Categorical features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-xgboost-lightgbm.html" class="md-nav__link">
        Forecasting with XGBoost and LightGBM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-sarimax-arima.html" class="md-nav__link">
        Forecasting SARIMAX and ARIMA models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/save-load-forecaster.html" class="md-nav__link">
        Save and load forecaster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecaster-in-production.html" class="md-nav__link">
        Forecaster in production
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/shap-values-skforecast.html" class="md-nav__link">
        Shap-values
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/skforecast-in-GPU.html" class="md-nav__link">
        Skforecast in GPU
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/plot-forecaster-residuals.html" class="md-nav__link">
        Plot forecaster residuals
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Examples and tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Examples and tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Examples and tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples.html" class="md-nav__link">
        Examples and tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoreg.html" class="md-nav__link">
        ForecasterAutoreg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoregCustom.html" class="md-nav__link">
        ForecasterAutoregCustom
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoregDirect.html" class="md-nav__link">
        ForecasterAutoregDirect
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiSeries.html" class="md-nav__link">
        ForecasterMultiSeries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiSeriesCustom.html" class="md-nav__link">
        ForecasterMultiSeriesCustom
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiVariate.html" class="md-nav__link">
        ForecasterMultiVariate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterSarimax.html" class="md-nav__link">
        ForecasterSarimax
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="model_selection.html" class="md-nav__link">
        model_selection
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          model_selection_multiseries
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="model_selection_multiseries.html" class="md-nav__link md-nav__link--active">
        model_selection_multiseries
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection_multiseries.model_selection_multiseries.backtesting_forecaster_multiseries" class="md-nav__link">
    backtesting_forecaster_multiseries()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection_multiseries.model_selection_multiseries.grid_search_forecaster_multiseries" class="md-nav__link">
    grid_search_forecaster_multiseries()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection_multiseries.model_selection_multiseries.random_search_forecaster_multiseries" class="md-nav__link">
    random_search_forecaster_multiseries()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection_multiseries.model_selection_multiseries.backtesting_forecaster_multivariate" class="md-nav__link">
    backtesting_forecaster_multivariate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection_multiseries.model_selection_multiseries.grid_search_forecaster_multivariate" class="md-nav__link">
    grid_search_forecaster_multivariate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection_multiseries.model_selection_multiseries.random_search_forecaster_multivariate" class="md-nav__link">
    random_search_forecaster_multivariate()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="model_selection_sarimax.html" class="md-nav__link">
        model_selection_sarimax
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="plot.html" class="md-nav__link">
        plot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="utils.html" class="md-nav__link">
        utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="exceptions.html" class="md-nav__link">
        exceptions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          FAQ and Tips
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="FAQ and Tips" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          FAQ and Tips
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/faq.html" class="md-nav__link">
        Table of contents
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/profiling-skforecast.html" class="md-nav__link">
        Profiling skforecast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/non-negative-predictions.html" class="md-nav__link">
        Avoid negative predictions when forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-time-series-with-missing-values.html" class="md-nav__link">
        Forecasting time series with missing values
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../releases/releases.html" class="md-nav__link">
        Releases
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection_multiseries.model_selection_multiseries.backtesting_forecaster_multiseries" class="md-nav__link">
    backtesting_forecaster_multiseries()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection_multiseries.model_selection_multiseries.grid_search_forecaster_multiseries" class="md-nav__link">
    grid_search_forecaster_multiseries()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection_multiseries.model_selection_multiseries.random_search_forecaster_multiseries" class="md-nav__link">
    random_search_forecaster_multiseries()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection_multiseries.model_selection_multiseries.backtesting_forecaster_multivariate" class="md-nav__link">
    backtesting_forecaster_multivariate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection_multiseries.model_selection_multiseries.grid_search_forecaster_multivariate" class="md-nav__link">
    grid_search_forecaster_multivariate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection_multiseries.model_selection_multiseries.random_search_forecaster_multivariate" class="md-nav__link">
    random_search_forecaster_multivariate()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/JoaquinAmatRodrigo/skforecast/edit/master/docs/api/model_selection_multiseries.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="model_selection_multiseries"><code>model_selection_multiseries</code><a class="headerlink" href="#model_selection_multiseries" title="Permanent link">&para;</a></h1>


  <div class="doc doc-object doc-function">



<h2 id="skforecast.model_selection_multiseries.model_selection_multiseries.backtesting_forecaster_multiseries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">backtesting_forecaster_multiseries</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#skforecast.model_selection_multiseries.model_selection_multiseries.backtesting_forecaster_multiseries" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

      <p>Backtesting for multi-series and multivariate forecasters.</p>
<p>If <code>refit</code> is False, the model is trained only once using the <code>initial_train_size</code>
first observations. If <code>refit</code> is True, the model is trained in each iteration
increasing the training set. A copy of the original forecaster is created so 
it is not modified during the process.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>forecaster</code></td>
        <td><code>ForecasterAutoregMultiSeries, ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate</code></td>
        <td><p>Forecaster model.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>series</code></td>
        <td><code>DataFrame</code></td>
        <td><p>Training time series.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>steps</code></td>
        <td><code>int</code></td>
        <td><p>Number of steps to predict.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>metric</code></td>
        <td><code>Union[str, Callable, list]</code></td>
        <td><p>Metric used to quantify the goodness of fit of the model.</p>
<p>If string:
    {'mean_squared_error', 'mean_absolute_error',
     'mean_absolute_percentage_error', 'mean_squared_log_error'}</p>
<p>If Callable:
    Function with arguments y_true, y_pred that returns a float.</p>
<p>If list:
    List containing multiple strings and/or Callables.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>initial_train_size</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Number of samples in the initial train split. If <code>None</code> and <code>forecaster</code> is already 
trained, no initial train is done and all data is used to evaluate the model. However, 
the first <code>len(forecaster.last_window)</code> observations are needed to create the 
initial predictors, so no predictions are calculated for them.</p>
<p><code>None</code> is only allowed when <code>refit</code> is <code>False</code>.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fixed_train_size</code></td>
        <td><code>bool</code></td>
        <td><p>If True, train size doesn't increase but moves by <code>steps</code> in each iteration.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>gap</code></td>
        <td><code>int</code></td>
        <td><p>Number of samples to be excluded after the end of each training set and 
before the test set.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>allow_incomplete_fold</code></td>
        <td><code>bool</code></td>
        <td><p>Last fold is allowed to have a smaller number of samples than the 
<code>test_size</code>. If <code>False</code>, the last fold is excluded.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>levels</code></td>
        <td><code>Union[str, list]</code></td>
        <td><p>Time series to be predicted. If <code>None</code> all levels will be predicted.
<strong>New in version 0.6.0</strong></p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>exog</code></td>
        <td><code>Union[pandas.core.series.Series, pandas.core.frame.DataFrame]</code></td>
        <td><p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>refit</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to re-fit the forecaster in each iteration.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>interval</code></td>
        <td><code>Optional[list]</code></td>
        <td><p>Confidence of the prediction interval estimated. Sequence of percentiles
to compute, which must be between 0 and 100 inclusive. If <code>None</code>, no
intervals are estimated. Only available for forecaster of type ForecasterAutoreg
and ForecasterAutoregCustom.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>n_boot</code></td>
        <td><code>int</code></td>
        <td><p>Number of bootstrapping iterations used to estimate prediction
intervals.</p></td>
        <td><code>500</code></td>
      </tr>
      <tr>
        <td><code>random_state</code></td>
        <td><code>int</code></td>
        <td><p>Sets a seed to the random generator, so that boot intervals are always 
deterministic.</p></td>
        <td><code>123</code></td>
      </tr>
      <tr>
        <td><code>in_sample_residuals</code></td>
        <td><code>bool</code></td>
        <td><p>If <code>True</code>, residuals from the training data are used as proxy of
prediction error to create prediction intervals.  If <code>False</code>, out_sample_residuals
are used if they are already stored inside the forecaster.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Print number of folds and index of training and validation sets used 
for backtesting.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>show_progress</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to show a progress bar. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[pandas.core.frame.DataFrame, pandas.core.frame.DataFrame]</code></td>
      <td><p>Value(s) of the metric(s). Index are the levels and columns the metrics.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>skforecast/model_selection_multiseries/model_selection_multiseries.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">backtesting_forecaster_multiseries</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Backtesting for multi-series and multivariate forecasters.</span>

<span class="sd">    If `refit` is False, the model is trained only once using the `initial_train_size`</span>
<span class="sd">    first observations. If `refit` is True, the model is trained in each iteration</span>
<span class="sd">    increasing the training set. A copy of the original forecaster is created so </span>
<span class="sd">    it is not modified during the process.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterAutoregMultiSeries, ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate</span>
<span class="sd">        Forecaster model.</span>

<span class="sd">    series : pandas DataFrame</span>
<span class="sd">        Training time series.</span>

<span class="sd">    steps : int</span>
<span class="sd">        Number of steps to predict.</span>

<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        If string:</span>
<span class="sd">            {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">             &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;}</span>

<span class="sd">        If Callable:</span>
<span class="sd">            Function with arguments y_true, y_pred that returns a float.</span>

<span class="sd">        If list:</span>
<span class="sd">            List containing multiple strings and/or Callables.</span>

<span class="sd">    initial_train_size : int, default `None`</span>
<span class="sd">        Number of samples in the initial train split. If `None` and `forecaster` is already </span>
<span class="sd">        trained, no initial train is done and all data is used to evaluate the model. However, </span>
<span class="sd">        the first `len(forecaster.last_window)` observations are needed to create the </span>
<span class="sd">        initial predictors, so no predictions are calculated for them.</span>

<span class="sd">        `None` is only allowed when `refit` is `False`.</span>

<span class="sd">    fixed_train_size : bool, default `True`</span>
<span class="sd">        If True, train size doesn&#39;t increase but moves by `steps` in each iteration.</span>

<span class="sd">    gap : int, default `0`</span>
<span class="sd">        Number of samples to be excluded after the end of each training set and </span>
<span class="sd">        before the test set.</span>

<span class="sd">    allow_incomplete_fold : bool, default `True`</span>
<span class="sd">        Last fold is allowed to have a smaller number of samples than the </span>
<span class="sd">        `test_size`. If `False`, the last fold is excluded.</span>

<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        Time series to be predicted. If `None` all levels will be predicted.</span>
<span class="sd">        **New in version 0.6.0**</span>

<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>

<span class="sd">    refit : bool, default `False`</span>
<span class="sd">        Whether to re-fit the forecaster in each iteration.</span>

<span class="sd">    interval : list, default `None`</span>
<span class="sd">        Confidence of the prediction interval estimated. Sequence of percentiles</span>
<span class="sd">        to compute, which must be between 0 and 100 inclusive. If `None`, no</span>
<span class="sd">        intervals are estimated. Only available for forecaster of type ForecasterAutoreg</span>
<span class="sd">        and ForecasterAutoregCustom.</span>

<span class="sd">    n_boot : int, default `500`</span>
<span class="sd">        Number of bootstrapping iterations used to estimate prediction</span>
<span class="sd">        intervals.</span>

<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random generator, so that boot intervals are always </span>
<span class="sd">        deterministic.</span>

<span class="sd">    in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of</span>
<span class="sd">        prediction error to create prediction intervals.  If `False`, out_sample_residuals</span>
<span class="sd">        are used if they are already stored inside the forecaster.</span>

<span class="sd">    verbose : bool, default `False`</span>
<span class="sd">        Print number of folds and index of training and validation sets used </span>
<span class="sd">        for backtesting.</span>

<span class="sd">    show_progress: bool, default `True`</span>
<span class="sd">        Whether to show a progress bar. Defaults to True.</span>

<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    metrics_levels : pandas DataFrame</span>
<span class="sd">        Value(s) of the metric(s). Index are the levels and columns the metrics.</span>

<span class="sd">    backtest_predictions : pandas DataFrame</span>
<span class="sd">        Value of predictions and their estimated interval if `interval` is not `None`.</span>
<span class="sd">        If there is more than one level, this structure will be repeated for each of them.</span>
<span class="sd">            column pred = predictions.</span>
<span class="sd">            column lower_bound = lower bound of the interval.</span>
<span class="sd">            column upper_bound = upper bound interval of the interval.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> 
                                         <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">,</span> 
                                         <span class="s1">&#39;ForecasterAutoregMultiVariate&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;`forecaster` must be of type `ForecasterAutoregMultiSeries`, &quot;</span>
             <span class="s2">&quot;`ForecasterAutoregMultiSeriesCustom` or `ForecasterAutoregMultiVariate`, &quot;</span>
             <span class="s2">&quot;for all other types of forecasters use the functions available in &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;the `model_selection` module. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">check_backtesting_input</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">series</span>                <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
        <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
        <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
        <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
        <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
        <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
        <span class="n">interval</span>              <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
        <span class="n">n_boot</span>                <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
        <span class="n">random_state</span>          <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
        <span class="n">in_sample_residuals</span>   <span class="o">=</span> <span class="n">in_sample_residuals</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">]</span> \
        <span class="ow">and</span> <span class="n">levels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;`levels` must be a `list` of column names, a `str` of a column name &quot;</span>
             <span class="s2">&quot;or `None` when using a `ForecasterAutoregMultiSeries` or &quot;</span>
             <span class="s2">&quot;`ForecasterAutoregMultiSeriesCustom`. If the forecaster is of type &quot;</span>
             <span class="s2">&quot;`ForecasterAutoregMultiVariate`, this argument is ignored.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ForecasterAutoregMultiVariate&#39;</span> \
        <span class="ow">and</span> <span class="n">levels</span> <span class="ow">and</span> <span class="n">levels</span> <span class="o">!=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">level</span> <span class="ow">and</span> <span class="n">levels</span> <span class="o">!=</span> <span class="p">[</span><span class="n">forecaster</span><span class="o">.</span><span class="n">level</span><span class="p">]:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`levels` argument have no use when the forecaster is of type &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;`ForecasterAutoregMultiVariate`. The level of this forecaster is &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">level</span><span class="si">}</span><span class="s2">, to predict another level, change the `level` &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;argument when initializing the forecaster.&quot;</span><span class="p">),</span>
             <span class="n">IgnoredArgumentWarning</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">refit</span><span class="p">:</span>
        <span class="n">metrics_levels</span><span class="p">,</span> <span class="n">backtest_predictions</span> <span class="o">=</span> <span class="n">_backtesting_forecaster_multiseries_refit</span><span class="p">(</span>
            <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
            <span class="n">series</span>                <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
            <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
            <span class="n">levels</span>                <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
            <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
            <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
            <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
            <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
            <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
            <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
            <span class="n">interval</span>              <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
            <span class="n">n_boot</span>                <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
            <span class="n">random_state</span>          <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
            <span class="n">in_sample_residuals</span>   <span class="o">=</span> <span class="n">in_sample_residuals</span><span class="p">,</span>
            <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
            <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">metrics_levels</span><span class="p">,</span> <span class="n">backtest_predictions</span> <span class="o">=</span> <span class="n">_backtesting_forecaster_multiseries_no_refit</span><span class="p">(</span>
            <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
            <span class="n">series</span>                <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
            <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
            <span class="n">levels</span>                <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
            <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
            <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
            <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
            <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
            <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
            <span class="n">interval</span>              <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
            <span class="n">n_boot</span>                <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
            <span class="n">random_state</span>          <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
            <span class="n">in_sample_residuals</span>   <span class="o">=</span> <span class="n">in_sample_residuals</span><span class="p">,</span>
            <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
            <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">metrics_levels</span><span class="p">,</span> <span class="n">backtest_predictions</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="skforecast.model_selection_multiseries.model_selection_multiseries.grid_search_forecaster_multiseries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">grid_search_forecaster_multiseries</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#skforecast.model_selection_multiseries.model_selection_multiseries.grid_search_forecaster_multiseries" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

      <p>Exhaustive search over specified parameter values for a Forecaster object.</p>
<p>Validation is done using multi-series backtesting.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>forecaster</code></td>
        <td><code>ForecasterAutoregMultiSeries, ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate</code></td>
        <td><p>Forcaster model.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>series</code></td>
        <td><code>DataFrame</code></td>
        <td><p>Training time series.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>param_grid</code></td>
        <td><code>dict</code></td>
        <td><p>Dictionary with parameters names (<code>str</code>) as keys and lists of parameter
settings to try as values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>steps</code></td>
        <td><code>int</code></td>
        <td><p>Number of steps to predict.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>metric</code></td>
        <td><code>Union[str, Callable, list]</code></td>
        <td><p>Metric used to quantify the goodness of fit of the model.</p>
<p>If string:
    {'mean_squared_error', 'mean_absolute_error',
     'mean_absolute_percentage_error', 'mean_squared_log_error'}</p>
<p>If Callable:
    Function with arguments y_true, y_pred that returns a float.</p>
<p>If list:
    List containing multiple strings and/or Callables.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>initial_train_size</code></td>
        <td><code>int</code></td>
        <td><p>Number of samples in the initial train split.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fixed_train_size</code></td>
        <td><code>bool</code></td>
        <td><p>If True, train size doesn't increase but moves by <code>steps</code> in each iteration.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>gap</code></td>
        <td><code>int</code></td>
        <td><p>Number of samples to be excluded after the end of each training set and 
before the test set.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>allow_incomplete_fold</code></td>
        <td><code>bool</code></td>
        <td><p>Last fold is allowed to have a smaller number of samples than the 
<code>test_size</code>. If <code>False</code>, the last fold is excluded.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>levels</code></td>
        <td><code>Union[str, list]</code></td>
        <td><p>level (<code>str</code>) or levels (<code>list</code>) at which the forecaster is optimized. 
If <code>None</code>, all levels are taken into account. The resulting metric will be
the average of the optimization of all levels.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>exog</code></td>
        <td><code>Union[pandas.core.series.Series, pandas.core.frame.DataFrame]</code></td>
        <td><p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>lags_grid</code></td>
        <td><code>Optional[list]</code></td>
        <td><p>Lists of <code>lags</code> to try. Only used if forecaster is an instance of 
<code>ForecasterAutoregMultiSeries</code> or <code>ForecasterAutoregMultiVariate</code>.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>refit</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to re-fit the forecaster in each iteration of backtesting.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>return_best</code></td>
        <td><code>bool</code></td>
        <td><p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Print number of folds used for cv or backtesting.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DataFrame</code></td>
      <td><p>Results for each combination of parameters.
    column levels = levels.
    column lags = predictions.
    column params = lower bound of the interval.
    column metric = metric(s) value(s) estimated for each combination of 
                    parameters. The resulting metric will be the average 
                    of the optimization of all levels.
    additional n columns with param = value.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>skforecast/model_selection_multiseries/model_selection_multiseries.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">grid_search_forecaster_multiseries</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exhaustive search over specified parameter values for a Forecaster object.</span>
<span class="sd">    Validation is done using multi-series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterAutoregMultiSeries, ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate</span>
<span class="sd">        Forcaster model.</span>

<span class="sd">    series : pandas DataFrame</span>
<span class="sd">        Training time series.</span>

<span class="sd">    param_grid : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and lists of parameter</span>
<span class="sd">        settings to try as values.</span>

<span class="sd">    steps : int</span>
<span class="sd">        Number of steps to predict.</span>

<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        If string:</span>
<span class="sd">            {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">             &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;}</span>

<span class="sd">        If Callable:</span>
<span class="sd">            Function with arguments y_true, y_pred that returns a float.</span>

<span class="sd">        If list:</span>
<span class="sd">            List containing multiple strings and/or Callables.</span>

<span class="sd">    initial_train_size : int </span>
<span class="sd">        Number of samples in the initial train split.</span>

<span class="sd">    fixed_train_size : bool, default `True`</span>
<span class="sd">        If True, train size doesn&#39;t increase but moves by `steps` in each iteration.</span>

<span class="sd">    gap : int, default `0`</span>
<span class="sd">        Number of samples to be excluded after the end of each training set and </span>
<span class="sd">        before the test set.</span>

<span class="sd">    allow_incomplete_fold : bool, default `True`</span>
<span class="sd">        Last fold is allowed to have a smaller number of samples than the </span>
<span class="sd">        `test_size`. If `False`, the last fold is excluded.</span>

<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        level (`str`) or levels (`list`) at which the forecaster is optimized. </span>
<span class="sd">        If `None`, all levels are taken into account. The resulting metric will be</span>
<span class="sd">        the average of the optimization of all levels.</span>

<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>

<span class="sd">    lags_grid : list of int, lists, np.narray or range, default `None`</span>
<span class="sd">        Lists of `lags` to try. Only used if forecaster is an instance of </span>
<span class="sd">        `ForecasterAutoregMultiSeries` or `ForecasterAutoregMultiVariate`.</span>

<span class="sd">    refit : bool, default `False`</span>
<span class="sd">        Whether to re-fit the forecaster in each iteration of backtesting.</span>

<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>

<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>

<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>
<span class="sd">            column levels = levels.</span>
<span class="sd">            column lags = predictions.</span>
<span class="sd">            column params = lower bound of the interval.</span>
<span class="sd">            column metric = metric(s) value(s) estimated for each combination of </span>
<span class="sd">                            parameters. The resulting metric will be the average </span>
<span class="sd">                            of the optimization of all levels.</span>
<span class="sd">            additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterGrid</span><span class="p">(</span><span class="n">param_grid</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters_multiseries</span><span class="p">(</span>
                  <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
                  <span class="n">series</span>                <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
                  <span class="n">param_grid</span>            <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
                  <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                  <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
                  <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
                  <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
                  <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
                  <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
                  <span class="n">levels</span>                <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
                  <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                  <span class="n">lags_grid</span>             <span class="o">=</span> <span class="n">lags_grid</span><span class="p">,</span>
                  <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
                  <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
                  <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span>
              <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="skforecast.model_selection_multiseries.model_selection_multiseries.random_search_forecaster_multiseries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">random_search_forecaster_multiseries</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">param_distributions</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#skforecast.model_selection_multiseries.model_selection_multiseries.random_search_forecaster_multiseries" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

      <p>Random search over specified parameter values or distributions for a Forecaster </p>
<p>object. Validation is done using multi-series backtesting.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>forecaster</code></td>
        <td><code>ForecasterAutoregMultiSeries, ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate</code></td>
        <td><p>Forcaster model.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>series</code></td>
        <td><code>DataFrame</code></td>
        <td><p>Training time series.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>param_distributions</code></td>
        <td><code>dict</code></td>
        <td><p>Dictionary with parameters names (<code>str</code>) as keys and 
distributions or lists of parameters to try.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>steps</code></td>
        <td><code>int</code></td>
        <td><p>Number of steps to predict.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>metric</code></td>
        <td><code>Union[str, Callable, list]</code></td>
        <td><p>Metric used to quantify the goodness of fit of the model.</p>
<p>If string:
    {'mean_squared_error', 'mean_absolute_error',
     'mean_absolute_percentage_error', 'mean_squared_log_error'}</p>
<p>If Callable:
    Function with arguments y_true, y_pred that returns a float.</p>
<p>If list:
    List containing multiple strings and/or Callables.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>initial_train_size</code></td>
        <td><code>int</code></td>
        <td><p>Number of samples in the initial train split.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fixed_train_size</code></td>
        <td><code>bool</code></td>
        <td><p>If True, train size doesn't increase but moves by <code>steps</code> in each iteration.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>gap</code></td>
        <td><code>int</code></td>
        <td><p>Number of samples to be excluded after the end of each training set and 
before the test set.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>allow_incomplete_fold</code></td>
        <td><code>bool</code></td>
        <td><p>Last fold is allowed to have a smaller number of samples than the 
<code>test_size</code>. If <code>False</code>, the last fold is excluded.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>levels</code></td>
        <td><code>Union[str, list]</code></td>
        <td><p>level (<code>str</code>) or levels (<code>list</code>) at which the forecaster is optimized. 
If <code>None</code>, all levels are taken into account. The resulting metric will be
the average of the optimization of all levels.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>exog</code></td>
        <td><code>Union[pandas.core.series.Series, pandas.core.frame.DataFrame]</code></td>
        <td><p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>lags_grid</code></td>
        <td><code>Optional[list]</code></td>
        <td><p>Lists of <code>lags</code> to try. Only used if forecaster is an instance of 
<code>ForecasterAutoregMultiSeries</code> or <code>ForecasterAutoregMultiVariate</code>.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>refit</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to re-fit the forecaster in each iteration of backtesting.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>n_iter</code></td>
        <td><code>int</code></td>
        <td><p>Number of parameter settings that are sampled per lags configuration. 
n_iter trades off runtime vs quality of the solution.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>random_state</code></td>
        <td><code>int</code></td>
        <td><p>Sets a seed to the random sampling for reproducible output.</p></td>
        <td><code>123</code></td>
      </tr>
      <tr>
        <td><code>return_best</code></td>
        <td><code>bool</code></td>
        <td><p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Print number of folds used for cv or backtesting.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DataFrame</code></td>
      <td><p>Results for each combination of parameters.
    column levels = levels.
    column lags = predictions.
    column params = lower bound of the interval.
    column metric = metric(s) value(s) estimated for each combination of 
                    parameters. The resulting metric will be the average 
                    of the optimization of all levels.
    additional n columns with param = value.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>skforecast/model_selection_multiseries/model_selection_multiseries.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">random_search_forecaster_multiseries</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">param_distributions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Random search over specified parameter values or distributions for a Forecaster </span>
<span class="sd">    object. Validation is done using multi-series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterAutoregMultiSeries, ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate</span>
<span class="sd">        Forcaster model.</span>

<span class="sd">    series : pandas DataFrame</span>
<span class="sd">        Training time series.</span>

<span class="sd">    param_distributions : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and </span>
<span class="sd">        distributions or lists of parameters to try.</span>

<span class="sd">    steps : int</span>
<span class="sd">        Number of steps to predict.</span>

<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        If string:</span>
<span class="sd">            {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">             &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;}</span>

<span class="sd">        If Callable:</span>
<span class="sd">            Function with arguments y_true, y_pred that returns a float.</span>

<span class="sd">        If list:</span>
<span class="sd">            List containing multiple strings and/or Callables.</span>

<span class="sd">    initial_train_size : int </span>
<span class="sd">        Number of samples in the initial train split.</span>

<span class="sd">    fixed_train_size : bool, default `True`</span>
<span class="sd">        If True, train size doesn&#39;t increase but moves by `steps` in each iteration.</span>

<span class="sd">    gap : int, default `0`</span>
<span class="sd">        Number of samples to be excluded after the end of each training set and </span>
<span class="sd">        before the test set.</span>

<span class="sd">    allow_incomplete_fold : bool, default `True`</span>
<span class="sd">        Last fold is allowed to have a smaller number of samples than the </span>
<span class="sd">        `test_size`. If `False`, the last fold is excluded.</span>

<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        level (`str`) or levels (`list`) at which the forecaster is optimized. </span>
<span class="sd">        If `None`, all levels are taken into account. The resulting metric will be</span>
<span class="sd">        the average of the optimization of all levels.</span>

<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>

<span class="sd">    lags_grid : list of int, lists, np.narray or range, default `None`</span>
<span class="sd">        Lists of `lags` to try. Only used if forecaster is an instance of </span>
<span class="sd">        `ForecasterAutoregMultiSeries` or `ForecasterAutoregMultiVariate`.</span>

<span class="sd">    refit : bool, default `False`</span>
<span class="sd">        Whether to re-fit the forecaster in each iteration of backtesting.</span>

<span class="sd">    n_iter : int, default `10`</span>
<span class="sd">        Number of parameter settings that are sampled per lags configuration. </span>
<span class="sd">        n_iter trades off runtime vs quality of the solution.</span>

<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random sampling for reproducible output.</span>

<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>

<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>

<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>
<span class="sd">            column levels = levels.</span>
<span class="sd">            column lags = predictions.</span>
<span class="sd">            column params = lower bound of the interval.</span>
<span class="sd">            column metric = metric(s) value(s) estimated for each combination of </span>
<span class="sd">                            parameters. The resulting metric will be the average </span>
<span class="sd">                            of the optimization of all levels.</span>
<span class="sd">            additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterSampler</span><span class="p">(</span><span class="n">param_distributions</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="n">n_iter</span><span class="p">,</span> 
                                       <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters_multiseries</span><span class="p">(</span>
                  <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
                  <span class="n">series</span>                <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
                  <span class="n">param_grid</span>            <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
                  <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                  <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
                  <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
                  <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
                  <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
                  <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
                  <span class="n">levels</span>                <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
                  <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                  <span class="n">lags_grid</span>             <span class="o">=</span> <span class="n">lags_grid</span><span class="p">,</span>
                  <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
                  <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
                  <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span>
              <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="skforecast.model_selection_multiseries.model_selection_multiseries.backtesting_forecaster_multivariate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">backtesting_forecaster_multivariate</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#skforecast.model_selection_multiseries.model_selection_multiseries.backtesting_forecaster_multivariate" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

      <p>This function is an alias of backtesting_forecaster_multiseries.</p>
<p>Backtesting for multi-series and multivariate forecasters.</p>
<p>If <code>refit</code> is False, the model is trained only once using the <code>initial_train_size</code>
first observations. If <code>refit</code> is True, the model is trained in each iteration
increasing the training set. A copy of the original forecaster is created so 
it is not modified during the process.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>forecaster</code></td>
        <td><code>ForecasterAutoregMultiSeries, ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate</code></td>
        <td><p>Forecaster model.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>series</code></td>
        <td><code>DataFrame</code></td>
        <td><p>Training time series.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>steps</code></td>
        <td><code>int</code></td>
        <td><p>Number of steps to predict.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>metric</code></td>
        <td><code>Union[str, Callable, list]</code></td>
        <td><p>Metric used to quantify the goodness of fit of the model.</p>
<p>If string:
    {'mean_squared_error', 'mean_absolute_error',
     'mean_absolute_percentage_error', 'mean_squared_log_error'}</p>
<p>If Callable:
    Function with arguments y_true, y_pred that returns a float.</p>
<p>If list:
    List containing multiple strings and/or Callables.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>initial_train_size</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Number of samples in the initial train split. If <code>None</code> and <code>forecaster</code> is already 
trained, no initial train is done and all data is used to evaluate the model. However, 
the first <code>len(forecaster.last_window)</code> observations are needed to create the 
initial predictors, so no predictions are calculated for them.</p>
<p><code>None</code> is only allowed when <code>refit</code> is <code>False</code>.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fixed_train_size</code></td>
        <td><code>bool</code></td>
        <td><p>If True, train size doesn't increase but moves by <code>steps</code> in each iteration.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>gap</code></td>
        <td><code>int</code></td>
        <td><p>Number of samples to be excluded after the end of each training set and 
before the test set.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>allow_incomplete_fold</code></td>
        <td><code>bool</code></td>
        <td><p>Last fold is allowed to have a smaller number of samples than the 
<code>test_size</code>. If <code>False</code>, the last fold is excluded.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>levels</code></td>
        <td><code>Union[str, list]</code></td>
        <td><p>Time series to be predicted. If <code>None</code> all levels will be predicted.
<strong>New in version 0.6.0</strong></p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>exog</code></td>
        <td><code>Union[pandas.core.series.Series, pandas.core.frame.DataFrame]</code></td>
        <td><p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>refit</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to re-fit the forecaster in each iteration.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>interval</code></td>
        <td><code>Optional[list]</code></td>
        <td><p>Confidence of the prediction interval estimated. Sequence of percentiles
to compute, which must be between 0 and 100 inclusive. If <code>None</code>, no
intervals are estimated. Only available for forecaster of type ForecasterAutoreg
and ForecasterAutoregCustom.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>n_boot</code></td>
        <td><code>int</code></td>
        <td><p>Number of bootstrapping iterations used to estimate prediction
intervals.</p></td>
        <td><code>500</code></td>
      </tr>
      <tr>
        <td><code>random_state</code></td>
        <td><code>int</code></td>
        <td><p>Sets a seed to the random generator, so that boot intervals are always 
deterministic.</p></td>
        <td><code>123</code></td>
      </tr>
      <tr>
        <td><code>in_sample_residuals</code></td>
        <td><code>bool</code></td>
        <td><p>If <code>True</code>, residuals from the training data are used as proxy of
prediction error to create prediction intervals.  If <code>False</code>, out_sample_residuals
are used if they are already stored inside the forecaster.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Print number of folds and index of training and validation sets used for backtesting.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>show_progress</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to show a progress bar. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[pandas.core.frame.DataFrame, pandas.core.frame.DataFrame]</code></td>
      <td><p>Value(s) of the metric(s). Index are the levels and columns the metrics.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>skforecast/model_selection_multiseries/model_selection_multiseries.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">backtesting_forecaster_multivariate</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is an alias of backtesting_forecaster_multiseries.</span>

<span class="sd">    Backtesting for multi-series and multivariate forecasters.</span>

<span class="sd">    If `refit` is False, the model is trained only once using the `initial_train_size`</span>
<span class="sd">    first observations. If `refit` is True, the model is trained in each iteration</span>
<span class="sd">    increasing the training set. A copy of the original forecaster is created so </span>
<span class="sd">    it is not modified during the process.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterAutoregMultiSeries, ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate</span>
<span class="sd">        Forecaster model.</span>

<span class="sd">    series : pandas DataFrame</span>
<span class="sd">        Training time series.</span>

<span class="sd">    steps : int</span>
<span class="sd">        Number of steps to predict.</span>

<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        If string:</span>
<span class="sd">            {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">             &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;}</span>

<span class="sd">        If Callable:</span>
<span class="sd">            Function with arguments y_true, y_pred that returns a float.</span>

<span class="sd">        If list:</span>
<span class="sd">            List containing multiple strings and/or Callables.</span>

<span class="sd">    initial_train_size : int, default `None`</span>
<span class="sd">        Number of samples in the initial train split. If `None` and `forecaster` is already </span>
<span class="sd">        trained, no initial train is done and all data is used to evaluate the model. However, </span>
<span class="sd">        the first `len(forecaster.last_window)` observations are needed to create the </span>
<span class="sd">        initial predictors, so no predictions are calculated for them.</span>

<span class="sd">        `None` is only allowed when `refit` is `False`.</span>

<span class="sd">    fixed_train_size : bool, default `True`</span>
<span class="sd">        If True, train size doesn&#39;t increase but moves by `steps` in each iteration.</span>

<span class="sd">    gap : int, default `0`</span>
<span class="sd">        Number of samples to be excluded after the end of each training set and </span>
<span class="sd">        before the test set.</span>

<span class="sd">    allow_incomplete_fold : bool, default `True`</span>
<span class="sd">        Last fold is allowed to have a smaller number of samples than the </span>
<span class="sd">        `test_size`. If `False`, the last fold is excluded.</span>

<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        Time series to be predicted. If `None` all levels will be predicted.</span>
<span class="sd">        **New in version 0.6.0**</span>

<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>

<span class="sd">    refit : bool, default `False`</span>
<span class="sd">        Whether to re-fit the forecaster in each iteration.</span>

<span class="sd">    interval : list, default `None`</span>
<span class="sd">        Confidence of the prediction interval estimated. Sequence of percentiles</span>
<span class="sd">        to compute, which must be between 0 and 100 inclusive. If `None`, no</span>
<span class="sd">        intervals are estimated. Only available for forecaster of type ForecasterAutoreg</span>
<span class="sd">        and ForecasterAutoregCustom.</span>

<span class="sd">    n_boot : int, default `500`</span>
<span class="sd">        Number of bootstrapping iterations used to estimate prediction</span>
<span class="sd">        intervals.</span>

<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random generator, so that boot intervals are always </span>
<span class="sd">        deterministic.</span>

<span class="sd">    in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of</span>
<span class="sd">        prediction error to create prediction intervals.  If `False`, out_sample_residuals</span>
<span class="sd">        are used if they are already stored inside the forecaster.</span>

<span class="sd">    verbose : bool, default `False`</span>
<span class="sd">        Print number of folds and index of training and validation sets used for backtesting.</span>

<span class="sd">    show_progress: bool, default `True`</span>
<span class="sd">        Whether to show a progress bar. Defaults to True.</span>

<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    metrics_levels : pandas DataFrame</span>
<span class="sd">        Value(s) of the metric(s). Index are the levels and columns the metrics.</span>

<span class="sd">    backtest_predictions : pandas DataFrame</span>
<span class="sd">        Value of predictions and their estimated interval if `interval` is not `None`.</span>
<span class="sd">        If there is more than one level, this structure will be repeated for each of them.</span>
<span class="sd">            column pred = predictions.</span>
<span class="sd">            column lower_bound = lower bound of the interval.</span>
<span class="sd">            column upper_bound = upper bound interval of the interval.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">metrics_levels</span><span class="p">,</span> <span class="n">backtest_predictions</span> <span class="o">=</span> <span class="n">backtesting_forecaster_multiseries</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">series</span>                <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
        <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
        <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
        <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
        <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
        <span class="n">levels</span>                <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
        <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
        <span class="n">interval</span>              <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
        <span class="n">n_boot</span>                <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
        <span class="n">random_state</span>          <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
        <span class="n">in_sample_residuals</span>   <span class="o">=</span> <span class="n">in_sample_residuals</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span>

    <span class="p">)</span>

    <span class="k">return</span> <span class="n">metrics_levels</span><span class="p">,</span> <span class="n">backtest_predictions</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="skforecast.model_selection_multiseries.model_selection_multiseries.grid_search_forecaster_multivariate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">grid_search_forecaster_multivariate</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#skforecast.model_selection_multiseries.model_selection_multiseries.grid_search_forecaster_multivariate" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

      <p>This function is an alias of grid_search_forecaster_multiseries.</p>
<p>Exhaustive search over specified parameter values for a Forecaster object.
Validation is done using multi-series backtesting.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>forecaster</code></td>
        <td><code>ForecasterAutoregMultiSeries, ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate</code></td>
        <td><p>Forcaster model.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>series</code></td>
        <td><code>DataFrame</code></td>
        <td><p>Training time series.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>param_grid</code></td>
        <td><code>dict</code></td>
        <td><p>Dictionary with parameters names (<code>str</code>) as keys and lists of parameter
settings to try as values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>steps</code></td>
        <td><code>int</code></td>
        <td><p>Number of steps to predict.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>metric</code></td>
        <td><code>Union[str, Callable, list]</code></td>
        <td><p>Metric used to quantify the goodness of fit of the model.</p>
<p>If string:
    {'mean_squared_error', 'mean_absolute_error',
     'mean_absolute_percentage_error', 'mean_squared_log_error'}</p>
<p>If Callable:
    Function with arguments y_true, y_pred that returns a float.</p>
<p>If list:
    List containing multiple strings and/or Callables.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>initial_train_size</code></td>
        <td><code>int</code></td>
        <td><p>Number of samples in the initial train split.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fixed_train_size</code></td>
        <td><code>bool</code></td>
        <td><p>If True, train size doesn't increase but moves by <code>steps</code> in each iteration.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>gap</code></td>
        <td><code>int</code></td>
        <td><p>Number of samples to be excluded after the end of each training set and 
before the test set.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>allow_incomplete_fold</code></td>
        <td><code>bool</code></td>
        <td><p>Last fold is allowed to have a smaller number of samples than the 
<code>test_size</code>. If <code>False</code>, the last fold is excluded.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>levels</code></td>
        <td><code>Union[str, list]</code></td>
        <td><p>level (<code>str</code>) or levels (<code>list</code>) at which the forecaster is optimized. 
If <code>None</code>, all levels are taken into account. The resulting metric will be
the average of the optimization of all levels.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>exog</code></td>
        <td><code>Union[pandas.core.series.Series, pandas.core.frame.DataFrame]</code></td>
        <td><p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>lags_grid</code></td>
        <td><code>Optional[list]</code></td>
        <td><p>Lists of <code>lags</code> to try. Only used if forecaster is an instance of 
<code>ForecasterAutoregMultiSeries</code> or <code>ForecasterAutoregMultiVariate</code>.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>refit</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to re-fit the forecaster in each iteration of backtesting.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>return_best</code></td>
        <td><code>bool</code></td>
        <td><p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Print number of folds used for cv or backtesting.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DataFrame</code></td>
      <td><p>Results for each combination of parameters.
    column levels = levels.
    column lags = predictions.
    column params = lower bound of the interval.
    column metric = metric(s) value(s) estimated for each combination of 
                    parameters. The resulting metric will be the average 
                    of the optimization of all levels.
    additional n columns with param = value.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>skforecast/model_selection_multiseries/model_selection_multiseries.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">grid_search_forecaster_multivariate</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is an alias of grid_search_forecaster_multiseries.</span>

<span class="sd">    Exhaustive search over specified parameter values for a Forecaster object.</span>
<span class="sd">    Validation is done using multi-series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterAutoregMultiSeries, ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate</span>
<span class="sd">        Forcaster model.</span>

<span class="sd">    series : pandas DataFrame</span>
<span class="sd">        Training time series.</span>

<span class="sd">    param_grid : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and lists of parameter</span>
<span class="sd">        settings to try as values.</span>

<span class="sd">    steps : int</span>
<span class="sd">        Number of steps to predict.</span>

<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        If string:</span>
<span class="sd">            {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">             &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;}</span>

<span class="sd">        If Callable:</span>
<span class="sd">            Function with arguments y_true, y_pred that returns a float.</span>

<span class="sd">        If list:</span>
<span class="sd">            List containing multiple strings and/or Callables.</span>

<span class="sd">    initial_train_size : int </span>
<span class="sd">        Number of samples in the initial train split.</span>

<span class="sd">    fixed_train_size : bool, default `True`</span>
<span class="sd">        If True, train size doesn&#39;t increase but moves by `steps` in each iteration.</span>

<span class="sd">    gap : int, default `0`</span>
<span class="sd">        Number of samples to be excluded after the end of each training set and </span>
<span class="sd">        before the test set.</span>

<span class="sd">    allow_incomplete_fold : bool, default `True`</span>
<span class="sd">        Last fold is allowed to have a smaller number of samples than the </span>
<span class="sd">        `test_size`. If `False`, the last fold is excluded.</span>

<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        level (`str`) or levels (`list`) at which the forecaster is optimized. </span>
<span class="sd">        If `None`, all levels are taken into account. The resulting metric will be</span>
<span class="sd">        the average of the optimization of all levels.</span>

<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>

<span class="sd">    lags_grid : list of int, lists, np.narray or range, default `None`</span>
<span class="sd">        Lists of `lags` to try. Only used if forecaster is an instance of </span>
<span class="sd">        `ForecasterAutoregMultiSeries` or `ForecasterAutoregMultiVariate`.</span>

<span class="sd">    refit : bool, default `False`</span>
<span class="sd">        Whether to re-fit the forecaster in each iteration of backtesting.</span>

<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>

<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>

<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>
<span class="sd">            column levels = levels.</span>
<span class="sd">            column lags = predictions.</span>
<span class="sd">            column params = lower bound of the interval.</span>
<span class="sd">            column metric = metric(s) value(s) estimated for each combination of </span>
<span class="sd">                            parameters. The resulting metric will be the average </span>
<span class="sd">                            of the optimization of all levels.</span>
<span class="sd">            additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">grid_search_forecaster_multiseries</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">series</span>                <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
        <span class="n">param_grid</span>            <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
        <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
        <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
        <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
        <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
        <span class="n">levels</span>                <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
        <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">lags_grid</span>             <span class="o">=</span> <span class="n">lags_grid</span><span class="p">,</span>
        <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
        <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="skforecast.model_selection_multiseries.model_selection_multiseries.random_search_forecaster_multivariate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">random_search_forecaster_multivariate</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">param_distributions</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#skforecast.model_selection_multiseries.model_selection_multiseries.random_search_forecaster_multivariate" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

      <p>This function is an alias of random_search_forecaster_multiseries.</p>
<p>Random search over specified parameter values or distributions for a Forecaster 
object. Validation is done using multi-series backtesting.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>forecaster</code></td>
        <td><code>ForecasterAutoregMultiSeries, ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate</code></td>
        <td><p>Forcaster model.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>series</code></td>
        <td><code>DataFrame</code></td>
        <td><p>Training time series.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>param_distributions</code></td>
        <td><code>dict</code></td>
        <td><p>Dictionary with parameters names (<code>str</code>) as keys and 
distributions or lists of parameters to try.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>steps</code></td>
        <td><code>int</code></td>
        <td><p>Number of steps to predict.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>metric</code></td>
        <td><code>Union[str, Callable, list]</code></td>
        <td><p>Metric used to quantify the goodness of fit of the model.</p>
<p>If string:
    {'mean_squared_error', 'mean_absolute_error',
     'mean_absolute_percentage_error', 'mean_squared_log_error'}</p>
<p>If Callable:
    Function with arguments y_true, y_pred that returns a float.</p>
<p>If list:
    List containing multiple strings and/or Callables.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>initial_train_size</code></td>
        <td><code>int</code></td>
        <td><p>Number of samples in the initial train split.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fixed_train_size</code></td>
        <td><code>bool</code></td>
        <td><p>If True, train size doesn't increase but moves by <code>steps</code> in each iteration.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>gap</code></td>
        <td><code>int</code></td>
        <td><p>Number of samples to be excluded after the end of each training set and 
before the test set.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>allow_incomplete_fold</code></td>
        <td><code>bool</code></td>
        <td><p>Last fold is allowed to have a smaller number of samples than the 
<code>test_size</code>. If <code>False</code>, the last fold is excluded.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>levels</code></td>
        <td><code>Union[str, list]</code></td>
        <td><p>level (<code>str</code>) or levels (<code>list</code>) at which the forecaster is optimized. 
If <code>None</code>, all levels are taken into account. The resulting metric will be
the average of the optimization of all levels.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>exog</code></td>
        <td><code>Union[pandas.core.series.Series, pandas.core.frame.DataFrame]</code></td>
        <td><p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>lags_grid</code></td>
        <td><code>Optional[list]</code></td>
        <td><p>Lists of <code>lags</code> to try. Only used if forecaster is an instance of 
<code>ForecasterAutoregMultiSeries</code> or <code>ForecasterAutoregMultiVariate</code>.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>refit</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to re-fit the forecaster in each iteration of backtesting.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>n_iter</code></td>
        <td><code>int</code></td>
        <td><p>Number of parameter settings that are sampled per lags configuration. 
n_iter trades off runtime vs quality of the solution.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>random_state</code></td>
        <td><code>int</code></td>
        <td><p>Sets a seed to the random sampling for reproducible output.</p></td>
        <td><code>123</code></td>
      </tr>
      <tr>
        <td><code>return_best</code></td>
        <td><code>bool</code></td>
        <td><p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Print number of folds used for cv or backtesting.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DataFrame</code></td>
      <td><p>Results for each combination of parameters.
    column levels = levels.
    column lags = predictions.
    column params = lower bound of the interval.
    column metric = metric(s) value(s) estimated for each combination of 
                    parameters. The resulting metric will be the average 
                    of the optimization of all levels.
    additional n columns with param = value.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>skforecast/model_selection_multiseries/model_selection_multiseries.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">random_search_forecaster_multivariate</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">param_distributions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is an alias of random_search_forecaster_multiseries.</span>

<span class="sd">    Random search over specified parameter values or distributions for a Forecaster </span>
<span class="sd">    object. Validation is done using multi-series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterAutoregMultiSeries, ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate</span>
<span class="sd">        Forcaster model.</span>

<span class="sd">    series : pandas DataFrame</span>
<span class="sd">        Training time series.</span>

<span class="sd">    param_distributions : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and </span>
<span class="sd">        distributions or lists of parameters to try.</span>

<span class="sd">    steps : int</span>
<span class="sd">        Number of steps to predict.</span>

<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        If string:</span>
<span class="sd">            {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">             &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;}</span>

<span class="sd">        If Callable:</span>
<span class="sd">            Function with arguments y_true, y_pred that returns a float.</span>

<span class="sd">        If list:</span>
<span class="sd">            List containing multiple strings and/or Callables.</span>

<span class="sd">    initial_train_size : int </span>
<span class="sd">        Number of samples in the initial train split.</span>

<span class="sd">    fixed_train_size : bool, default `True`</span>
<span class="sd">        If True, train size doesn&#39;t increase but moves by `steps` in each iteration.</span>

<span class="sd">    gap : int, default `0`</span>
<span class="sd">        Number of samples to be excluded after the end of each training set and </span>
<span class="sd">        before the test set.</span>

<span class="sd">    allow_incomplete_fold : bool, default `True`</span>
<span class="sd">        Last fold is allowed to have a smaller number of samples than the </span>
<span class="sd">        `test_size`. If `False`, the last fold is excluded.</span>

<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        level (`str`) or levels (`list`) at which the forecaster is optimized. </span>
<span class="sd">        If `None`, all levels are taken into account. The resulting metric will be</span>
<span class="sd">        the average of the optimization of all levels.</span>

<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>

<span class="sd">    lags_grid : list of int, lists, np.narray or range, default `None`</span>
<span class="sd">        Lists of `lags` to try. Only used if forecaster is an instance of </span>
<span class="sd">        `ForecasterAutoregMultiSeries` or `ForecasterAutoregMultiVariate`.</span>

<span class="sd">    refit : bool, default `False`</span>
<span class="sd">        Whether to re-fit the forecaster in each iteration of backtesting.</span>

<span class="sd">    n_iter : int, default `10`</span>
<span class="sd">        Number of parameter settings that are sampled per lags configuration. </span>
<span class="sd">        n_iter trades off runtime vs quality of the solution.</span>

<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random sampling for reproducible output.</span>

<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>

<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>

<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>
<span class="sd">            column levels = levels.</span>
<span class="sd">            column lags = predictions.</span>
<span class="sd">            column params = lower bound of the interval.</span>
<span class="sd">            column metric = metric(s) value(s) estimated for each combination of </span>
<span class="sd">                            parameters. The resulting metric will be the average </span>
<span class="sd">                            of the optimization of all levels.</span>
<span class="sd">            additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">random_search_forecaster_multiseries</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">series</span>                <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
        <span class="n">param_distributions</span>   <span class="o">=</span> <span class="n">param_distributions</span><span class="p">,</span>
        <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
        <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
        <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
        <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
        <span class="n">levels</span>                <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
        <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">lags_grid</span>             <span class="o">=</span> <span class="n">lags_grid</span><span class="p">,</span>
        <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
        <span class="n">n_iter</span>                <span class="o">=</span> <span class="n">n_iter</span><span class="p">,</span>
        <span class="n">random_state</span>          <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
        <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span>
    <span class="p">)</span> 

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>
        </details>
    </div>

  </div>


  




                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="model_selection.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: model_selection" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              model_selection
            </div>
          </div>
        </a>
      
      
        
        <a href="model_selection_sarimax.html" class="md-footer__link md-footer__link--next" aria-label="Next: model_selection_sarimax" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              model_selection_sarimax
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  

<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input type="checkbox" class="md-toggle" id="__settings">
<div class="md-consent__settings">
  <ul class="task-list">
    
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        <label>
      </li>
    
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        <label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);console.log(new FormData(form)),__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top"], "search": "../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.37e9125f.min.js"></script>
      
    
  </body>
</html>