
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python library that eases using scikit-learn regressors as multi-step forecasters. It also works with any regressor compatible with the scikit-learn API (XGBoost, LightGBM, Ranger...).">
      
      
        <meta name="author" content="Joaquin Amat Rodrigo and Javier Escobar Ortiz">
      
      
        <link rel="canonical" href="https://joaquinamatrodrigo.github.io/skforecast/0.11.0/introduction-forecasting/introduction-forecasting.html">
      
      
        <link rel="prev" href="../releases/releases.html">
      
      
        <link rel="next" href="../user_guides/quick-start-skforecast.html">
      
      <link rel="icon" href="../img/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.15">
    
    
      
        <title>Introduction to forecasting - Skforecast Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-GR8X9Z9LKL"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-GR8X9Z9LKL",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-GR8X9Z9LKL",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction-to-forecasting" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Skforecast Docs" class="md-header__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast-orange-no-backgound.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Skforecast Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Introduction to forecasting
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/JoaquinAmatRodrigo/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="introduction-forecasting.html" class="md-tabs__link md-tabs__link--active">
        Introduction to forecasting
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../user_guides/quick-start-skforecast.html" class="md-tabs__link">
        Quick start
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../user_guides/input-data.html" class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../examples/examples.html" class="md-tabs__link">
        Examples and tutorials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../api/ForecasterAutoreg.html" class="md-tabs__link">
        API Reference
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../faq/faq.html" class="md-tabs__link">
        FAQ and Tips
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../releases/releases.html" class="md-tabs__link">
      Releases
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../authors/authors.html" class="md-tabs__link">
      Authors
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Skforecast Docs" class="md-nav__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast-orange-no-backgound.png" alt="logo">

    </a>
    Skforecast Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/JoaquinAmatRodrigo/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Welcome to skforecast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Introduction to forecasting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="introduction-forecasting.html" class="md-nav__link md-nav__link--active">
        Introduction to forecasting
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#time-series-and-forecasting" class="md-nav__link">
    Time series and forecasting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#machine-learning-for-forecasting" class="md-nav__link">
    Machine learning for forecasting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#single-step-forecasting" class="md-nav__link">
    Single-step forecasting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-step-forecasting" class="md-nav__link">
    Multi-step forecasting
  </a>
  
    <nav class="md-nav" aria-label="Multi-step forecasting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recursive-multi-step-forecasting" class="md-nav__link">
    Recursive multi-step forecasting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#direct-multi-step-forecasting" class="md-nav__link">
    Direct multi-step forecasting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-output-forecasting" class="md-nav__link">
    Multiple output forecasting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-time-series-forecasting" class="md-nav__link">
    Multi-time series forecasting
  </a>
  
    <nav class="md-nav" aria-label="Multi-time series forecasting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#independent-multi-series-forecasting" class="md-nav__link">
    Independent Multi-Series Forecasting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependent-multi-series-forecasting-multivariate-time-series" class="md-nav__link">
    Dependent Multi-Series Forecasting (multivariate time series)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#forecasters" class="md-nav__link">
    Forecasters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backtesting-forecasting-models" class="md-nav__link">
    Backtesting forecasting models
  </a>
  
    <nav class="md-nav" aria-label="Backtesting forecasting models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backtesting-without-refit" class="md-nav__link">
    Backtesting without refit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backtesting-with-refit-and-increasing-training-size-fixed-origin" class="md-nav__link">
    Backtesting with refit and increasing training size (fixed origin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backtesting-with-refit-and-fixed-training-size-rolling-origin" class="md-nav__link">
    Backtesting with refit and fixed training size (rolling origin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backtesting-with-intermittent-refit" class="md-nav__link">
    Backtesting with intermittent refit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backtesting-including-gap" class="md-nav__link">
    Backtesting including gap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#which-strategy-should-i-use" class="md-nav__link">
    Which strategy should I use?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/quick-start-skforecast.html" class="md-nav__link">
        Quick start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/input-data.html" class="md-nav__link">
        User Guides
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples.html" class="md-nav__link">
        Examples and tutorials
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/ForecasterAutoreg.html" class="md-nav__link">
        API Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/faq.html" class="md-nav__link">
        FAQ and Tips
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../releases/releases.html" class="md-nav__link">
        Releases
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Introduction to forecasting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Introduction to forecasting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Introduction to forecasting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="introduction-forecasting.html" class="md-nav__link md-nav__link--active">
        Introduction to forecasting
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#time-series-and-forecasting" class="md-nav__link">
    Time series and forecasting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#machine-learning-for-forecasting" class="md-nav__link">
    Machine learning for forecasting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#single-step-forecasting" class="md-nav__link">
    Single-step forecasting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-step-forecasting" class="md-nav__link">
    Multi-step forecasting
  </a>
  
    <nav class="md-nav" aria-label="Multi-step forecasting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recursive-multi-step-forecasting" class="md-nav__link">
    Recursive multi-step forecasting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#direct-multi-step-forecasting" class="md-nav__link">
    Direct multi-step forecasting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-output-forecasting" class="md-nav__link">
    Multiple output forecasting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-time-series-forecasting" class="md-nav__link">
    Multi-time series forecasting
  </a>
  
    <nav class="md-nav" aria-label="Multi-time series forecasting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#independent-multi-series-forecasting" class="md-nav__link">
    Independent Multi-Series Forecasting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependent-multi-series-forecasting-multivariate-time-series" class="md-nav__link">
    Dependent Multi-Series Forecasting (multivariate time series)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#forecasters" class="md-nav__link">
    Forecasters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backtesting-forecasting-models" class="md-nav__link">
    Backtesting forecasting models
  </a>
  
    <nav class="md-nav" aria-label="Backtesting forecasting models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backtesting-without-refit" class="md-nav__link">
    Backtesting without refit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backtesting-with-refit-and-increasing-training-size-fixed-origin" class="md-nav__link">
    Backtesting with refit and increasing training size (fixed origin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backtesting-with-refit-and-fixed-training-size-rolling-origin" class="md-nav__link">
    Backtesting with refit and fixed training size (rolling origin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backtesting-with-intermittent-refit" class="md-nav__link">
    Backtesting with intermittent refit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backtesting-including-gap" class="md-nav__link">
    Backtesting including gap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#which-strategy-should-i-use" class="md-nav__link">
    Which strategy should I use?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Quick start
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Quick start
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/quick-start-skforecast.html" class="md-nav__link">
        Quick start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="forecaster-parameters.html" class="md-nav__link">
        Forecaster Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="forecaster-attributes.html" class="md-nav__link">
        Forecaster Attributes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          User Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/input-data.html" class="md-nav__link">
        Input data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/autoregresive-forecaster.html" class="md-nav__link">
        Recursive multi-step forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/direct-multi-step-forecasting.html" class="md-nav__link">
        Direct multi-step forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/independent-multi-time-series-forecasting.html" class="md-nav__link">
        Independent multi-time series forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/dependent-multi-series-multivariate-forecasting.html" class="md-nav__link">
        Dependent multivariate series forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-sarimax-arima.html" class="md-nav__link">
        ARIMA and SARIMAX forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-baseline.html" class="md-nav__link">
        Foreasting baseline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/exogenous-variables.html" class="md-nav__link">
        Exogenous variables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/custom-predictors.html" class="md-nav__link">
        Custom predictors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/weighted-time-series-forecasting.html" class="md-nav__link">
        Weighted time series forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/backtesting.html" class="md-nav__link">
        Backtesting forecaster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/hyperparameter-tuning-and-lags-selection.html" class="md-nav__link">
        Hyperparameter tuning and lags selection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/sklearn-transformers-and-pipeline.html" class="md-nav__link">
        Scikit-learn Transformers and Pipelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/probabilistic-forecasting.html" class="md-nav__link">
        Probabilistic forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/feature-importances.html" class="md-nav__link">
        Feature importances
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/categorical-features.html" class="md-nav__link">
        Categorical features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-xgboost-lightgbm.html" class="md-nav__link">
        Forecasting with XGBoost and LightGBM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecaster-in-production.html" class="md-nav__link">
        Forecaster in production
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/save-load-forecaster.html" class="md-nav__link">
        Save and load forecaster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/shap-values-skforecast.html" class="md-nav__link">
        Shap-values
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/skforecast-in-GPU.html" class="md-nav__link">
        Skforecast in GPU
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/plot-forecaster-residuals.html" class="md-nav__link">
        Plot forecaster residuals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/datasets.html" class="md-nav__link">
        Datasets
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Examples and tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Examples and tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples.html" class="md-nav__link">
        Examples and tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/ForecasterAutoreg.html" class="md-nav__link">
        ForecasterAutoreg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/ForecasterAutoregCustom.html" class="md-nav__link">
        ForecasterAutoregCustom
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/ForecasterAutoregDirect.html" class="md-nav__link">
        ForecasterAutoregDirect
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/ForecasterMultiSeries.html" class="md-nav__link">
        ForecasterMultiSeries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/ForecasterMultiSeriesCustom.html" class="md-nav__link">
        ForecasterMultiSeriesCustom
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/ForecasterMultiVariate.html" class="md-nav__link">
        ForecasterMultiVariate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/ForecasterSarimax.html" class="md-nav__link">
        ForecasterSarimax
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/Sarimax.html" class="md-nav__link">
        Sarimax
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/ForecasterBaseline.html" class="md-nav__link">
        ForecasterBaseline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/model_selection.html" class="md-nav__link">
        model_selection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/model_selection_multiseries.html" class="md-nav__link">
        model_selection_multiseries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/model_selection_sarimax.html" class="md-nav__link">
        model_selection_sarimax
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/preprocessing.html" class="md-nav__link">
        preprocessing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/plot.html" class="md-nav__link">
        plot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils.html" class="md-nav__link">
        utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/datasets.html" class="md-nav__link">
        datasets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/exceptions.html" class="md-nav__link">
        exceptions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          FAQ and Tips
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          FAQ and Tips
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/faq.html" class="md-nav__link">
        Table of contents
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/time-series-differentiation.html" class="md-nav__link">
        Time series differentiation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/non-negative-predictions.html" class="md-nav__link">
        Avoid negative predictions when forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-time-series-with-missing-values.html" class="md-nav__link">
        Forecasting time series with missing values
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/cyclical-features-time-series.html" class="md-nav__link">
        Cyclical features in time series
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/parallelization-skforecast.html" class="md-nav__link">
        Parallelization in skforecast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/profiling-skforecast.html" class="md-nav__link">
        Profiling skforecast
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../releases/releases.html" class="md-nav__link">
        Releases
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../authors/authors.html" class="md-nav__link">
        Authors
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#time-series-and-forecasting" class="md-nav__link">
    Time series and forecasting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#machine-learning-for-forecasting" class="md-nav__link">
    Machine learning for forecasting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#single-step-forecasting" class="md-nav__link">
    Single-step forecasting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-step-forecasting" class="md-nav__link">
    Multi-step forecasting
  </a>
  
    <nav class="md-nav" aria-label="Multi-step forecasting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recursive-multi-step-forecasting" class="md-nav__link">
    Recursive multi-step forecasting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#direct-multi-step-forecasting" class="md-nav__link">
    Direct multi-step forecasting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-output-forecasting" class="md-nav__link">
    Multiple output forecasting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-time-series-forecasting" class="md-nav__link">
    Multi-time series forecasting
  </a>
  
    <nav class="md-nav" aria-label="Multi-time series forecasting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#independent-multi-series-forecasting" class="md-nav__link">
    Independent Multi-Series Forecasting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependent-multi-series-forecasting-multivariate-time-series" class="md-nav__link">
    Dependent Multi-Series Forecasting (multivariate time series)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#forecasters" class="md-nav__link">
    Forecasters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backtesting-forecasting-models" class="md-nav__link">
    Backtesting forecasting models
  </a>
  
    <nav class="md-nav" aria-label="Backtesting forecasting models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backtesting-without-refit" class="md-nav__link">
    Backtesting without refit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backtesting-with-refit-and-increasing-training-size-fixed-origin" class="md-nav__link">
    Backtesting with refit and increasing training size (fixed origin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backtesting-with-refit-and-fixed-training-size-rolling-origin" class="md-nav__link">
    Backtesting with refit and fixed training size (rolling origin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backtesting-with-intermittent-refit" class="md-nav__link">
    Backtesting with intermittent refit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backtesting-including-gap" class="md-nav__link">
    Backtesting including gap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#which-strategy-should-i-use" class="md-nav__link">
    Which strategy should I use?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="introduction-to-forecasting">Introduction to forecasting<a class="headerlink" href="#introduction-to-forecasting" title="Permanent link">&para;</a></h1>
<h2 id="time-series-and-forecasting">Time series and forecasting<a class="headerlink" href="#time-series-and-forecasting" title="Permanent link">&para;</a></h2>
<p>A time series is a sequence of data arranged chronologically and spaced at equal or irregular intervals. The forecasting process consists of predicting the future value of a time series, either by modeling the series solely based on its past behavior (autoregressive) or by incorporating other external variables.</p>
<p style="text-align: center">
<img src="../img/forecasting_multi-step_en.gif" style="width: 500px">
</p>

<h2 id="machine-learning-for-forecasting">Machine learning for forecasting<a class="headerlink" href="#machine-learning-for-forecasting" title="Permanent link">&para;</a></h2>
<p>To apply machine learning models to forecasting problems, the time series needs to be transformed into a matrix where each value is associated with a specific time window (known as lags) that precedes it. In the context of time series, a lag with respect to a time step <em>t</em> is defined as the value of the series at previous time steps. For instance, lag 1 represents the value at time step <em>t-1</em>, while lag <em>m</em> represents the value at time step <em>t-m</em>.</p>
<p>This transformation is essential for machine learning models to capture the dependencies and patterns that exist between past and future values in a time series. By using lags as input features, machine learning models can learn from the past and make predictions about future values. The number of lags used as input features in the matrix is an important hyperparameter that needs to be carefully tuned to obtain the best performance of the model.</p>
<p style="text-align: center">
<img src="../img/transform_timeseries.gif" style="width: 500px;">
<br>
<font size="2.5"> <i>Time series transformation into a matrix of 5 lags and a vector with the value of the series that follows each row of the matrix.</i></font>
</p>

<p>This type of transformation also allows to include additional variables.</p>
<p style="text-align: center">
<img src="../img/matrix_transformation_with_exog_variable.png" style="width: 600px;">
<br>
<font size="2.5"> <i>Time series transformation including an exogenous variable.</i></font>
</p>

<p>Once data have been rearranged into the new shape, any regression model can be trained to predict the next value (step) of the series. During model training, every row is considered a separate data instance, where values at lags 1, 2, ... <em>p</em> are considered predictors for the target quantity of the time series at time step <em>p+1</em>. </p>
<p style="text-align: center">
<img src="../img/diagram-trainig-forecaster.png" style="width: 700px;">
<br>
<font size="2.5"> <i>Diagram of training a machine learning model with time series data.</i></font>
</p>

<h2 id="single-step-forecasting">Single-step forecasting<a class="headerlink" href="#single-step-forecasting" title="Permanent link">&para;</a></h2>
<p>Single-step prediction is used when the goal is to predict only the next value of the series.</p>
<p style="text-align: center">
<img src="../img/diagram-single-step-forecasting.png" style="width: 700px;">
<br>
<font size="2.5"> <i>Diagram of single-step forecasting.</i></font>
</p>

<h2 id="multi-step-forecasting">Multi-step forecasting<a class="headerlink" href="#multi-step-forecasting" title="Permanent link">&para;</a></h2>
<p>When working with time series, it is seldom needed to predict only the next element in the series (<em>t+1</em>). Instead, the most common goal is to predict a whole future interval (<em>t+1, ..., t+n</em>)  or a far point in time (<em>t+n</em>). Several strategies allow generating this type of prediction.</p>
<h3 id="recursive-multi-step-forecasting">Recursive multi-step forecasting<a class="headerlink" href="#recursive-multi-step-forecasting" title="Permanent link">&para;</a></h3>
<p>Since the value <em>t(n-1)</em> is required to predict <em>t(n)</em>, and <em>t(n-1)</em> is unknown, a recursive process is applied in which, each new prediction, is based on the previous one. This process is known as recursive forecasting or recursive multi-step forecasting and can be easily generated with the <a href="https://skforecast.org/latest/user_guides/autoregresive-forecaster.html"><code>ForecasterAutoreg</code></a> and <a href="https://skforecast.org/latest/user_guides/custom-predictors.html"><code>ForecasterAutoregCustom</code></a> classes.</p>
<p style="text-align: center">
<img src="../img/diagram-recursive-mutistep-forecasting.png" style="width: 650px">
<br>
<font size="2.5"> <i>Diagram of recursive multi-step forecasting.</i></font>
</p>

<h3 id="direct-multi-step-forecasting">Direct multi-step forecasting<a class="headerlink" href="#direct-multi-step-forecasting" title="Permanent link">&para;</a></h3>
<p>Direct multi-step forecasting consists of training a different model for each step of the forecast horizon. For example, to predict the next 5 values of a time series, 5 different models are trained, one for each step. As a result, the predictions are independent of each other. This entire process is automated in the <a href="https://skforecast.org/latest/user_guides/direct-multi-step-forecasting.html"><code>ForecasterAutoregDirect</code></a> class. </p>
<p style="text-align: center">
<img src="../img/diagram-direct-multi-step-forecasting.png" style="width: 700px">
<br>
<font size="2.5"> <i>Diagram of direct multi-step forecasting.</i></font>
</p>

<h3 id="multiple-output-forecasting">Multiple output forecasting<a class="headerlink" href="#multiple-output-forecasting" title="Permanent link">&para;</a></h3>
<p>Some machine learning models, such as long short-term memory (LSTM) neural network, can predict simultaneously several values of a sequence (<em>one-shot</em>). This strategy is not currently implemented in skforecast library.</p>
<h2 id="multi-time-series-forecasting">Multi-time series forecasting<a class="headerlink" href="#multi-time-series-forecasting" title="Permanent link">&para;</a></h2>
<p>In univariate time series forecasting, a single time series is modeled as a linear or nonlinear combination of its lags, where past values of the series are used to forecast its future. In multi-series forecasting, two or more time series are modeled together using a single model. There are two distinct strategies for multi-series forecasting.</p>
<h3 id="independent-multi-series-forecasting">Independent Multi-Series Forecasting<a class="headerlink" href="#independent-multi-series-forecasting" title="Permanent link">&para;</a></h3>
<p>A single model is trained for all time series, but each time series remains independent of the others, meaning that past values of one series are not used as predictors of other series. However, modeling them together is useful because the series may follow the same intrinsic pattern regarding their past and future values. For instance, the sales of products A and B in the same store may not be related, but they follow the same dynamics, that of the store.</p>
<p style="text-align: center">
<img src="../img/forecaster_multi_series_train_matrix_diagram.png" style="width: 800px">
<br>
<font size="2.5"> <i>Transformation of two time series and an exogenous variable into the matrices needed to train a machine learning model in a multi-series context.</i></font>
</p>

<p>To predict the next <em>n</em> steps, the strategy of <a href="https://skforecast.org/latest/introduction-forecasting/introduction-forecasting.html#recursive-multi-step-forecasting">recursive multi-step forecasting</a> is applied</p>
<p style="text-align: center">
<img src="../img/forecaster_multi_series_prediction_diagram.png" style="width: 800px">
<br>
<font size="2.5"> <i>Diagram of recursive forecasting with multiple independent time series.</i></font>
</p>

<p>The <a href="https://skforecast.org/latest/user_guides/independent-multi-time-series-forecasting.html"><code>ForecasterAutoregMultiSeries</code></a> and <a href="https://skforecast.org/latest/user_guides/custom-predictors.html#forecasterautoregmultiseriescustom"><code>ForecasterAutoregMultiSeriesCustom</code></a> classes cover this process. </p>
<h3 id="dependent-multi-series-forecasting-multivariate-time-series">Dependent Multi-Series Forecasting (multivariate time series)<a class="headerlink" href="#dependent-multi-series-forecasting-multivariate-time-series" title="Permanent link">&para;</a></h3>
<p>All series are modeled together in a single model, considering that each time series depends not only on its past values but also on the past values of the other series. The forecaster is expected not only to learn the information of each series separately but also to relate them. An example is the measurements made by all the sensors (flow, temperature, pressure...) installed on an industrial machine such as a compressor.</p>
<p style="text-align: center">
<img src="../img/forecaster_multivariate_train_matrix_diagram.png" style="width: 800px">
<br>
<font size="2.5"> <i>Transformation of two time series and an exogenous variable into the matrices needed to train a machine learning model in a multi-variate-series context.</i></font>
</p>

<p>The <a href="https://skforecast.org/latest/user_guides/dependent-multi-series-multivariate-forecasting.html"><code>ForecasterAutoregMultiVariate</code></a> class covers this process. </p>
<h2 id="forecasters">Forecasters<a class="headerlink" href="#forecasters" title="Permanent link">&para;</a></h2>
<p>A Forecaster object in the skforecast library is a comprehensive container that provides essential functionality and methods for training a forecasting model and generating predictions for future points in time.</p>
<p>The skforecast library offers a variety of forecaster types, each tailored to specific requirements such as single or multiple time series, direct or recursive strategies, or custom predictors. Regardless of the specific forecaster type, all instances share the same API.</p>
<table>
<thead>
<tr>
<th align="left">Forecaster</th>
<th align="center">Single series</th>
<th align="center">Multiple series</th>
<th align="center">Recursive prediction</th>
<th align="center">Probabilistic prediction</th>
<th align="center">Exogenous features</th>
<th align="center">Custom features</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="https://skforecast.org/latest/user_guides/autoregresive-forecaster.html">ForecasterAutoreg</a></td>
<td align="center">✔️</td>
<td align="center"></td>
<td align="center">✔️</td>
<td align="center"></td>
<td align="center">✔️</td>
<td align="center">✔️</td>
</tr>
<tr>
<td align="left"><a href="https://skforecast.org/latest/user_guides/custom-predictors.html">ForecasterAutoregCustom</a></td>
<td align="center">✔️</td>
<td align="center"></td>
<td align="center">✔️</td>
<td align="center"></td>
<td align="center">✔️</td>
<td align="center">✔️</td>
</tr>
<tr>
<td align="left"><a href="https://skforecast.org/latest/user_guides/direct-multi-step-forecasting.html">ForecasterAutoregDirect</a></td>
<td align="center">✔️</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">✔️</td>
<td align="center">✔️</td>
<td align="center">✔️</td>
</tr>
<tr>
<td align="left"><a href="https://skforecast.org/latest/user_guides/independent-multi-time-series-forecasting.html">ForecasterMultiSeries</a></td>
<td align="center"></td>
<td align="center">✔️</td>
<td align="center">✔️</td>
<td align="center"></td>
<td align="center">✔️</td>
<td align="center">✔️</td>
</tr>
<tr>
<td align="left"><a href="https://skforecast.org/latest/user_guides/custom-predictors.html">ForecasterMultiSeriesCustom</a></td>
<td align="center"></td>
<td align="center">✔️</td>
<td align="center">✔️</td>
<td align="center"></td>
<td align="center">✔️</td>
<td align="center">✔️</td>
</tr>
<tr>
<td align="left"><a href="https://skforecast.org/latest/user_guides/dependent-multi-series-multivariate-forecasting.html">ForecasterMultiVariate</a></td>
<td align="center"></td>
<td align="center">✔️</td>
<td align="center"></td>
<td align="center">✔️</td>
<td align="center">✔️</td>
<td align="center">✔️</td>
</tr>
<tr>
<td align="left"><a href="https://skforecast.org/latest/user_guides/forecasting-sarimax-arima.html">ForecasterSarimax</a></td>
<td align="center">✔️</td>
<td align="center"></td>
<td align="center">✔️</td>
<td align="center"></td>
<td align="center">✔️</td>
<td align="center">✔️</td>
</tr>
</tbody>
</table>
<p>To understand what can be done when initializing a forecaster with <strong>skforecast</strong> visit <a href="https://skforecast.org/latest/introduction-forecasting/forecaster-parameters">Forecaster parameters</a> and <a href="https://skforecast.org/latest/introduction-forecasting/forecaster-attributes">Forecaster attributes</a>.</p>
<h2 id="backtesting-forecasting-models">Backtesting forecasting models<a class="headerlink" href="#backtesting-forecasting-models" title="Permanent link">&para;</a></h2>
<p>In time series forecasting, the process of <em>backtesting</em> consists of evaluating the performance of a predictive model by applying it retrospectively to historical data. Therefore, it is a special type of cross-validation applied to the previous period(s).</p>
<p>The purpose of backtesting is to evaluate the accuracy and effectiveness of a model and identify any potential issues or areas of improvement. By testing the model on historical data, one can assess how well it performs on data that it has not seen before. This is an important step in the modeling process, as it helps to ensure that the model is robust and reliable.</p>
<p>Backtesting can be done using a variety of techniques, such as simple train-test splits or more sophisticated methods like rolling windows or expanding windows. The choice of method depends on the specific needs of the analysis and the characteristics of the time series data.</p>
<p>Overall, backtesting is an essential step in the development of a time series forecasting model. By rigorously testing the model on historical data, one can improve its accuracy and ensure that it is effective at predicting future values of the time series.</p>
<h3 id="backtesting-without-refit">Backtesting without refit<a class="headerlink" href="#backtesting-without-refit" title="Permanent link">&para;</a></h3>
<p>Backtesting without refit is a strategy where the model is trained only once and used sequentially without updating it, following the temporal order of the data. This approach is advantageous as it is much faster than other methods that require retraining the model each time. However, the model may lose its predictive power over time as it does not incorporate the latest information available.</p>
<p style="text-align: center">
<img src="../img/diagram-backtesting-no-refit.png" style="width: 500px;">
</p>

<p style="text-align: center">
<img src="../img/backtesting_no_refit.gif" style="width: 650px;">
<br>
<font size="2.5"> <i>Backtesting without refit.</i></font>
</p>

<h3 id="backtesting-with-refit-and-increasing-training-size-fixed-origin">Backtesting with refit and increasing training size (fixed origin)<a class="headerlink" href="#backtesting-with-refit-and-increasing-training-size-fixed-origin" title="Permanent link">&para;</a></h3>
<p>In this approach, the model is trained before making predictions each time, and all available data up to that point is used in the training process. This differs from standard cross-validation, where the data is randomly distributed between training and validation sets.</p>
<p>Instead of randomizing the data, this backtesting sequentially increases the size of the training set while maintaining the temporal order of the data. By doing this, the model can be tested on progressively larger amounts of historical data, providing a more accurate assessment of its predictive capabilities.</p>
<p style="text-align: center">
<img src="../img/diagram-backtesting-refit.png" style="width: 500px;">
</p>

<p style="text-align: center">
<img src="../img/backtesting_refit.gif" style="width: 650px;">
<br>
<font size="2.5"> <i>Backtesting with refit and increasing training size (fixed origin).</i></font>
</p>

<h3 id="backtesting-with-refit-and-fixed-training-size-rolling-origin">Backtesting with refit and fixed training size (rolling origin)<a class="headerlink" href="#backtesting-with-refit-and-fixed-training-size-rolling-origin" title="Permanent link">&para;</a></h3>
<p>In this approach, the model is trained using a fixed window of past observations, and the testing is performed on a rolling basis, where the training window is moved forward in time. The size of the training window is kept constant, allowing for the model to be tested on different sections of the data. This technique is particularly useful when there is a limited amount of data available, or when the data is non-stationary, and the model's performance may vary over time. Is also known as time series cross-validation or walk-forward validation.</p>
<p style="text-align: center">
<img src="../img/diagram-backtesting-refit-fixed-train-size.png" style="width: 500px;">
</p>

<p style="text-align: center">
<img src="../img/backtesting_refit_fixed_train_size.gif" style="width: 650px;">
<br>
<font size="2.5"> <i>Backtesting with refit and fixed training size (rolling origin).</i></font>
</p>

<h3 id="backtesting-with-intermittent-refit">Backtesting with intermittent refit<a class="headerlink" href="#backtesting-with-intermittent-refit" title="Permanent link">&para;</a></h3>
<p>The model is retrained every <em>n</em> iterations, a method often used when the model retraining is limited to certain time intervals, such as weekly, but a different time window, such as a day, needs to be used for prediction.</p>
<p>This refit strategy can be implemented using either a fixed or rolling origin, providing flexibility in adapting the model to new data.</p>
<p style="text-align: center">
<img src="../img/backtesting_intermittent_refit.gif" style="width: 650px;">
<br>
<font size="2.5"> <i>Backtesting with intermittent refit.</i></font>
</p>

<h3 id="backtesting-including-gap">Backtesting including gap<a class="headerlink" href="#backtesting-including-gap" title="Permanent link">&para;</a></h3>
<p>This approach introduces a time gap between the training and test sets, replicating a scenario where predictions cannot be made immediately after the end of the training data.</p>
<p>For example, consider the goal of predicting the 24 hours of day D+1, but the predictions need to be made at 11:00 to allow sufficient flexibility. At 11:00 on day D, the task is to forecast hours [12 - 23] of the same day and hours [0 - 23] of day D+1. Thus, a total of 36 hours into the future must be predicted, with only the last 24 hours to be stored.</p>
<p style="text-align: center">
<img src="../img/backtesting_refit_gap.gif" style="width: 650px;">
<br>
<font size="2.5"> <i>Backtesting with refit and gap.</i></font>
</p>

<h3 id="which-strategy-should-i-use">Which strategy should I use?<a class="headerlink" href="#which-strategy-should-i-use" title="Permanent link">&para;</a></h3>
<p>To ensure an accurate evaluation of your model and gain confidence in its predictive performance on new data, it is critical to employ an appropriate backtesting strategy.</p>
<p>To determine an appropriate strategy, factors such as use case characteristics, available computing resources, and time intervals between predictions must be considered. These factors determine when the model should be refitted and the prediction horizon that should be used.</p>
<ul>
<li>
<p><strong>Prediction horizon</strong>: Suppose you need to predict the users of an App every Monday for the entire week. In this case, each iteration would be a seven-step prediction representing the seven days of the week.</p>
</li>
<li>
<p><strong>Refit strategy</strong>: Continuing with the example above, at the end of the week you need to decide whether or not to update the model. Training the model with additional data can improve its predictive ability, but it requires more time and computational resources, which may not always be readily available. A reasonable approach is to retrain the model when the error metric shows a consistent upward trend. This behavior can be effectively simulated using the backtesting framework.</p>
</li>
</ul>
<p>As an example, backtesting is performed using the data from this <a href="https://www.cienciadedatos.net/documentos/py29-forecasting-electricity-power-demand-python.html">skforecast example</a>. The same backtest is run with different <code>refit</code> strategies: <code>False</code> (no refit between predictions), refit every <code>30</code> days, every <code>14</code> days, every <code>7</code> days and <code>True</code> (refit after every predictions). Notice that the significant increase in time does not correspond to a decrease in error.</p>
<table>
<thead>
<tr>
<th align="right">refit value</th>
<th align="right">execution time (s)</th>
<th align="right">metric</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">False</td>
<td align="right">1.4</td>
<td align="right">262.5</td>
</tr>
<tr>
<td align="right">30</td>
<td align="right">4.0</td>
<td align="right">263.4</td>
</tr>
<tr>
<td align="right">14</td>
<td align="right">6.3</td>
<td align="right">262.5</td>
</tr>
<tr>
<td align="right">7</td>
<td align="right">11.1</td>
<td align="right">261.4</td>
</tr>
<tr>
<td align="right">True</td>
<td align="right">69.1</td>
<td align="right">258.3</td>
</tr>
</tbody>
</table>
<p>For a code example illustrating the backtesting process, refer to the <a href="https://skforecast.org/latest/user_guides/backtesting.html">Backtesting user guide</a>.</p>


  




                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 - 2023 Joaquín Amat Rodrigo, Javier Escobar Ortiz
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.b4d07000.min.js"></script>
      
    
  </body>
</html>