
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python library that eases using scikit-learn regressors as multi-step forecasters. It also works with any regressor compatible with the scikit-learn API (XGBoost, LightGBM, Ranger...).">
      
      
        <meta name="author" content="Joaquin Amat Rodrigo and Javier Escobar Ortiz">
      
      
        <link rel="canonical" href="https://joaquinamatrodrigo.github.io/skforecast/0.8.1/api/model_selection.html">
      
      
        <link rel="prev" href="ForecasterSarimax.html">
      
      
        <link rel="next" href="model_selection_multiseries.html">
      
      <link rel="icon" href="../img/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.15">
    
    
      
        <title>model_selection - Skforecast Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-GR8X9Z9LKL"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-GR8X9Z9LKL",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-GR8X9Z9LKL",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#model_selection" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Skforecast Docs" class="md-header__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast-orange-no-backgound.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Skforecast Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              model_selection
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/JoaquinAmatRodrigo/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-tabs__link">
        Introduction to forecasting
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../user_guides/quick-start-skforecast.html" class="md-tabs__link">
      Quick start
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../user_guides/input-data.html" class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../examples/examples.html" class="md-tabs__link">
        Examples and tutorials
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="ForecasterAutoreg.html" class="md-tabs__link md-tabs__link--active">
        API Reference
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../faq/faq.html" class="md-tabs__link">
        FAQ and Tips
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../releases/releases.html" class="md-tabs__link">
      Releases
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Skforecast Docs" class="md-nav__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast-orange-no-backgound.png" alt="logo">

    </a>
    Skforecast Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/JoaquinAmatRodrigo/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Welcome to skforecast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-nav__link">
        Introduction to forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/quick-start-skforecast.html" class="md-nav__link">
        Quick start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/input-data.html" class="md-nav__link">
        User Guides
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples.html" class="md-nav__link">
        Examples and tutorials
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoreg.html" class="md-nav__link">
        API Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/faq.html" class="md-nav__link">
        FAQ and Tips
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../releases/releases.html" class="md-nav__link">
        Releases
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Introduction to forecasting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Introduction to forecasting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-nav__link">
        Introduction to forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/forecaster-parameters.html" class="md-nav__link">
        Forecaster Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/forecaster-attributes.html" class="md-nav__link">
        Forecaster Attributes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/quick-start-skforecast.html" class="md-nav__link">
        Quick start
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          User Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/input-data.html" class="md-nav__link">
        Input data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/autoregresive-forecaster.html" class="md-nav__link">
        Recursive multi-step forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/direct-multi-step-forecasting.html" class="md-nav__link">
        Direct multi-step forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/independent-multi-time-series-forecasting.html" class="md-nav__link">
        Independent multi-time series forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/dependent-multi-series-multivariate-forecasting.html" class="md-nav__link">
        Dependent multivariate series forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/exogenous-variables.html" class="md-nav__link">
        Exogenous variables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/custom-predictors.html" class="md-nav__link">
        Custom predictors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/weighted-time-series-forecasting.html" class="md-nav__link">
        Weighted time series forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/backtesting.html" class="md-nav__link">
        Backtesting forecaster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/hyperparameter-tuning-and-lags-selection.html" class="md-nav__link">
        Hyperparameter tuning and lags selection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/sklearn-transformers-and-pipeline.html" class="md-nav__link">
        Scikit-learn Transformers and Pipelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/probabilistic-forecasting.html" class="md-nav__link">
        Probabilistic forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/feature-importances.html" class="md-nav__link">
        Feature importances
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/categorical-features.html" class="md-nav__link">
        Categorical features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-xgboost-lightgbm.html" class="md-nav__link">
        Forecasting with XGBoost and LightGBM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-sarimax-arima.html" class="md-nav__link">
        Forecasting SARIMAX and ARIMA models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/save-load-forecaster.html" class="md-nav__link">
        Save and load forecaster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecaster-in-production.html" class="md-nav__link">
        Forecaster in production
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/shap-values-skforecast.html" class="md-nav__link">
        Shap-values
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/skforecast-in-GPU.html" class="md-nav__link">
        Skforecast in GPU
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/plot-forecaster-residuals.html" class="md-nav__link">
        Plot forecaster residuals
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Examples and tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Examples and tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples.html" class="md-nav__link">
        Examples and tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoreg.html" class="md-nav__link">
        ForecasterAutoreg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoregCustom.html" class="md-nav__link">
        ForecasterAutoregCustom
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoregDirect.html" class="md-nav__link">
        ForecasterAutoregDirect
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiSeries.html" class="md-nav__link">
        ForecasterMultiSeries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiSeriesCustom.html" class="md-nav__link">
        ForecasterMultiSeriesCustom
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiVariate.html" class="md-nav__link">
        ForecasterMultiVariate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterSarimax.html" class="md-nav__link">
        ForecasterSarimax
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          model_selection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="model_selection.html" class="md-nav__link md-nav__link--active">
        model_selection
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.backtesting_forecaster" class="md-nav__link">
    backtesting_forecaster()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.grid_search_forecaster" class="md-nav__link">
    grid_search_forecaster()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.random_search_forecaster" class="md-nav__link">
    random_search_forecaster()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.bayesian_search_forecaster" class="md-nav__link">
    bayesian_search_forecaster()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="model_selection_multiseries.html" class="md-nav__link">
        model_selection_multiseries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="model_selection_sarimax.html" class="md-nav__link">
        model_selection_sarimax
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="plot.html" class="md-nav__link">
        plot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="utils.html" class="md-nav__link">
        utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="exceptions.html" class="md-nav__link">
        exceptions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          FAQ and Tips
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          FAQ and Tips
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/faq.html" class="md-nav__link">
        Table of contents
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/profiling-skforecast.html" class="md-nav__link">
        Profiling skforecast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/non-negative-predictions.html" class="md-nav__link">
        Avoid negative predictions when forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-time-series-with-missing-values.html" class="md-nav__link">
        Forecasting time series with missing values
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../releases/releases.html" class="md-nav__link">
        Releases
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.backtesting_forecaster" class="md-nav__link">
    backtesting_forecaster()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.grid_search_forecaster" class="md-nav__link">
    grid_search_forecaster()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.random_search_forecaster" class="md-nav__link">
    random_search_forecaster()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.bayesian_search_forecaster" class="md-nav__link">
    bayesian_search_forecaster()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="model_selection"><code>model_selection</code><a class="headerlink" href="#model_selection" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-function">



<h2 id="skforecast.model_selection.model_selection.backtesting_forecaster" class="doc doc-heading">
<code class="highlight language-python"><span class="n">backtesting_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.model_selection.model_selection.backtesting_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Backtesting of forecaster model.</p>
<p>If <code>refit</code> is False, the model is trained only once using the <code>initial_train_size</code>
first observations. If <code>refit</code> is True, the model is trained in each iteration
increasing the training set. A copy of the original forecaster is created so 
it is not modified during the process.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>forecaster</code></td>
          <td>
                <code><span title="skforecast.ForecasterAutoreg">ForecasterAutoreg</span>, <span title="skforecast.ForecasterAutoregCustom">ForecasterAutoregCustom</span>, <span title="skforecast.ForecasterAutoregDirect">ForecasterAutoregDirect</span></code>
          </td>
          <td><p>Forecaster model.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y</code></td>
          <td>
                <code>pandas Series</code>
          </td>
          <td><p>Training time series.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>steps</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of steps to predict.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>metric</code></td>
          <td>
                <code>str, <span title="typing.Callable">Callable</span>, list</code>
          </td>
          <td><p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If string: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error'}</li>
<li>If Callable: Function with arguments y_true, y_pred that returns a float.</li>
<li>If list: List containing multiple strings and/or Callables.</li>
</ul></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>initial_train_size</code></td>
          <td>
                <code>int, default</code>
          </td>
          <td><p>Number of samples in the initial train split. If <code>None</code> and <code>forecaster</code> is 
already trained, no initial train is done and all data is used to evaluate the 
model. However, the first <code>len(forecaster.last_window)</code> observations are needed 
to create the initial predictors, so no predictions are calculated for them. 
This useful to backtest the model on the same data used to train it.
<code>None</code> is only allowed when <code>refit</code> is <code>False</code> and <code>forecaster</code> is already
trained.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>fixed_train_size</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>If True, train size doesn't increase but moves by <code>steps</code> in each iteration.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>gap</code></td>
          <td>
                <code>int, default</code>
          </td>
          <td><p>Number of samples to be excluded after the end of each training set and 
before the test set.</p></td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>allow_incomplete_fold</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>Last fold is allowed to have a smaller number of samples than the 
<code>test_size</code>. If <code>False</code>, the last fold is excluded.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas Series, pandas DataFrame, default </code>
          </td>
          <td><p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>refit</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>Whether to re-fit the forecaster in each iteration.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>interval</code></td>
          <td>
                <code>list, default</code>
          </td>
          <td><p>Confidence of the prediction interval estimated. Sequence of percentiles
to compute, which must be between 0 and 100 inclusive. For example, 
interval of 95% should be as <code>interval = [2.5, 97.5]</code>. If <code>None</code>, no
intervals are estimated.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>n_boot</code></td>
          <td>
                <code>int, default</code>
          </td>
          <td><p>Number of bootstrapping iterations used to estimate prediction
intervals.</p></td>
          <td>
                <code>500</code>
          </td>
        </tr>
        <tr>
          <td><code>random_state</code></td>
          <td>
                <code>int, default</code>
          </td>
          <td><p>Sets a seed to the random generator, so that boot intervals are always 
deterministic.</p></td>
          <td>
                <code>123</code>
          </td>
        </tr>
        <tr>
          <td><code>in_sample_residuals</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>If <code>True</code>, residuals from the training data are used as proxy of prediction 
error to create prediction intervals.  If <code>False</code>, out_sample_residuals 
are used if they are already stored inside the forecaster.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>Print number of folds and index of training and validation sets used 
for backtesting.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>show_progress</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to show a progress bar. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>metrics_value</code></td>          <td>
                <code>float, list</code>
          </td>
          <td><p>Value(s) of the metric(s).</p></td>
        </tr>
        <tr>
<td><code>backtest_predictions</code></td>          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>Value of predictions and their estimated interval if <code>interval</code> is not <code>None</code>.</p>
<ul>
<li>column pred: predictions.</li>
<li>column lower_bound: lower bound of the interval.</li>
<li>column upper_bound: upper bound of the interval.</li>
</ul></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>skforecast/model_selection/model_selection.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">backtesting_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Backtesting of forecaster model.</span>

<span class="sd">    If `refit` is False, the model is trained only once using the `initial_train_size`</span>
<span class="sd">    first observations. If `refit` is True, the model is trained in each iteration</span>
<span class="sd">    increasing the training set. A copy of the original forecaster is created so </span>
<span class="sd">    it is not modified during the process.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterAutoreg, ForecasterAutoregCustom, ForecasterAutoregDirect</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series.</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of steps to predict.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">            - If string: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">             &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;}</span>
<span class="sd">            - If Callable: Function with arguments y_true, y_pred that returns a float.</span>
<span class="sd">            - If list: List containing multiple strings and/or Callables.</span>
<span class="sd">    initial_train_size : int, default `None`</span>
<span class="sd">        Number of samples in the initial train split. If `None` and `forecaster` is </span>
<span class="sd">        already trained, no initial train is done and all data is used to evaluate the </span>
<span class="sd">        model. However, the first `len(forecaster.last_window)` observations are needed </span>
<span class="sd">        to create the initial predictors, so no predictions are calculated for them. </span>
<span class="sd">        This useful to backtest the model on the same data used to train it.</span>
<span class="sd">        `None` is only allowed when `refit` is `False` and `forecaster` is already</span>
<span class="sd">        trained.</span>
<span class="sd">    fixed_train_size : bool, default `True`</span>
<span class="sd">        If True, train size doesn&#39;t increase but moves by `steps` in each iteration.</span>
<span class="sd">    gap : int, default `0`</span>
<span class="sd">        Number of samples to be excluded after the end of each training set and </span>
<span class="sd">        before the test set.</span>
<span class="sd">    allow_incomplete_fold : bool, default `True`</span>
<span class="sd">        Last fold is allowed to have a smaller number of samples than the </span>
<span class="sd">        `test_size`. If `False`, the last fold is excluded.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    refit : bool, default `False`</span>
<span class="sd">        Whether to re-fit the forecaster in each iteration.</span>
<span class="sd">    interval : list, default `None`</span>
<span class="sd">        Confidence of the prediction interval estimated. Sequence of percentiles</span>
<span class="sd">        to compute, which must be between 0 and 100 inclusive. For example, </span>
<span class="sd">        interval of 95% should be as `interval = [2.5, 97.5]`. If `None`, no</span>
<span class="sd">        intervals are estimated.</span>
<span class="sd">    n_boot : int, default `500`</span>
<span class="sd">        Number of bootstrapping iterations used to estimate prediction</span>
<span class="sd">        intervals.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random generator, so that boot intervals are always </span>
<span class="sd">        deterministic.</span>
<span class="sd">    in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of prediction </span>
<span class="sd">        error to create prediction intervals.  If `False`, out_sample_residuals </span>
<span class="sd">        are used if they are already stored inside the forecaster.</span>
<span class="sd">    verbose : bool, default `False`</span>
<span class="sd">        Print number of folds and index of training and validation sets used </span>
<span class="sd">        for backtesting.</span>
<span class="sd">    show_progress: bool, default `True`</span>
<span class="sd">        Whether to show a progress bar. Defaults to True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    metrics_value : float, list</span>
<span class="sd">        Value(s) of the metric(s).</span>
<span class="sd">    backtest_predictions : pandas DataFrame</span>
<span class="sd">        Value of predictions and their estimated interval if `interval` is not `None`.</span>

<span class="sd">            - column pred: predictions.</span>
<span class="sd">            - column lower_bound: lower bound of the interval.</span>
<span class="sd">            - column upper_bound: upper bound of the interval.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoreg&#39;</span><span class="p">,</span> 
                                         <span class="s1">&#39;ForecasterAutoregCustom&#39;</span><span class="p">,</span> 
                                         <span class="s1">&#39;ForecasterAutoregDirect&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;`forecaster` must be of type `ForecasterAutoreg`, `ForecasterAutoregCustom` &quot;</span>
             <span class="s2">&quot;or `ForecasterAutoregDirect`, for all other types of forecasters &quot;</span>
             <span class="s2">&quot;use the functions available in the other `model_selection` modules.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">check_backtesting_input</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
        <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
        <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
        <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
        <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
        <span class="n">interval</span>              <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
        <span class="n">n_boot</span>                <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
        <span class="n">random_state</span>          <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
        <span class="n">in_sample_residuals</span>   <span class="o">=</span> <span class="n">in_sample_residuals</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ForecasterAutoregDirect&#39;</span> <span class="ow">and</span> \
       <span class="n">forecaster</span><span class="o">.</span><span class="n">steps</span> <span class="o">&lt;</span> <span class="n">steps</span> <span class="o">+</span> <span class="n">gap</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;When using a ForecasterAutoregDirect, the combination of steps &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;+ gap (</span><span class="si">{</span><span class="n">steps</span><span class="o">+</span><span class="n">gap</span><span class="si">}</span><span class="s2">) cannot be greater than the `steps` parameter &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;declared when the forecaster is initialized (</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">refit</span><span class="p">:</span>
        <span class="n">metrics_values</span><span class="p">,</span> <span class="n">backtest_predictions</span> <span class="o">=</span> <span class="n">_backtesting_forecaster_refit</span><span class="p">(</span>
            <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
            <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
            <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
            <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
            <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
            <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
            <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
            <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
            <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
            <span class="n">interval</span>              <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
            <span class="n">n_boot</span>                <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
            <span class="n">random_state</span>          <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
            <span class="n">in_sample_residuals</span>   <span class="o">=</span> <span class="n">in_sample_residuals</span><span class="p">,</span>
            <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
            <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">metrics_values</span><span class="p">,</span> <span class="n">backtest_predictions</span> <span class="o">=</span> <span class="n">_backtesting_forecaster_no_refit</span><span class="p">(</span>
            <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
            <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
            <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
            <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
            <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
            <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
            <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
            <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
            <span class="n">interval</span>              <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
            <span class="n">n_boot</span>                <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
            <span class="n">random_state</span>          <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
            <span class="n">in_sample_residuals</span>   <span class="o">=</span> <span class="n">in_sample_residuals</span><span class="p">,</span>
            <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
            <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span>
        <span class="p">)</span>  

    <span class="k">return</span> <span class="n">metrics_values</span><span class="p">,</span> <span class="n">backtest_predictions</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="skforecast.model_selection.model_selection.grid_search_forecaster" class="doc doc-heading">
<code class="highlight language-python"><span class="n">grid_search_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.model_selection.model_selection.grid_search_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Exhaustive search over specified parameter values for a Forecaster object.
Validation is done using time series backtesting.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>forecaster</code></td>
          <td>
                <code><span title="skforecast.ForecasterAutoreg">ForecasterAutoreg</span>, <span title="skforecast.ForecasterAutoregCustom">ForecasterAutoregCustom</span>, <span title="skforecast.ForecasterAutoregDirect">ForecasterAutoregDirect</span></code>
          </td>
          <td><p>Forcaster model.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y</code></td>
          <td>
                <code>pandas Series</code>
          </td>
          <td><p>Training time series values.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>param_grid</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Dictionary with parameters names (<code>str</code>) as keys and lists of parameter
settings to try as values.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>steps</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of steps to predict.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>metric</code></td>
          <td>
                <code>str, <span title="typing.Callable">Callable</span>, list</code>
          </td>
          <td><p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If string: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error'}</li>
<li>If Callable: Function with arguments y_true, y_pred that returns a float.</li>
<li>If list: List containing multiple strings and/or Callables.</li>
</ul></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>initial_train_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of samples in the initial train split.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fixed_train_size</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>If True, train size doesn't increase but moves by <code>steps</code> in each iteration.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>gap</code></td>
          <td>
                <code>int, default</code>
          </td>
          <td><p>Number of samples to be excluded after the end of each training set and 
before the test set.</p></td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>allow_incomplete_fold</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>Last fold is allowed to have a smaller number of samples than the 
<code>test_size</code>. If <code>False</code>, the last fold is excluded.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas Series, pandas DataFrame, default </code>
          </td>
          <td><p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>lags_grid</code></td>
          <td>
                <code>list of int, lists, numpy ndarray or range, default </code>
          </td>
          <td><p>Lists of <code>lags</code> to try. Only used if forecaster is an instance of 
<code>ForecasterAutoreg</code> or <code>ForecasterAutoregDirect</code>.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>refit</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>Whether to re-fit the forecaster in each iteration of backtesting.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>return_best</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>Print number of folds used for cv or backtesting.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>results</code></td>          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>Results for each combination of parameters.</p>
<ul>
<li>column lags: lags configuration for each iteration.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration.</li>
<li>additional n columns with param = value.</li>
</ul></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>skforecast/model_selection/model_selection.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">grid_search_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exhaustive search over specified parameter values for a Forecaster object.</span>
<span class="sd">    Validation is done using time series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterAutoreg, ForecasterAutoregCustom, ForecasterAutoregDirect</span>
<span class="sd">        Forcaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series values. </span>
<span class="sd">    param_grid : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and lists of parameter</span>
<span class="sd">        settings to try as values.</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of steps to predict.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">            - If string: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">             &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;}</span>
<span class="sd">            - If Callable: Function with arguments y_true, y_pred that returns a float.</span>
<span class="sd">            - If list: List containing multiple strings and/or Callables.</span>
<span class="sd">    initial_train_size : int </span>
<span class="sd">        Number of samples in the initial train split.</span>
<span class="sd">    fixed_train_size : bool, default `True`</span>
<span class="sd">        If True, train size doesn&#39;t increase but moves by `steps` in each iteration.</span>
<span class="sd">    gap : int, default `0`</span>
<span class="sd">        Number of samples to be excluded after the end of each training set and </span>
<span class="sd">        before the test set.</span>
<span class="sd">    allow_incomplete_fold : bool, default `True`</span>
<span class="sd">        Last fold is allowed to have a smaller number of samples than the </span>
<span class="sd">        `test_size`. If `False`, the last fold is excluded.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    lags_grid : list of int, lists, numpy ndarray or range, default `None`</span>
<span class="sd">        Lists of `lags` to try. Only used if forecaster is an instance of </span>
<span class="sd">        `ForecasterAutoreg` or `ForecasterAutoregDirect`.</span>
<span class="sd">    refit : bool, default `False`</span>
<span class="sd">        Whether to re-fit the forecaster in each iteration of backtesting.</span>
<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">            - column lags: lags configuration for each iteration.</span>
<span class="sd">            - column params: parameters configuration for each iteration.</span>
<span class="sd">            - column metric: metric value estimated for each iteration.</span>
<span class="sd">            - additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterGrid</span><span class="p">(</span><span class="n">param_grid</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">param_grid</span>            <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
        <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
        <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
        <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
        <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
        <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">lags_grid</span>             <span class="o">=</span> <span class="n">lags_grid</span><span class="p">,</span>
        <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
        <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="skforecast.model_selection.model_selection.random_search_forecaster" class="doc doc-heading">
<code class="highlight language-python"><span class="n">random_search_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">param_distributions</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.model_selection.model_selection.random_search_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Random search over specified parameter values or distributions for a Forecaster 
object. Validation is done using time series backtesting.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>forecaster</code></td>
          <td>
                <code><span title="skforecast.ForecasterAutoreg">ForecasterAutoreg</span>, <span title="skforecast.ForecasterAutoregCustom">ForecasterAutoregCustom</span>, <span title="skforecast.ForecasterAutoregDirect">ForecasterAutoregDirect</span></code>
          </td>
          <td><p>Forcaster model.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y</code></td>
          <td>
                <code>pandas Series</code>
          </td>
          <td><p>Training time series.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>param_distributions</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Dictionary with parameters names (<code>str</code>) as keys and 
distributions or lists of parameters to try.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>steps</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of steps to predict.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>metric</code></td>
          <td>
                <code>str, <span title="typing.Callable">Callable</span>, list</code>
          </td>
          <td><p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If string: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error'}</li>
<li>If Callable: Function with arguments y_true, y_pred that returns a float.</li>
<li>If list: List containing multiple strings and/or Callables.</li>
</ul></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>initial_train_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of samples in the initial train split.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fixed_train_size</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>If True, train size doesn't increase but moves by <code>steps</code> in each iteration.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>gap</code></td>
          <td>
                <code>int, default</code>
          </td>
          <td><p>Number of samples to be excluded after the end of each training set and 
before the test set.</p></td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>allow_incomplete_fold</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>Last fold is allowed to have a smaller number of samples than the 
<code>test_size</code>. If <code>False</code>, the last fold is excluded.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas Series, pandas DataFrame, default </code>
          </td>
          <td><p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>lags_grid</code></td>
          <td>
                <code>list of int, lists, numpy ndarray or range, default </code>
          </td>
          <td><p>Lists of <code>lags</code> to try. Only used if forecaster is an instance of 
<code>ForecasterAutoreg</code> or <code>ForecasterAutoregDirect</code>.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>refit</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>Whether to re-fit the forecaster in each iteration of backtesting.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>n_iter</code></td>
          <td>
                <code>int, default</code>
          </td>
          <td><p>Number of parameter settings that are sampled per lags configuration. 
n_iter trades off runtime vs quality of the solution.</p></td>
          <td>
                <code>10</code>
          </td>
        </tr>
        <tr>
          <td><code>random_state</code></td>
          <td>
                <code>int, default</code>
          </td>
          <td><p>Sets a seed to the random sampling for reproducible output.</p></td>
          <td>
                <code>123</code>
          </td>
        </tr>
        <tr>
          <td><code>return_best</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>Print number of folds used for cv or backtesting.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>results</code></td>          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>Results for each combination of parameters.</p>
<ul>
<li>column lags: lags configuration for each iteration.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration.</li>
<li>additional n columns with param = value.</li>
</ul></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>skforecast/model_selection/model_selection.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">random_search_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">param_distributions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Random search over specified parameter values or distributions for a Forecaster </span>
<span class="sd">    object. Validation is done using time series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterAutoreg, ForecasterAutoregCustom, ForecasterAutoregDirect</span>
<span class="sd">        Forcaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series. </span>
<span class="sd">    param_distributions : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and </span>
<span class="sd">        distributions or lists of parameters to try.</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of steps to predict.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">            - If string: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">             &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;}</span>
<span class="sd">            - If Callable: Function with arguments y_true, y_pred that returns a float.</span>
<span class="sd">            - If list: List containing multiple strings and/or Callables.</span>
<span class="sd">    initial_train_size : int </span>
<span class="sd">        Number of samples in the initial train split.</span>
<span class="sd">    fixed_train_size : bool, default `True`</span>
<span class="sd">        If True, train size doesn&#39;t increase but moves by `steps` in each iteration.</span>
<span class="sd">    gap : int, default `0`</span>
<span class="sd">        Number of samples to be excluded after the end of each training set and </span>
<span class="sd">        before the test set.</span>
<span class="sd">    allow_incomplete_fold : bool, default `True`</span>
<span class="sd">        Last fold is allowed to have a smaller number of samples than the </span>
<span class="sd">        `test_size`. If `False`, the last fold is excluded.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i]. </span>
<span class="sd">    lags_grid : list of int, lists, numpy ndarray or range, default `None`</span>
<span class="sd">        Lists of `lags` to try. Only used if forecaster is an instance of </span>
<span class="sd">        `ForecasterAutoreg` or `ForecasterAutoregDirect`.</span>
<span class="sd">    refit : bool, default `False`</span>
<span class="sd">        Whether to re-fit the forecaster in each iteration of backtesting.</span>
<span class="sd">    n_iter : int, default `10`</span>
<span class="sd">        Number of parameter settings that are sampled per lags configuration. </span>
<span class="sd">        n_iter trades off runtime vs quality of the solution.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random sampling for reproducible output.</span>
<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">            - column lags: lags configuration for each iteration.</span>
<span class="sd">            - column params: parameters configuration for each iteration.</span>
<span class="sd">            - column metric: metric value estimated for each iteration.</span>
<span class="sd">            - additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterSampler</span><span class="p">(</span><span class="n">param_distributions</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="n">n_iter</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">param_grid</span>            <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
        <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
        <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
        <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
        <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
        <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">lags_grid</span>             <span class="o">=</span> <span class="n">lags_grid</span><span class="p">,</span>
        <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
        <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="skforecast.model_selection.model_selection.bayesian_search_forecaster" class="doc doc-heading">
<code class="highlight language-python"><span class="n">bayesian_search_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">search_space</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;optuna&#39;</span><span class="p">,</span> <span class="n">kwargs_create_study</span><span class="o">=</span><span class="p">{},</span> <span class="n">kwargs_study_optimize</span><span class="o">=</span><span class="p">{},</span> <span class="n">kwargs_gp_minimize</span><span class="o">=</span><span class="s1">&#39;deprecated&#39;</span><span class="p">)</span></code>

<a href="#skforecast.model_selection.model_selection.bayesian_search_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Bayesian optimization for a Forecaster object using time series backtesting and 
optuna library.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>forecaster</code></td>
          <td>
                <code><span title="skforecast.ForecasterAutoreg">ForecasterAutoreg</span>, <span title="skforecast.ForecasterAutoregCustom">ForecasterAutoregCustom</span>, <span title="skforecast.ForecasterAutoregDirect">ForecasterAutoregDirect</span></code>
          </td>
          <td><p>Forcaster model.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y</code></td>
          <td>
                <code>pandas Series</code>
          </td>
          <td><p>Training time series.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>search_space</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span>(optuna)</code>
          </td>
          <td><p>Function with argument <code>trial</code> which returns a dictionary with parameters names 
(<code>str</code>) as keys and Trial object from optuna (trial.suggest_float, 
trial.suggest_int, trial.suggest_categorical) as values.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>steps</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of steps to predict.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>metric</code></td>
          <td>
                <code>str, <span title="typing.Callable">Callable</span>, list</code>
          </td>
          <td><p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If string: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error'}</li>
<li>If Callable: Function with arguments y_true, y_pred that returns a float.</li>
<li>If list: List containing multiple strings and/or Callables.</li>
</ul></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>initial_train_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of samples in the initial train split.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fixed_train_size</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>If True, train size doesn't increase but moves by <code>steps</code> in each iteration.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>gap</code></td>
          <td>
                <code>int, default</code>
          </td>
          <td><p>Number of samples to be excluded after the end of each training set and 
before the test set.</p></td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>allow_incomplete_fold</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>Last fold is allowed to have a smaller number of samples than the 
<code>test_size</code>. If <code>False</code>, the last fold is excluded.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas Series, pandas DataFrame, default </code>
          </td>
          <td><p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>lags_grid</code></td>
          <td>
                <code>list of int, lists, numpy ndarray or range, default </code>
          </td>
          <td><p>Lists of <code>lags</code> to try. Only used if forecaster is an instance of 
<code>ForecasterAutoreg</code> or <code>ForecasterAutoregDirect</code>.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>refit</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>Whether to re-fit the forecaster in each iteration of backtesting.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>n_trials</code></td>
          <td>
                <code>int, default</code>
          </td>
          <td><p>Number of parameter settings that are sampled in each lag configuration.</p></td>
          <td>
                <code>10</code>
          </td>
        </tr>
        <tr>
          <td><code>random_state</code></td>
          <td>
                <code>int, default</code>
          </td>
          <td><p>Sets a seed to the sampling for reproducible output.</p></td>
          <td>
                <code>123</code>
          </td>
        </tr>
        <tr>
          <td><code>return_best</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool, default</code>
          </td>
          <td><p>Print number of folds used for cv or backtesting.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>engine</code></td>
          <td>
                <code>str, default</code>
          </td>
          <td><p>Bayesian optimization runs through the optuna library.</p></td>
          <td>
                <code>&#39;optuna&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs_create_study</code></td>
          <td>
                <code>dict, default</code>
          </td>
          <td><p>Only applies to engine='optuna'. Keyword arguments (key, value mappings) 
to pass to optuna.create_study.</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs_study_optimize</code></td>
          <td>
                <code>dict, default</code>
          </td>
          <td><p>Only applies to engine='optuna'. Other keyword arguments (key, value mappings) 
to pass to study.optimize().</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs_gp_minimize</code></td>
          <td>
                <code>dict, default</code>
          </td>
          <td><p>Only applies to engine='skopt'. Other keyword arguments (key, value mappings) 
to pass to skopt.gp_minimize().
<strong>Deprecated in version 0.7.0</strong></p></td>
          <td>
                <code>&#39;deprecated&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>results</code></td>          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>Results for each combination of parameters.</p>
<ul>
<li>column lags: lags configuration for each iteration.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration.</li>
<li>additional n columns with param = value.</li>
</ul></td>
        </tr>
        <tr>
<td><code>results_opt_best</code></td>          <td>
                <code>optuna object (optuna)  </code>
          </td>
          <td><p>The best optimization result returned as a FrozenTrial optuna object.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>skforecast/model_selection/model_selection.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">bayesian_search_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">search_space</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">n_trials</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">engine</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;optuna&#39;</span><span class="p">,</span>
    <span class="n">kwargs_create_study</span><span class="p">:</span> <span class="nb">dict</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">kwargs_study_optimize</span><span class="p">:</span> <span class="nb">dict</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">kwargs_gp_minimize</span><span class="p">:</span> <span class="n">Any</span><span class="o">=</span><span class="s1">&#39;deprecated&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">object</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bayesian optimization for a Forecaster object using time series backtesting and </span>
<span class="sd">    optuna library.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterAutoreg, ForecasterAutoregCustom, ForecasterAutoregDirect</span>
<span class="sd">        Forcaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series. </span>
<span class="sd">    search_space : Callable (optuna)</span>
<span class="sd">        Function with argument `trial` which returns a dictionary with parameters names </span>
<span class="sd">        (`str`) as keys and Trial object from optuna (trial.suggest_float, </span>
<span class="sd">        trial.suggest_int, trial.suggest_categorical) as values.</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of steps to predict.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">            - If string: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">             &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;}</span>
<span class="sd">            - If Callable: Function with arguments y_true, y_pred that returns a float.</span>
<span class="sd">            - If list: List containing multiple strings and/or Callables.</span>
<span class="sd">    initial_train_size : int </span>
<span class="sd">        Number of samples in the initial train split.</span>
<span class="sd">    fixed_train_size : bool, default `True`</span>
<span class="sd">        If True, train size doesn&#39;t increase but moves by `steps` in each iteration.</span>
<span class="sd">    gap : int, default `0`</span>
<span class="sd">        Number of samples to be excluded after the end of each training set and </span>
<span class="sd">        before the test set.</span>
<span class="sd">    allow_incomplete_fold : bool, default `True`</span>
<span class="sd">        Last fold is allowed to have a smaller number of samples than the </span>
<span class="sd">        `test_size`. If `False`, the last fold is excluded.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i]. </span>
<span class="sd">    lags_grid : list of int, lists, numpy ndarray or range, default `None`</span>
<span class="sd">        Lists of `lags` to try. Only used if forecaster is an instance of </span>
<span class="sd">        `ForecasterAutoreg` or `ForecasterAutoregDirect`.</span>
<span class="sd">    refit : bool, default `False`</span>
<span class="sd">        Whether to re-fit the forecaster in each iteration of backtesting.</span>
<span class="sd">    n_trials : int, default `10`</span>
<span class="sd">        Number of parameter settings that are sampled in each lag configuration.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the sampling for reproducible output.</span>
<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    engine : str, default `&#39;optuna&#39;`</span>
<span class="sd">        Bayesian optimization runs through the optuna library.</span>
<span class="sd">    kwargs_create_study : dict, default `{&#39;direction&#39;:&#39;minimize&#39;, &#39;sampler&#39;:TPESampler(seed=123)}`</span>
<span class="sd">        Only applies to engine=&#39;optuna&#39;. Keyword arguments (key, value mappings) </span>
<span class="sd">        to pass to optuna.create_study.</span>
<span class="sd">    kwargs_study_optimize : dict, default `{}`</span>
<span class="sd">        Only applies to engine=&#39;optuna&#39;. Other keyword arguments (key, value mappings) </span>
<span class="sd">        to pass to study.optimize().</span>
<span class="sd">    kwargs_gp_minimize : dict, default `{}`</span>
<span class="sd">        Only applies to engine=&#39;skopt&#39;. Other keyword arguments (key, value mappings) </span>
<span class="sd">        to pass to skopt.gp_minimize().</span>
<span class="sd">        **Deprecated in version 0.7.0**</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">            - column lags: lags configuration for each iteration.</span>
<span class="sd">            - column params: parameters configuration for each iteration.</span>
<span class="sd">            - column metric: metric value estimated for each iteration.</span>
<span class="sd">            - additional n columns with param = value.</span>
<span class="sd">    results_opt_best : optuna object (optuna)  </span>
<span class="sd">        The best optimization result returned as a FrozenTrial optuna object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">return_best</span> <span class="ow">and</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;`exog` must have same number of samples as `y`. &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;length `exog`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s1">), length `y`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">engine</span> <span class="o">==</span> <span class="s1">&#39;skopt&#39;</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;The engine &#39;skopt&#39; for `bayesian_search_forecaster` is deprecated &quot;</span>
             <span class="s2">&quot;in favor of &#39;optuna&#39; engine. To continue using it, use skforecast &quot;</span>
             <span class="s2">&quot;0.6.0. The optimization will be performed using the &#39;optuna&#39; engine.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">engine</span> <span class="o">=</span> <span class="s1">&#39;optuna&#39;</span>

    <span class="k">if</span> <span class="n">engine</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;optuna&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;`engine` only allows &#39;optuna&#39;, got </span><span class="si">{</span><span class="n">engine</span><span class="si">}</span><span class="s2">.&quot;&quot;&quot;</span>
        <span class="p">)</span>

    <span class="n">results</span><span class="p">,</span> <span class="n">results_opt_best</span> <span class="o">=</span> <span class="n">_bayesian_search_optuna</span><span class="p">(</span>
                                    <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
                                    <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
                                    <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                                    <span class="n">lags_grid</span>             <span class="o">=</span> <span class="n">lags_grid</span><span class="p">,</span>
                                    <span class="n">search_space</span>          <span class="o">=</span> <span class="n">search_space</span><span class="p">,</span>
                                    <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                                    <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
                                    <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
                                    <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
                                    <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
                                    <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
                                    <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
                                    <span class="n">n_trials</span>              <span class="o">=</span> <span class="n">n_trials</span><span class="p">,</span>
                                    <span class="n">random_state</span>          <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
                                    <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
                                    <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
                                    <span class="n">kwargs_create_study</span>   <span class="o">=</span> <span class="n">kwargs_create_study</span><span class="p">,</span>
                                    <span class="n">kwargs_study_optimize</span> <span class="o">=</span> <span class="n">kwargs_study_optimize</span>
                                <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span><span class="p">,</span> <span class="n">results_opt_best</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>


  




                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 - 2023 Joaquín Amat Rodrigo, Javier Escobar Ortiz
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.b4d07000.min.js"></script>
      
    
  </body>
</html>