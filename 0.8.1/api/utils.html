
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python library that eases using scikit-learn regressors as multi-step forecasters. It also works with any regressor compatible with the scikit-learn API (XGBoost, LightGBM, Ranger...).">
      
      
        <meta name="author" content="Joaquin Amat Rodrigo and Javier Escobar Ortiz">
      
      
        <link rel="canonical" href="https://joaquinamatrodrigo.github.io/skforecast/0.8.1/api/utils.html">
      
      <link rel="icon" href="../img/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.5.3">
    
    
      
        <title>utils - Skforecast Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7a952b86.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-GR8X9Z9LKL"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-GR8X9Z9LKL",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-GR8X9Z9LKL",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="light" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#utils" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Skforecast Docs" class="md-header__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast-orange-no-backgound.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Skforecast Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              utils
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/JoaquinAmatRodrigo/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-tabs__link">
        Introduction to forecasting
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../user_guides/quick-start-skforecast.html" class="md-tabs__link">
      Quick start
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../user_guides/input-data.html" class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../examples/examples.html" class="md-tabs__link">
        Examples and tutorials
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="ForecasterAutoreg.html" class="md-tabs__link md-tabs__link--active">
        API Reference
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../faq/faq.html" class="md-tabs__link">
        FAQ and Tips
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../releases/releases.html" class="md-tabs__link">
      Releases
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Skforecast Docs" class="md-nav__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast-orange-no-backgound.png" alt="logo">

    </a>
    Skforecast Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/JoaquinAmatRodrigo/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Home" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Welcome to skforecast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-nav__link">
        Introduction to forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/quick-start-skforecast.html" class="md-nav__link">
        Quick start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/input-data.html" class="md-nav__link">
        User Guides
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples.html" class="md-nav__link">
        Examples and tutorials
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoreg.html" class="md-nav__link">
        API Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/faq.html" class="md-nav__link">
        FAQ and Tips
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../releases/releases.html" class="md-nav__link">
        Releases
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Introduction to forecasting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Introduction to forecasting" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Introduction to forecasting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-nav__link">
        Introduction to forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/forecaster-parameters.html" class="md-nav__link">
        Forecaster Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/forecaster-attributes.html" class="md-nav__link">
        Forecaster Attributes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/quick-start-skforecast.html" class="md-nav__link">
        Quick start
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          User Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="User Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/input-data.html" class="md-nav__link">
        Input data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/autoregresive-forecaster.html" class="md-nav__link">
        Recursive multi-step forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/direct-multi-step-forecasting.html" class="md-nav__link">
        Direct multi-step forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/independent-multi-time-series-forecasting.html" class="md-nav__link">
        Independent multi-time series forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/dependent-multi-series-multivariate-forecasting.html" class="md-nav__link">
        Dependent multivariate series forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/exogenous-variables.html" class="md-nav__link">
        Exogenous variables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/custom-predictors.html" class="md-nav__link">
        Custom predictors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/weighted-time-series-forecasting.html" class="md-nav__link">
        Weighted time series forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/backtesting.html" class="md-nav__link">
        Backtesting forecaster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/hyperparameter-tuning-and-lags-selection.html" class="md-nav__link">
        Hyperparameter tuning and lags selection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/sklearn-transformers-and-pipeline.html" class="md-nav__link">
        Scikit-learn Transformers and Pipelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/probabilistic-forecasting.html" class="md-nav__link">
        Probabilistic forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/feature-importances.html" class="md-nav__link">
        Feature importances
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/categorical-features.html" class="md-nav__link">
        Categorical features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-xgboost-lightgbm.html" class="md-nav__link">
        Forecasting with XGBoost and LightGBM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-sarimax-arima.html" class="md-nav__link">
        Forecasting SARIMAX and ARIMA models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/save-load-forecaster.html" class="md-nav__link">
        Save and load forecaster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecaster-in-production.html" class="md-nav__link">
        Forecaster in production
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/shap-values-skforecast.html" class="md-nav__link">
        Shap-values
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/skforecast-in-GPU.html" class="md-nav__link">
        Skforecast in GPU
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/plot-forecaster-residuals.html" class="md-nav__link">
        Plot forecaster residuals
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Examples and tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Examples and tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Examples and tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples.html" class="md-nav__link">
        Examples and tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoreg.html" class="md-nav__link">
        ForecasterAutoreg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoregCustom.html" class="md-nav__link">
        ForecasterAutoregCustom
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoregDirect.html" class="md-nav__link">
        ForecasterAutoregDirect
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiSeries.html" class="md-nav__link">
        ForecasterMultiSeries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiSeriesCustom.html" class="md-nav__link">
        ForecasterMultiSeriesCustom
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiVariate.html" class="md-nav__link">
        ForecasterMultiVariate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterSarimax.html" class="md-nav__link">
        ForecasterSarimax
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="model_selection.html" class="md-nav__link">
        model_selection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="model_selection_multiseries.html" class="md-nav__link">
        model_selection_multiseries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="model_selection_sarimax.html" class="md-nav__link">
        model_selection_sarimax
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="plot.html" class="md-nav__link">
        plot
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          utils
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="utils.html" class="md-nav__link md-nav__link--active">
        utils
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.save_forecaster" class="md-nav__link">
    skforecast.utils.utils.save_forecaster
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.save_forecaster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.save_forecaster--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.save_forecaster--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.load_forecaster" class="md-nav__link">
    skforecast.utils.utils.load_forecaster
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.load_forecaster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.load_forecaster--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.load_forecaster--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_lags" class="md-nav__link">
    skforecast.utils.utils.initialize_lags
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.initialize_lags">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_lags--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_lags--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_weights" class="md-nav__link">
    skforecast.utils.utils.initialize_weights
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.initialize_weights">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_weights--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_weights--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_select_fit_kwargs" class="md-nav__link">
    skforecast.utils.utils.check_select_fit_kwargs
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.check_select_fit_kwargs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_select_fit_kwargs--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_select_fit_kwargs--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_y" class="md-nav__link">
    skforecast.utils.utils.check_y
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.check_y">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_y--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_y--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_exog" class="md-nav__link">
    skforecast.utils.utils.check_exog
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.check_exog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_exog--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_exog--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.get_exog_dtypes" class="md-nav__link">
    skforecast.utils.utils.get_exog_dtypes
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.get_exog_dtypes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.get_exog_dtypes--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.get_exog_dtypes--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_exog_dtypes" class="md-nav__link">
    skforecast.utils.utils.check_exog_dtypes
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.check_exog_dtypes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_exog_dtypes--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_exog_dtypes--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_interval" class="md-nav__link">
    skforecast.utils.utils.check_interval
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.check_interval">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_interval--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_interval--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_predict_input" class="md-nav__link">
    skforecast.utils.utils.check_predict_input
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.check_predict_input">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_predict_input--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_predict_input--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_y" class="md-nav__link">
    skforecast.utils.utils.preprocess_y
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.preprocess_y">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_y--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_y--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_last_window" class="md-nav__link">
    skforecast.utils.utils.preprocess_last_window
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.preprocess_last_window">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_last_window--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_last_window--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_exog" class="md-nav__link">
    skforecast.utils.utils.preprocess_exog
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.preprocess_exog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_exog--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_exog--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.cast_exog_dtypes" class="md-nav__link">
    skforecast.utils.utils.cast_exog_dtypes
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.cast_exog_dtypes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.cast_exog_dtypes--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.cast_exog_dtypes--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.exog_to_direct" class="md-nav__link">
    skforecast.utils.utils.exog_to_direct
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.exog_to_direct">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.exog_to_direct--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.exog_to_direct--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.exog_to_direct_numpy" class="md-nav__link">
    skforecast.utils.utils.exog_to_direct_numpy
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.exog_to_direct_numpy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.exog_to_direct_numpy--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.exog_to_direct_numpy--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.expand_index" class="md-nav__link">
    skforecast.utils.utils.expand_index
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.expand_index">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.expand_index--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.expand_index--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.transform_series" class="md-nav__link">
    skforecast.utils.utils.transform_series
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.transform_series">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.transform_series--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.transform_series--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.transform_dataframe" class="md-nav__link">
    skforecast.utils.utils.transform_dataframe
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.transform_dataframe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.transform_dataframe--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.transform_dataframe--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_optional_dependency" class="md-nav__link">
    skforecast.utils.utils.check_optional_dependency
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.check_optional_dependency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_optional_dependency--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_optional_dependency--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.multivariate_time_series_corr" class="md-nav__link">
    skforecast.utils.utils.multivariate_time_series_corr
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.multivariate_time_series_corr">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.multivariate_time_series_corr--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.multivariate_time_series_corr--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_backtesting_input" class="md-nav__link">
    skforecast.utils.utils.check_backtesting_input
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.check_backtesting_input">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_backtesting_input--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_backtesting_input--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="exceptions.html" class="md-nav__link">
        exceptions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          FAQ and Tips
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="FAQ and Tips" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          FAQ and Tips
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/faq.html" class="md-nav__link">
        Table of contents
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/non-negative-predictions.html" class="md-nav__link">
        Avoid negative predictions when forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-time-series-with-missing-values.html" class="md-nav__link">
        Forecasting time series with missing values
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/cyclical-features-time-series.html" class="md-nav__link">
        Cyclical features in time series
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/profiling-skforecast.html" class="md-nav__link">
        Profiling skforecast
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../releases/releases.html" class="md-nav__link">
        Releases
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.save_forecaster" class="md-nav__link">
    skforecast.utils.utils.save_forecaster
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.save_forecaster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.save_forecaster--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.save_forecaster--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.load_forecaster" class="md-nav__link">
    skforecast.utils.utils.load_forecaster
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.load_forecaster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.load_forecaster--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.load_forecaster--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_lags" class="md-nav__link">
    skforecast.utils.utils.initialize_lags
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.initialize_lags">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_lags--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_lags--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_weights" class="md-nav__link">
    skforecast.utils.utils.initialize_weights
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.initialize_weights">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_weights--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_weights--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_select_fit_kwargs" class="md-nav__link">
    skforecast.utils.utils.check_select_fit_kwargs
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.check_select_fit_kwargs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_select_fit_kwargs--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_select_fit_kwargs--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_y" class="md-nav__link">
    skforecast.utils.utils.check_y
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.check_y">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_y--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_y--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_exog" class="md-nav__link">
    skforecast.utils.utils.check_exog
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.check_exog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_exog--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_exog--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.get_exog_dtypes" class="md-nav__link">
    skforecast.utils.utils.get_exog_dtypes
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.get_exog_dtypes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.get_exog_dtypes--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.get_exog_dtypes--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_exog_dtypes" class="md-nav__link">
    skforecast.utils.utils.check_exog_dtypes
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.check_exog_dtypes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_exog_dtypes--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_exog_dtypes--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_interval" class="md-nav__link">
    skforecast.utils.utils.check_interval
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.check_interval">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_interval--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_interval--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_predict_input" class="md-nav__link">
    skforecast.utils.utils.check_predict_input
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.check_predict_input">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_predict_input--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_predict_input--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_y" class="md-nav__link">
    skforecast.utils.utils.preprocess_y
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.preprocess_y">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_y--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_y--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_last_window" class="md-nav__link">
    skforecast.utils.utils.preprocess_last_window
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.preprocess_last_window">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_last_window--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_last_window--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_exog" class="md-nav__link">
    skforecast.utils.utils.preprocess_exog
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.preprocess_exog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_exog--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_exog--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.cast_exog_dtypes" class="md-nav__link">
    skforecast.utils.utils.cast_exog_dtypes
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.cast_exog_dtypes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.cast_exog_dtypes--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.cast_exog_dtypes--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.exog_to_direct" class="md-nav__link">
    skforecast.utils.utils.exog_to_direct
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.exog_to_direct">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.exog_to_direct--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.exog_to_direct--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.exog_to_direct_numpy" class="md-nav__link">
    skforecast.utils.utils.exog_to_direct_numpy
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.exog_to_direct_numpy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.exog_to_direct_numpy--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.exog_to_direct_numpy--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.expand_index" class="md-nav__link">
    skforecast.utils.utils.expand_index
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.expand_index">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.expand_index--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.expand_index--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.transform_series" class="md-nav__link">
    skforecast.utils.utils.transform_series
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.transform_series">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.transform_series--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.transform_series--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.transform_dataframe" class="md-nav__link">
    skforecast.utils.utils.transform_dataframe
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.transform_dataframe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.transform_dataframe--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.transform_dataframe--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_optional_dependency" class="md-nav__link">
    skforecast.utils.utils.check_optional_dependency
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.check_optional_dependency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_optional_dependency--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_optional_dependency--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.multivariate_time_series_corr" class="md-nav__link">
    skforecast.utils.utils.multivariate_time_series_corr
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.multivariate_time_series_corr">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.multivariate_time_series_corr--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.multivariate_time_series_corr--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_backtesting_input" class="md-nav__link">
    skforecast.utils.utils.check_backtesting_input
  </a>
  
    <nav class="md-nav" aria-label="skforecast.utils.utils.check_backtesting_input">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_backtesting_input--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_backtesting_input--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/JoaquinAmatRodrigo/skforecast/edit/master/docs/api/utils.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="utils"><code>utils</code><a class="headerlink" href="#utils" title="Permanent link">&para;</a></h1>


  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.save_forecaster"></a>
    <div class="doc doc-contents first">

      <p>Save forecaster model using joblib.</p>
<h3 id="skforecast.utils.utils.save_forecaster--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.save_forecaster--parameters" title="Permanent link">&para;</a></h3>
<div class="admonition forecaster">
<p class="admonition-title">forecaster</p>
<p>Forecaster created with skforecast library.</p>
</div>
<div class="admonition file_name">
<p class="admonition-title">str</p>
<p>File name given to the object.</p>
</div>
<div class="admonition verbose">
<p class="admonition-title">bool, default <code>True</code></p>
<p>Print summary about the forecaster saved.</p>
</div>
<h3 id="skforecast.utils.utils.save_forecaster--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.save_forecaster--returns" title="Permanent link">&para;</a></h3>
<p>None</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">save_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span> 
    <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save forecaster model using joblib.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster: forecaster</span>
<span class="sd">        Forecaster created with skforecast library.</span>
<span class="sd">    file_name: str</span>
<span class="sd">        File name given to the object.</span>
<span class="sd">    verbose: bool, default `True`</span>
<span class="sd">        Print summary about the forecaster saved.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">file_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">forecaster</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.load_forecaster"></a>
    <div class="doc doc-contents first">

      <p>Load forecaster model using joblib.</p>
<h3 id="skforecast.utils.utils.load_forecaster--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.load_forecaster--parameters" title="Permanent link">&para;</a></h3>
<div class="admonition file_name">
<p class="admonition-title">str</p>
<p>Object file name.</p>
</div>
<div class="admonition verbose">
<p class="admonition-title">bool, default <code>True</code></p>
<p>Print summary about the forecaster loaded.</p>
</div>
<h3 id="skforecast.utils.utils.load_forecaster--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.load_forecaster--returns" title="Permanent link">&para;</a></h3>
<div class="admonition forecaster">
<p class="admonition-title">forecaster</p>
<p>Forecaster created with skforecast library.</p>
</div>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">load_forecaster</span><span class="p">(</span>
    <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load forecaster model using joblib.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file_name: str</span>
<span class="sd">        Object file name.</span>
<span class="sd">    verbose: bool, default `True`</span>
<span class="sd">        Print summary about the forecaster loaded.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    forecaster: forecaster</span>
<span class="sd">        Forecaster created with skforecast library.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">forecaster</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">file_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">forecaster</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">forecaster</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.initialize_lags"></a>
    <div class="doc doc-contents first">

      <p>Check lags argument input and generate the corresponding numpy ndarray.</p>
<h3 id="skforecast.utils.utils.initialize_lags--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.initialize_lags--parameters" title="Permanent link">&para;</a></h3>
<p>forecaster_name : str
    Forecaster name. ForecasterAutoreg, ForecasterAutoregCustom, 
    ForecasterAutoregDirect, ForecasterAutoregMultiSeries, 
    ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate.
lags : Any
    Lags used as predictors.</p>
<h3 id="skforecast.utils.utils.initialize_lags--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.initialize_lags--returns" title="Permanent link">&para;</a></h3>
<p>lags : numpy ndarray
    Lags used as predictors.</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">initialize_lags</span><span class="p">(</span>
    <span class="n">forecaster_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">lags</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check lags argument input and generate the corresponding numpy ndarray.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster_name : str</span>
<span class="sd">        Forecaster name. ForecasterAutoreg, ForecasterAutoregCustom, </span>
<span class="sd">        ForecasterAutoregDirect, ForecasterAutoregMultiSeries, </span>
<span class="sd">        ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate.</span>
<span class="sd">    lags : Any</span>
<span class="sd">        Lags used as predictors.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    lags : numpy ndarray</span>
<span class="sd">        Lags used as predictors.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">lags</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum value of lags allowed is 1.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="n">lags</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lag</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;All values in `lags` must be int.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">range</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">min</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum value of lags allowed is 1.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">range</span><span class="p">)):</span>
        <span class="n">lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">lags</span> <span class="o">=</span> <span class="n">lags</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s1">&#39;ForecasterAutoregMultiVariate&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`lags` argument must be an int, 1d numpy ndarray, range or list. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`lags` argument must be a dict, int, 1d numpy ndarray, range or list. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">lags</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.initialize_weights"></a>
    <div class="doc doc-contents first">

      <p>Check weights arguments, <code>weight_func</code> and <code>series_weights</code> for the different 
forecasters. Create <code>source_code_weight_func</code>, source code of the custom 
function(s) used to create weights.</p>
<h3 id="skforecast.utils.utils.initialize_weights--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.initialize_weights--parameters" title="Permanent link">&para;</a></h3>
<p>forecaster_name : str
    Forecaster name. ForecasterAutoreg, ForecasterAutoregCustom, 
    ForecasterAutoregDirect, ForecasterAutoregMultiSeries, 
    ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate.
regressor : regressor or pipeline compatible with the scikit-learn API
    Regressor of the forecaster.
weight_func : Callable, dict
    Argument <code>weight_func</code> of the forecaster.
series_weights : dict
    Argument <code>series_weights</code> of the forecaster.</p>
<h3 id="skforecast.utils.utils.initialize_weights--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.initialize_weights--returns" title="Permanent link">&para;</a></h3>
<p>weight_func : Callable, dict
    Argument <code>weight_func</code> of the forecaster.
source_code_weight_func : str, dict
    Argument <code>source_code_weight_func</code> of the forecaster.
series_weights : dict
    Argument <code>series_weights</code> of the forecaster.</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">initialize_weights</span><span class="p">(</span>
    <span class="n">forecaster_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">regressor</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">weight_func</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
    <span class="n">series_weights</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check weights arguments, `weight_func` and `series_weights` for the different </span>
<span class="sd">    forecasters. Create `source_code_weight_func`, source code of the custom </span>
<span class="sd">    function(s) used to create weights.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster_name : str</span>
<span class="sd">        Forecaster name. ForecasterAutoreg, ForecasterAutoregCustom, </span>
<span class="sd">        ForecasterAutoregDirect, ForecasterAutoregMultiSeries, </span>
<span class="sd">        ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate.</span>
<span class="sd">    regressor : regressor or pipeline compatible with the scikit-learn API</span>
<span class="sd">        Regressor of the forecaster.</span>
<span class="sd">    weight_func : Callable, dict</span>
<span class="sd">        Argument `weight_func` of the forecaster.</span>
<span class="sd">    series_weights : dict</span>
<span class="sd">        Argument `series_weights` of the forecaster.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    weight_func : Callable, dict</span>
<span class="sd">        Argument `weight_func` of the forecaster.</span>
<span class="sd">    source_code_weight_func : str, dict</span>
<span class="sd">        Argument `source_code_weight_func` of the forecaster.</span>
<span class="sd">    series_weights : dict</span>
<span class="sd">        Argument `series_weights` of the forecaster.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">source_code_weight_func</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">weight_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">weight_func</span><span class="p">,</span> <span class="p">(</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Argument `weight_func` must be a Callable or a dict of &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;Callables. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">weight_func</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">weight_func</span><span class="p">,</span> <span class="n">Callable</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Argument `weight_func` must be a Callable. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">weight_func</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">weight_func</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">source_code_weight_func</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">weight_func</span><span class="p">:</span>
                <span class="n">source_code_weight_func</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">weight_func</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">source_code_weight_func</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">weight_func</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;sample_weight&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Argument `weight_func` is ignored since regressor </span><span class="si">{</span><span class="n">regressor</span><span class="si">}</span><span class="s2"> &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;does not accept `sample_weight` in its `fit` method.&quot;</span><span class="p">),</span>
                 <span class="n">IgnoredArgumentWarning</span>
            <span class="p">)</span>
            <span class="n">weight_func</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">source_code_weight_func</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">series_weights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series_weights</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Argument `series_weights` must be a dict of floats or ints.&quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">series_weights</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;sample_weight&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Argument `series_weights` is ignored since regressor </span><span class="si">{</span><span class="n">regressor</span><span class="si">}</span><span class="s2"> &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;does not accept `sample_weight` in its `fit` method.&quot;</span><span class="p">),</span>
                 <span class="n">IgnoredArgumentWarning</span>
            <span class="p">)</span>
            <span class="n">series_weights</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">weight_func</span><span class="p">,</span> <span class="n">source_code_weight_func</span><span class="p">,</span> <span class="n">series_weights</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.check_select_fit_kwargs"></a>
    <div class="doc doc-contents first">

      <p>Check if <code>fit_kwargs</code> is a dict and select only the keys that are used by
the <code>fit</code> method of the regressor.</p>
<h3 id="skforecast.utils.utils.check_select_fit_kwargs--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.check_select_fit_kwargs--parameters" title="Permanent link">&para;</a></h3>
<p>regressor : object
    Regressor object.
fit_kwargs : dict, default <code>None</code>
    Dictionary with the arguments to pass to the `fit' method of the forecaster.</p>
<h3 id="skforecast.utils.utils.check_select_fit_kwargs--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.check_select_fit_kwargs--returns" title="Permanent link">&para;</a></h3>
<p>fit_kwargs : dict
    Dictionary with the arguments to be passed to the <code>fit</code> method of the 
    regressor after removing the unused keys.</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_select_fit_kwargs</span><span class="p">(</span>
    <span class="n">regressor</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">fit_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if `fit_kwargs` is a dict and select only the keys that are used by</span>
<span class="sd">    the `fit` method of the regressor.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    regressor : object</span>
<span class="sd">        Regressor object.</span>
<span class="sd">    fit_kwargs : dict, default `None`</span>
<span class="sd">        Dictionary with the arguments to pass to the `fit&#39; method of the forecaster.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fit_kwargs : dict</span>
<span class="sd">        Dictionary with the arguments to be passed to the `fit` method of the </span>
<span class="sd">        regressor after removing the unused keys.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">fit_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fit_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fit_kwargs</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Argument `fit_kwargs` must be a dict. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">fit_kwargs</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Non used keys</span>
        <span class="n">non_used_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fit_kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                         <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">non_used_keys</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Argument/s </span><span class="si">{</span><span class="n">non_used_keys</span><span class="si">}</span><span class="s2"> ignored since they are not used by the &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;regressor&#39;s `fit` method.&quot;</span><span class="p">),</span>
                 <span class="n">IgnoredArgumentWarning</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;sample_weight&#39;</span> <span class="ow">in</span> <span class="n">fit_kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;The `sample_weight` argument is ignored. Use `weight_func` to pass &quot;</span>
                 <span class="s2">&quot;a function that defines the individual weights for each sample &quot;</span>
                 <span class="s2">&quot;based on its index.&quot;</span><span class="p">),</span>
                 <span class="n">IgnoredArgumentWarning</span>
            <span class="p">)</span>
            <span class="k">del</span> <span class="n">fit_kwargs</span><span class="p">[</span><span class="s1">&#39;sample_weight&#39;</span><span class="p">]</span>

        <span class="c1"># Select only the keyword arguments allowed by the regressor&#39;s `fit` method.</span>
        <span class="n">fit_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fit_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                      <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">fit_kwargs</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.check_y"></a>
    <div class="doc doc-contents first">

      <p>Raise Exception if <code>y</code> is not pandas Series or if it has missing values.</p>
<h3 id="skforecast.utils.utils.check_y--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.check_y--parameters" title="Permanent link">&para;</a></h3>
<p>y : Any
    Time series values.</p>
<h3 id="skforecast.utils.utils.check_y--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.check_y--returns" title="Permanent link">&para;</a></h3>
<p>None</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_y</span><span class="p">(</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Raise Exception if `y` is not pandas Series or if it has missing values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : Any</span>
<span class="sd">        Time series values.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`y` must be a pandas Series.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`y` has missing values.&quot;</span><span class="p">)</span>

    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.check_exog"></a>
    <div class="doc doc-contents first">

      <p>Raise Exception if <code>exog</code> is not pandas Series or pandas DataFrame.
If <code>allow_nan = True</code>, issue a warning if <code>exog</code> contains NaN values.</p>
<h3 id="skforecast.utils.utils.check_exog--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.check_exog--parameters" title="Permanent link">&para;</a></h3>
<p>exog : Any
    Exogenous variable/s included as predictor/s.
allow_nan : bool, default <code>True</code>
    If True, allows the presence of NaN values in <code>exog</code>. If False (default),
    issue a warning if <code>exog</code> contains NaN values.</p>
<h3 id="skforecast.utils.utils.check_exog--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.check_exog--returns" title="Permanent link">&para;</a></h3>
<p>None</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_exog</span><span class="p">(</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="n">allow_nan</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Raise Exception if `exog` is not pandas Series or pandas DataFrame.</span>
<span class="sd">    If `allow_nan = True`, issue a warning if `exog` contains NaN values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    exog : Any</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    allow_nan : bool, default `True`</span>
<span class="sd">        If True, allows the presence of NaN values in `exog`. If False (default),</span>
<span class="sd">        issue a warning if `exog` contains NaN values.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`exog` must be a pandas Series or DataFrame.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_nan</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">exog</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`exog` has missing values. Most machine learning models do not allow &quot;</span>
                 <span class="s2">&quot;missing values. Fitting the forecaster may fail.&quot;</span><span class="p">),</span> 
                 <span class="n">MissingValuesExogWarning</span>
            <span class="p">)</span>

    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.get_exog_dtypes"></a>
    <div class="doc doc-contents first">

      <p>Store dtypes of <code>exog</code>.</p>
<h3 id="skforecast.utils.utils.get_exog_dtypes--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.get_exog_dtypes--parameters" title="Permanent link">&para;</a></h3>
<p>exog : pandas DataFrame, pandas Series
    Exogenous variable/s included as predictor/s.</p>
<h3 id="skforecast.utils.utils.get_exog_dtypes--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.get_exog_dtypes--returns" title="Permanent link">&para;</a></h3>
<p>exog_dtypes : dict
    Dictionary with the dtypes in <code>exog</code>.</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_exog_dtypes</span><span class="p">(</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Store dtypes of `exog`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    exog : pandas DataFrame, pandas Series</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    exog_dtypes : dict</span>
<span class="sd">        Dictionary with the dtypes in `exog`.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="n">exog_dtypes</span> <span class="o">=</span> <span class="p">{</span><span class="n">exog</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">exog</span><span class="o">.</span><span class="n">dtypes</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">exog_dtypes</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">exog_dtypes</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.check_exog_dtypes"></a>
    <div class="doc doc-contents first">

      <p>Raise Exception if <code>exog</code> has categorical columns with non integer values.
This is needed when using machine learning regressors that allow categorical
features.
Issue a Warning if <code>exog</code> has columns that are not <code>init</code>, <code>float</code>, or <code>category</code>.</p>
<h3 id="skforecast.utils.utils.check_exog_dtypes--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.check_exog_dtypes--parameters" title="Permanent link">&para;</a></h3>
<p>exog : pandas DataFrame, pandas Series
    Exogenous variable/s included as predictor/s.</p>
<h3 id="skforecast.utils.utils.check_exog_dtypes--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.check_exog_dtypes--returns" title="Permanent link">&para;</a></h3>
<p>None</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_exog_dtypes</span><span class="p">(</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Raise Exception if `exog` has categorical columns with non integer values.</span>
<span class="sd">    This is needed when using machine learning regressors that allow categorical</span>
<span class="sd">    features.</span>
<span class="sd">    Issue a Warning if `exog` has columns that are not `init`, `float`, or `category`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    exog : pandas DataFrame, pandas Series</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">check_exog</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">allow_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">exog</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`exog` may contain only `int`, `float` or `category` dtypes. Most &quot;</span>
                 <span class="s2">&quot;machine learning models do not allow other types of values. &quot;</span>
                 <span class="s2">&quot;Fitting the forecaster may fail.&quot;</span><span class="p">),</span> <span class="n">DataTypeWarning</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">exog</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;category&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">exog</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="s2">&quot;Categorical columns in exog must contain only integer values. &quot;</span>
                     <span class="s2">&quot;See skforecast docs for more info about how to include &quot;</span>
                     <span class="s2">&quot;categorical features https://skforecast.org/&quot;</span>
                     <span class="s2">&quot;latest/user_guides/categorical-features.html&quot;</span><span class="p">)</span>
                <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">exog</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;int8&#39;</span><span class="p">,</span> <span class="s1">&#39;int16&#39;</span><span class="p">,</span> <span class="s1">&#39;int32&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;float16&#39;</span><span class="p">,</span> <span class="s1">&#39;float32&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;uint8&#39;</span><span class="p">,</span> <span class="s1">&#39;uint16&#39;</span><span class="p">,</span> <span class="s1">&#39;uint32&#39;</span><span class="p">,</span> <span class="s1">&#39;uint64&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">]:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`exog` may contain only `int`, `float` or `category` dtypes. Most &quot;</span>
                 <span class="s2">&quot;machine learning models do not allow other types of values. &quot;</span>
                 <span class="s2">&quot;Fitting the forecaster may fail.&quot;</span><span class="p">),</span> <span class="n">DataTypeWarning</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">exog</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;category&#39;</span> <span class="ow">and</span> <span class="n">exog</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;If exog is of type category, it must contain only integer values. &quot;</span>
                 <span class="s2">&quot;See skforecast docs for more info about how to include &quot;</span>
                 <span class="s2">&quot;categorical features https://skforecast.org/&quot;</span>
                 <span class="s2">&quot;latest/user_guides/categorical-features.html&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.check_interval"></a>
    <div class="doc doc-contents first">

      <p>Check provided confidence interval sequence is valid.</p>
<h3 id="skforecast.utils.utils.check_interval--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.check_interval--parameters" title="Permanent link">&para;</a></h3>
<p>interval : list, default <code>None</code>
    Confidence of the prediction interval estimated. Sequence of percentiles
    to compute, which must be between 0 and 100 inclusive. For example, 
    interval of 95% should be as <code>interval = [2.5, 97.5]</code>.
alpha : float, default <code>None</code>
    The confidence intervals used in ForecasterSarimax are (1 - alpha) %.</p>
<h3 id="skforecast.utils.utils.check_interval--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.check_interval--returns" title="Permanent link">&para;</a></h3>
<p>None</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_interval</span><span class="p">(</span>
    <span class="n">interval</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check provided confidence interval sequence is valid.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    interval : list, default `None`</span>
<span class="sd">        Confidence of the prediction interval estimated. Sequence of percentiles</span>
<span class="sd">        to compute, which must be between 0 and 100 inclusive. For example, </span>
<span class="sd">        interval of 95% should be as `interval = [2.5, 97.5]`.</span>
<span class="sd">    alpha : float, default `None`</span>
<span class="sd">        The confidence intervals used in ForecasterSarimax are (1 - alpha) %.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">interval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`interval` must be a `list`. For example, interval of 95% &quot;</span>
                 <span class="s2">&quot;should be as `interval = [2.5, 97.5]`.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`interval` must contain exactly 2 values, respectively the &quot;</span>
                 <span class="s2">&quot;lower and upper interval bounds. For example, interval of 95% &quot;</span>
                 <span class="s2">&quot;should be as `interval = [2.5, 97.5]`.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">100.</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Lower interval bound (</span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">) must be &gt;= 0 and &lt; 100.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">100.</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Upper interval bound (</span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">) must be &gt; 0 and &lt;= 100.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Lower interval bound (</span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">) must be less than the &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;upper interval bound (</span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">).&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">alpha</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`alpha` must be a `float`. For example, interval of 95% &quot;</span>
                 <span class="s2">&quot;should be as `alpha = 0.05`.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`alpha` must have a value between 0 and 1. Got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.check_predict_input"></a>
    <div class="doc doc-contents first">

      <p>Check all inputs of predict method. This is a helper function to validate
that inputs used in predict method match attributes of a forecaster already
trained.</p>
<h3 id="skforecast.utils.utils.check_predict_input--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.check_predict_input--parameters" title="Permanent link">&para;</a></h3>
<p>forecaster_name : str
    Forecaster name. ForecasterAutoreg, ForecasterAutoregCustom, 
    ForecasterAutoregDirect, ForecasterAutoregMultiSeries, 
    ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate.
steps : int, list
    Number of future steps predicted.</p>
<div class="admonition fitted">
<p class="admonition-title">bool</p>
<p>Tag to identify if the regressor has been fitted (trained).</p>
</div>
<p>included_exog : bool
    If the forecaster has been trained using exogenous variable/s.
index_type : type
    Type of index of the input used in training.
index_freq : str
    Frequency of Index of the input used in training.</p>
<div class="admonition window_size">
<p class="admonition-title">int</p>
<p>Size of the window needed to create the predictors. It is equal to 
<code>max_lag</code>.</p>
</div>
<p>last_window : pandas Series, pandas DataFrame, default <code>None</code>
    Values of the series used to create the predictors (lags) need in the 
    first iteration of prediction (t + 1).
last_window_exog : pandas Series, pandas DataFrame, default <code>None</code>
    Values of the exogenous variables aligned with <code>last_window</code> in 
    ForecasterSarimax predictions.
exog : pandas Series, pandas DataFrame, default <code>None</code>
    Exogenous variable/s included as predictor/s.
exog_type : type, default <code>None</code>
    Type of exogenous variable/s used in training.
exog_col_names : list, default <code>None</code>
    Names of columns of <code>exog</code> if <code>exog</code> used in training was a pandas
    DataFrame.
interval : list, default <code>None</code>
    Confidence of the prediction interval estimated. Sequence of percentiles
    to compute, which must be between 0 and 100 inclusive. For example, 
    interval of 95% should be as <code>interval = [2.5, 97.5]</code>.
alpha : float, default <code>None</code>
    The confidence intervals used in ForecasterSarimax are (1 - alpha) %.</p>
<div class="admonition max_steps">
<p class="admonition-title">int, default <code>None</code></p>
<p>Maximum number of steps allowed (<code>ForecasterAutoregDirect</code> and 
<code>ForecasterAutoregMultiVariate</code>).</p>
</div>
<p>levels : str, list, default <code>None</code>
    Time series to be predicted (<code>ForecasterAutoregMultiSeries</code> and
    <code>ForecasterAutoregMultiSeriesCustom</code>).
series_col_names : list, default <code>None</code>
    Names of the columns used during fit (<code>ForecasterAutoregMultiSeries</code>, 
    <code>ForecasterAutoregMultiSeriesCustom</code> and <code>ForecasterAutoregMultiVariate</code>).</p>
<h3 id="skforecast.utils.utils.check_predict_input--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.check_predict_input--returns" title="Permanent link">&para;</a></h3>
<p>None</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_predict_input</span><span class="p">(</span>
    <span class="n">forecaster_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">fitted</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">included_exog</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">index_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span>
    <span class="n">index_freq</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">last_window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">last_window_exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">type</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog_col_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">max_steps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">series_col_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check all inputs of predict method. This is a helper function to validate</span>
<span class="sd">    that inputs used in predict method match attributes of a forecaster already</span>
<span class="sd">    trained.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster_name : str</span>
<span class="sd">        Forecaster name. ForecasterAutoreg, ForecasterAutoregCustom, </span>
<span class="sd">        ForecasterAutoregDirect, ForecasterAutoregMultiSeries, </span>
<span class="sd">        ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate.</span>
<span class="sd">    steps : int, list</span>
<span class="sd">        Number of future steps predicted.</span>
<span class="sd">    fitted: bool</span>
<span class="sd">        Tag to identify if the regressor has been fitted (trained).</span>
<span class="sd">    included_exog : bool</span>
<span class="sd">        If the forecaster has been trained using exogenous variable/s.</span>
<span class="sd">    index_type : type</span>
<span class="sd">        Type of index of the input used in training.</span>
<span class="sd">    index_freq : str</span>
<span class="sd">        Frequency of Index of the input used in training.</span>
<span class="sd">    window_size: int</span>
<span class="sd">        Size of the window needed to create the predictors. It is equal to </span>
<span class="sd">        `max_lag`.</span>
<span class="sd">    last_window : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Values of the series used to create the predictors (lags) need in the </span>
<span class="sd">        first iteration of prediction (t + 1).</span>
<span class="sd">    last_window_exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Values of the exogenous variables aligned with `last_window` in </span>
<span class="sd">        ForecasterSarimax predictions.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    exog_type : type, default `None`</span>
<span class="sd">        Type of exogenous variable/s used in training.</span>
<span class="sd">    exog_col_names : list, default `None`</span>
<span class="sd">        Names of columns of `exog` if `exog` used in training was a pandas</span>
<span class="sd">        DataFrame.</span>
<span class="sd">    interval : list, default `None`</span>
<span class="sd">        Confidence of the prediction interval estimated. Sequence of percentiles</span>
<span class="sd">        to compute, which must be between 0 and 100 inclusive. For example, </span>
<span class="sd">        interval of 95% should be as `interval = [2.5, 97.5]`.</span>
<span class="sd">    alpha : float, default `None`</span>
<span class="sd">        The confidence intervals used in ForecasterSarimax are (1 - alpha) %.</span>
<span class="sd">    max_steps: int, default `None`</span>
<span class="sd">        Maximum number of steps allowed (`ForecasterAutoregDirect` and </span>
<span class="sd">        `ForecasterAutoregMultiVariate`).</span>
<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        Time series to be predicted (`ForecasterAutoregMultiSeries` and</span>
<span class="sd">        `ForecasterAutoregMultiSeriesCustom`).</span>
<span class="sd">    series_col_names : list, default `None`</span>
<span class="sd">        Names of the columns used during fit (`ForecasterAutoregMultiSeries`, </span>
<span class="sd">        `ForecasterAutoregMultiSeriesCustom` and `ForecasterAutoregMultiVariate`).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">fitted</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">NotFittedError</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;This Forecaster instance is not fitted yet. Call `fit` with &quot;</span>
             <span class="s2">&quot;appropriate arguments before using predict.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">and</span> <span class="n">steps</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`steps` must be an integer greater than or equal to 1. Got </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">min</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
           <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The minimum value of `steps` must be equal to or greater than 1. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">max_steps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_steps</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The maximum value of `steps` must be less than or equal to &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;the value of steps defined when initializing the forecaster. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span><span class="si">}</span><span class="s2">, but the maximum is </span><span class="si">{</span><span class="n">max_steps</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">interval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> 
                           <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">levels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`levels` must be a `list` of column names, a `str` of a &quot;</span>
                 <span class="s2">&quot;column name or `None`.&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">series_col_names</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`levels` must be in `series_col_names` : </span><span class="si">{</span><span class="n">series_col_names</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">included_exog</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;Forecaster trained with exogenous variable/s. &quot;</span>
             <span class="s2">&quot;Same variable/s must be provided when predicting.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">included_exog</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;Forecaster trained without exogenous variable/s. &quot;</span>
             <span class="s2">&quot;`exog` must be `None` when predicting.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="c1"># Checks last_window</span>
    <span class="c1"># Check last_window type (pd.Series or pd.DataFrame according to forecaster)</span>
    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> 
                           <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;ForecasterAutoregMultiVariate&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`last_window` must be a pandas DataFrame. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">last_window</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> 
                               <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">]</span> <span class="ow">and</span> \
            <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">last_window</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`last_window` must contain a column(s) named as the level(s) &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;to be predicted.</span><span class="se">\n</span><span class="s2">&quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;    `levels` : </span><span class="si">{</span><span class="n">levels</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;    `last_window` columns : </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">last_window</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s1">&#39;ForecasterAutoregMultiVariate&#39;</span> <span class="ow">and</span> \
            <span class="p">(</span><span class="n">series_col_names</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">(</span><span class="n">last_window</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`last_window` columns must be the same as `series` column names.</span><span class="se">\n</span><span class="s2">&quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;    `last_window` columns : </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">last_window</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;    `series` columns      : </span><span class="si">{</span><span class="n">series_col_names</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>    
    <span class="k">else</span><span class="p">:</span>    
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`last_window` must be a pandas Series. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">last_window</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

    <span class="c1"># Check last_window len, nulls and index (type and freq)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">last_window</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">window_size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`last_window` must have as many values as needed to &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;generate the predictors. For this forecaster it is </span><span class="si">{</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">last_window</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;`last_window` has missing values.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">last_window_index</span> <span class="o">=</span> <span class="n">preprocess_last_window</span><span class="p">(</span>
                               <span class="n">last_window</span>  <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">return_values</span> <span class="o">=</span> <span class="kc">False</span>
                           <span class="p">)</span> 
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window_index</span><span class="p">,</span> <span class="n">index_type</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected index of type </span><span class="si">{</span><span class="n">index_type</span><span class="si">}</span><span class="s2"> for `last_window`. &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">last_window_index</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window_index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">last_window_index</span><span class="o">.</span><span class="n">freqstr</span> <span class="o">==</span> <span class="n">index_freq</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected frequency of type </span><span class="si">{</span><span class="n">index_freq</span><span class="si">}</span><span class="s2"> for `last_window`. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">last_window_index</span><span class="o">.</span><span class="n">freqstr</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="c1"># Checks exog</span>
    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Check type, nulls and expected type</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`exog` must be a pandas Series or DataFrame.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">exog</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`exog` has missing values. Most of machine learning models do &quot;</span>
                 <span class="s2">&quot;not allow missing values. `predict` method may fail.&quot;</span><span class="p">),</span> 
                 <span class="n">MissingValuesExogWarning</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">exog_type</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Expected type for `exog`: </span><span class="si">{</span><span class="n">exog_type</span><span class="si">}</span><span class="s2">. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>    
            <span class="p">)</span>

        <span class="c1"># Check exog has many values as distance to max step predicted</span>
        <span class="n">last_step</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">steps</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">last_step</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`exog` must have at least as many values as the distance to &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;the maximum step predicted, </span><span class="si">{</span><span class="n">last_step</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># Check all columns are in the pandas DataFrame</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">col_missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">exog_col_names</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">exog</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">col_missing</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing columns in `exog`. Expected </span><span class="si">{</span><span class="n">exog_col_names</span><span class="si">}</span><span class="s2">. &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">exog</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span> 
                <span class="p">)</span>

        <span class="c1"># Check index dtype and freq</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">exog_index</span> <span class="o">=</span> <span class="n">preprocess_exog</span><span class="p">(</span>
                            <span class="n">exog</span>          <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
                            <span class="n">return_values</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog_index</span><span class="p">,</span> <span class="n">index_type</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected index of type </span><span class="si">{</span><span class="n">index_type</span><span class="si">}</span><span class="s2"> for `exog`. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog_index</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>   
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog_index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">exog_index</span><span class="o">.</span><span class="n">freqstr</span> <span class="o">==</span> <span class="n">index_freq</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected frequency of type </span><span class="si">{</span><span class="n">index_freq</span><span class="si">}</span><span class="s2"> for `exog`. &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">exog_index</span><span class="o">.</span><span class="n">freqstr</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="p">)</span>

        <span class="c1"># Check exog starts one step ahead of last_window end.</span>
        <span class="n">expected_index</span> <span class="o">=</span> <span class="n">expand_index</span><span class="p">(</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">expected_index</span> <span class="o">!=</span> <span class="n">exog</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;To make predictions `exog` must start one step ahead of `last_window`.</span><span class="se">\n</span><span class="s2">&quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;    `last_window` ends at : </span><span class="si">{</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;    `exog` starts at      : </span><span class="si">{</span><span class="n">exog</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;     Expected index       : </span><span class="si">{</span><span class="n">expected_index</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="c1"># Checks ForecasterSarimax</span>
    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s1">&#39;ForecasterSarimax&#39;</span><span class="p">:</span>
        <span class="c1"># Check last_window_exog type, len, nulls and index (type and freq)</span>
        <span class="k">if</span> <span class="n">last_window_exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">included_exog</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="p">(</span><span class="s2">&quot;Forecaster trained without exogenous variable/s. &quot;</span>
                     <span class="s2">&quot;`last_window_exog` must be `None` when predicting.&quot;</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window_exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`last_window_exog` must be a pandas Series or a &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;pandas DataFrame. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">last_window_exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">last_window_exog</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">window_size</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`last_window_exog` must have as many values as needed to &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;generate the predictors. For this forecaster it is </span><span class="si">{</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">last_window_exog</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`last_window_exog` has missing values. Most of machine learning &quot;</span>
                 <span class="s2">&quot;models do not allow missing values. `predict` method may fail.&quot;</span><span class="p">),</span>
                <span class="n">MissingValuesExogWarning</span>
            <span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">last_window_exog_index</span> <span class="o">=</span> <span class="n">preprocess_last_window</span><span class="p">(</span>
                                            <span class="n">last_window</span>   <span class="o">=</span> <span class="n">last_window_exog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">0</span><span class="p">],</span>
                                            <span class="n">return_values</span> <span class="o">=</span> <span class="kc">False</span>
                                        <span class="p">)</span> 
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window_exog_index</span><span class="p">,</span> <span class="n">index_type</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected index of type </span><span class="si">{</span><span class="n">index_type</span><span class="si">}</span><span class="s2"> for `last_window_exog`. &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">last_window_exog_index</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window_exog_index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">last_window_exog_index</span><span class="o">.</span><span class="n">freqstr</span> <span class="o">==</span> <span class="n">index_freq</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected frequency of type </span><span class="si">{</span><span class="n">index_freq</span><span class="si">}</span><span class="s2"> for &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;`last_window_exog`. Got </span><span class="si">{</span><span class="n">last_window_exog_index</span><span class="o">.</span><span class="n">freqstr</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                    <span class="p">)</span>

            <span class="c1"># Check all columns are in the pd.DataFrame, last_window_exog</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window_exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
                <span class="n">col_missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">exog_col_names</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">last_window_exog</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">col_missing</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing columns in `exog`. Expected </span><span class="si">{</span><span class="n">exog_col_names</span><span class="si">}</span><span class="s2">. &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">last_window_exog</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span> 
                    <span class="p">)</span>

    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.preprocess_y"></a>
    <div class="doc doc-contents first">

      <p>Return values and index of series separately. Index is overwritten 
according to the next rules:</p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="n n-Quoted">`DatetimeIndex`</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">frequency</span><span class="p">,</span><span class="w"> </span><span class="n">nothing</span><span class="w"> </span><span class="k">is</span><span class="w"> </span>
<span class="k">changed</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="n n-Quoted">`RangeIndex`</span><span class="p">,</span><span class="w"> </span><span class="n">nothing</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">changed</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="n n-Quoted">`DatetimeIndex`</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">frequency</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span>
<span class="n n-Quoted">`RangeIndex`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">created</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="n n-Quoted">`DatetimeIndex`</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n n-Quoted">`RangeIndex`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">created</span><span class="p">.</span>
</code></pre></div>

<h3 id="skforecast.utils.utils.preprocess_y--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.preprocess_y--parameters" title="Permanent link">&para;</a></h3>
<p>y : pandas Series
    Time series.
return_values : bool, default <code>True</code>
    If <code>True</code> return the values of <code>y</code> as numpy ndarray. This option is 
    intended to avoid copying data when it is not necessary.</p>
<h3 id="skforecast.utils.utils.preprocess_y--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.preprocess_y--returns" title="Permanent link">&para;</a></h3>
<p>y_values : None, numpy ndarray
    Numpy array with values of <code>y</code>.
y_index : pandas Index
    Index of <code>y</code> modified according to the rules.</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_y</span><span class="p">(</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">return_values</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return values and index of series separately. Index is overwritten </span>
<span class="sd">    according to the next rules:</span>

<span class="sd">        - If index is of type `DatetimeIndex` and has frequency, nothing is </span>
<span class="sd">        changed.</span>
<span class="sd">        - If index is of type `RangeIndex`, nothing is changed.</span>
<span class="sd">        - If index is of type `DatetimeIndex` but has no frequency, a </span>
<span class="sd">        `RangeIndex` is created.</span>
<span class="sd">        - If index is not of type `DatetimeIndex`, a `RangeIndex` is created.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Time series.</span>
<span class="sd">    return_values : bool, default `True`</span>
<span class="sd">        If `True` return the values of `y` as numpy ndarray. This option is </span>
<span class="sd">        intended to avoid copying data when it is not necessary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    y_values : None, numpy ndarray</span>
<span class="sd">        Numpy array with values of `y`.</span>
<span class="sd">    y_index : pandas Index</span>
<span class="sd">        Index of `y` modified according to the rules.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span> <span class="ow">and</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y_index</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">):</span>
        <span class="n">y_index</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span> <span class="ow">and</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;`y` has DatetimeIndex index but no frequency. &quot;</span>
             <span class="s2">&quot;Index is overwritten with a RangeIndex of step 1.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">y_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
                      <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                      <span class="n">stop</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
                      <span class="n">step</span>  <span class="o">=</span> <span class="mi">1</span>
                  <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;`y` has no DatetimeIndex nor RangeIndex index. &quot;</span>
             <span class="s2">&quot;Index is overwritten with a RangeIndex.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">y_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
                      <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                      <span class="n">stop</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
                      <span class="n">step</span>  <span class="o">=</span> <span class="mi">1</span>
                  <span class="p">)</span>

    <span class="n">y_values</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="k">if</span> <span class="n">return_values</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">y_values</span><span class="p">,</span> <span class="n">y_index</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.preprocess_last_window"></a>
    <div class="doc doc-contents first">

      <p>Return values and index of series separately. Index is overwritten 
according to the next rules:</p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="n n-Quoted">`DatetimeIndex`</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">frequency</span><span class="p">,</span><span class="w"> </span><span class="n">nothing</span><span class="w"> </span><span class="k">is</span><span class="w"> </span>
<span class="k">changed</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="n n-Quoted">`RangeIndex`</span><span class="p">,</span><span class="w"> </span><span class="n">nothing</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">changed</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="n n-Quoted">`DatetimeIndex`</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">frequency</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span>
<span class="n n-Quoted">`RangeIndex`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">created</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="n n-Quoted">`DatetimeIndex`</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n n-Quoted">`RangeIndex`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">created</span><span class="p">.</span>
</code></pre></div>

<h3 id="skforecast.utils.utils.preprocess_last_window--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.preprocess_last_window--parameters" title="Permanent link">&para;</a></h3>
<p>last_window : pandas Series, pandas DataFrame
    Time series values.
return_values : bool, default <code>True</code>
    If <code>True</code> return the values of <code>last_window</code> as numpy ndarray. This option 
    is intended to avoid copying data when it is not necessary.</p>
<h3 id="skforecast.utils.utils.preprocess_last_window--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.preprocess_last_window--returns" title="Permanent link">&para;</a></h3>
<p>last_window_values : numpy ndarray
    Numpy array with values of <code>last_window</code>.
last_window_index : pandas Index
    Index of <code>last_window</code> modified according to the rules.</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_last_window</span><span class="p">(</span>
    <span class="n">last_window</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">return_values</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
 <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return values and index of series separately. Index is overwritten </span>
<span class="sd">    according to the next rules:</span>

<span class="sd">        - If index is of type `DatetimeIndex` and has frequency, nothing is </span>
<span class="sd">        changed.</span>
<span class="sd">        - If index is of type `RangeIndex`, nothing is changed.</span>
<span class="sd">        - If index is of type `DatetimeIndex` but has no frequency, a </span>
<span class="sd">        `RangeIndex` is created.</span>
<span class="sd">        - If index is not of type `DatetimeIndex`, a `RangeIndex` is created.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    last_window : pandas Series, pandas DataFrame</span>
<span class="sd">        Time series values.</span>
<span class="sd">    return_values : bool, default `True`</span>
<span class="sd">        If `True` return the values of `last_window` as numpy ndarray. This option </span>
<span class="sd">        is intended to avoid copying data when it is not necessary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    last_window_values : numpy ndarray</span>
<span class="sd">        Numpy array with values of `last_window`.</span>
<span class="sd">    last_window_index : pandas Index</span>
<span class="sd">        Index of `last_window` modified according to the rules.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span> <span class="ow">and</span> <span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">last_window_index</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">index</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">):</span>
        <span class="n">last_window_index</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">index</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span> <span class="ow">and</span> <span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;`last_window` has DatetimeIndex index but no frequency. &quot;</span>
             <span class="s2">&quot;Index is overwritten with a RangeIndex of step 1.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">last_window_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
                                <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                                <span class="n">stop</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">last_window</span><span class="p">),</span>
                                <span class="n">step</span>  <span class="o">=</span> <span class="mi">1</span>
                            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;`last_window` has no DatetimeIndex nor RangeIndex index. &quot;</span>
             <span class="s2">&quot;Index is overwritten with a RangeIndex.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">last_window_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
                                <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                                <span class="n">stop</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">last_window</span><span class="p">),</span>
                                <span class="n">step</span>  <span class="o">=</span> <span class="mi">1</span>
                            <span class="p">)</span>

    <span class="n">last_window_values</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="k">if</span> <span class="n">return_values</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">last_window_values</span><span class="p">,</span> <span class="n">last_window_index</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.preprocess_exog"></a>
    <div class="doc doc-contents first">

      <p>Return values and index of series or data frame separately. Index is
overwritten  according to the next rules:</p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="n n-Quoted">`DatetimeIndex`</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">frequency</span><span class="p">,</span><span class="w"> </span><span class="n">nothing</span><span class="w"> </span><span class="k">is</span><span class="w"> </span>
<span class="k">changed</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="n n-Quoted">`RangeIndex`</span><span class="p">,</span><span class="w"> </span><span class="n">nothing</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">changed</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="n n-Quoted">`DatetimeIndex`</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">frequency</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span>
<span class="n n-Quoted">`RangeIndex`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">created</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="n n-Quoted">`DatetimeIndex`</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n n-Quoted">`RangeIndex`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">created</span><span class="p">.</span>
</code></pre></div>

<h3 id="skforecast.utils.utils.preprocess_exog--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.preprocess_exog--parameters" title="Permanent link">&para;</a></h3>
<p>exog : pandas Series, pandas DataFrame
    Exogenous variables.
return_values : bool, default <code>True</code>
    If <code>True</code> return the values of <code>exog</code> as numpy ndarray. This option is 
    intended to avoid copying data when it is not necessary.</p>
<h3 id="skforecast.utils.utils.preprocess_exog--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.preprocess_exog--returns" title="Permanent link">&para;</a></h3>
<p>exog_values : None, numpy ndarray
    Numpy array with values of <code>exog</code>.
exog_index : pandas Index
    Index of <code>exog</code> modified according to the rules.</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_exog</span><span class="p">(</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">return_values</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return values and index of series or data frame separately. Index is</span>
<span class="sd">    overwritten  according to the next rules:</span>

<span class="sd">        - If index is of type `DatetimeIndex` and has frequency, nothing is </span>
<span class="sd">        changed.</span>
<span class="sd">        - If index is of type `RangeIndex`, nothing is changed.</span>
<span class="sd">        - If index is of type `DatetimeIndex` but has no frequency, a </span>
<span class="sd">        `RangeIndex` is created.</span>
<span class="sd">        - If index is not of type `DatetimeIndex`, a `RangeIndex` is created.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    exog : pandas Series, pandas DataFrame</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    return_values : bool, default `True`</span>
<span class="sd">        If `True` return the values of `exog` as numpy ndarray. This option is </span>
<span class="sd">        intended to avoid copying data when it is not necessary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    exog_values : None, numpy ndarray</span>
<span class="sd">        Numpy array with values of `exog`.</span>
<span class="sd">    exog_index : pandas Index</span>
<span class="sd">        Index of `exog` modified according to the rules.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span> <span class="ow">and</span> <span class="n">exog</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">exog_index</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">index</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">):</span>
        <span class="n">exog_index</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">index</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span> <span class="ow">and</span> <span class="n">exog</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;`exog` has DatetimeIndex index but no frequency. &quot;</span>
             <span class="s2">&quot;Index is overwritten with a RangeIndex of step 1.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">exog_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
                         <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                         <span class="n">stop</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">),</span>
                         <span class="n">step</span>  <span class="o">=</span> <span class="mi">1</span>
                     <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;`exog` has no DatetimeIndex nor RangeIndex index. &quot;</span>
             <span class="s2">&quot;Index is overwritten with a RangeIndex.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">exog_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
                         <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                         <span class="n">stop</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">),</span>
                         <span class="n">step</span>  <span class="o">=</span> <span class="mi">1</span>
                     <span class="p">)</span>

    <span class="n">exog_values</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="k">if</span> <span class="n">return_values</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">exog_values</span><span class="p">,</span> <span class="n">exog_index</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.cast_exog_dtypes"></a>
    <div class="doc doc-contents first">

      <p>Cast <code>exog</code> to a specified types. This is done because, for a forecaster to 
accept a categorical exog, it must contain only integer values. Due to the 
internal modifications of numpy, the values may be casted to <code>float</code>, so 
they have to be re-converted to <code>int</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n n-Quoted">`exog`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pandas</span><span class="w"> </span><span class="n">Series</span><span class="p">,</span><span class="w"> </span><span class="n n-Quoted">`exog_dtypes`</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dict</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span>
<span class="n">single</span><span class="w"> </span><span class="k">value</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n n-Quoted">`exog_dtypes`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n n-Quoted">`category`</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">current</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n n-Quoted">`exog`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n n-Quoted">`float`</span><span class="p">,</span><span class="w"> </span>
<span class="k">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">cast</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n n-Quoted">`int`</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n n-Quoted">`category`</span><span class="p">.</span>
</code></pre></div>

<h3 id="skforecast.utils.utils.cast_exog_dtypes--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.cast_exog_dtypes--parameters" title="Permanent link">&para;</a></h3>
<p>exog : pandas Series, pandas DataFrame
    Exogenous variables.</p>
<div class="admonition exog_dtypes">
<p class="admonition-title">dict</p>
<p>Dictionary with name and type of the series or data frame columns.</p>
</div>
<h3 id="skforecast.utils.utils.cast_exog_dtypes--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.cast_exog_dtypes--returns" title="Permanent link">&para;</a></h3>
<p>exog : pandas Series, pandas DataFrame
    Exogenous variables casted to the indicated dtypes.</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">cast_exog_dtypes</span><span class="p">(</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">exog_dtypes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span> <span class="c1"># pragma: no cover</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cast `exog` to a specified types. This is done because, for a forecaster to </span>
<span class="sd">    accept a categorical exog, it must contain only integer values. Due to the </span>
<span class="sd">    internal modifications of numpy, the values may be casted to `float`, so </span>
<span class="sd">    they have to be re-converted to `int`.</span>

<span class="sd">        - If `exog` is a pandas Series, `exog_dtypes` must be a dict with a </span>
<span class="sd">        single value.</span>
<span class="sd">        - If `exog_dtypes` is `category` but the current type of `exog` is `float`, </span>
<span class="sd">        then the type is cast to `int` and then to `category`. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    exog : pandas Series, pandas DataFrame</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    exog_dtypes: dict</span>
<span class="sd">        Dictionary with name and type of the series or data frame columns.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    exog : pandas Series, pandas DataFrame</span>
<span class="sd">        Exogenous variables casted to the indicated dtypes.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Remove keys from exog_dtypes not in exog.columns</span>
    <span class="n">exog_dtypes</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">exog_dtypes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">exog</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="n">exog</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">(</span><span class="n">exog_dtypes</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">exog</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">exog_dtypes</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">initial_dtype</span> <span class="ow">in</span> <span class="n">exog_dtypes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">exog</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">!=</span> <span class="n">initial_dtype</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">initial_dtype</span> <span class="o">==</span> <span class="s2">&quot;category&quot;</span> <span class="ow">and</span> <span class="n">exog</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="o">==</span><span class="nb">float</span><span class="p">:</span>
                    <span class="n">exog</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">exog</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">exog</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">exog</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">initial_dtype</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">exog</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.exog_to_direct"></a>
    <div class="doc doc-contents first">

      <p>Transforms <code>exog</code> to a pandas DataFrame with the shape needed for Direct
forecasting.</p>
<h3 id="skforecast.utils.utils.exog_to_direct--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.exog_to_direct--parameters" title="Permanent link">&para;</a></h3>
<p>exog : pandas Series, pandas DataFrame
    Exogenous variables.
steps : int.
    Number of steps that will be predicted using exog.</p>
<h3 id="skforecast.utils.utils.exog_to_direct--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.exog_to_direct--returns" title="Permanent link">&para;</a></h3>
<p>exog_transformed : pandas DataFrame
    Exogenous variables transformed.</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">exog_to_direct</span><span class="p">(</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span><span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms `exog` to a pandas DataFrame with the shape needed for Direct</span>
<span class="sd">    forecasting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    exog : pandas Series, pandas DataFrame</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    steps : int.</span>
<span class="sd">        Number of steps that will be predicted using exog.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    exog_transformed : pandas DataFrame</span>
<span class="sd">        Exogenous variables transformed.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`exog` must be a pandas Series or DataFrame. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="n">exog</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>

    <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
    <span class="n">exog_idx</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">index</span>
    <span class="n">exog_transformed</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
        <span class="n">exog_column_transformed</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">n_rows</span> <span class="o">-</span> <span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="p">]</span>
        <span class="n">exog_column_transformed</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exog_column_transformed</span><span class="p">))</span>
        <span class="n">exog_column_transformed</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_step_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> 
                                           <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">exog_column_transformed</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        <span class="n">exog_transformed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exog_column_transformed</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog_transformed</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">exog_transformed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">exog_transformed</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">exog_transformed</span> <span class="o">=</span> <span class="n">exog_column_transformed</span>

    <span class="n">exog_transformed</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">exog_idx</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">exog_transformed</span><span class="p">):]</span>

    <span class="k">return</span> <span class="n">exog_transformed</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.exog_to_direct_numpy"></a>
    <div class="doc doc-contents first">

      <p>Transforms <code>exog</code> to numpy ndarray with the shape needed for Direct
forecasting.</p>
<h3 id="skforecast.utils.utils.exog_to_direct_numpy--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.exog_to_direct_numpy--parameters" title="Permanent link">&para;</a></h3>
<p>exog : numpy ndarray, shape(samples,)
    Exogenous variables.
steps : int.
    Number of steps that will be predicted using exog.</p>
<h3 id="skforecast.utils.utils.exog_to_direct_numpy--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.exog_to_direct_numpy--returns" title="Permanent link">&para;</a></h3>
<p>exog_transformed : numpy ndarray
    Exogenous variables transformed.</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">exog_to_direct_numpy</span><span class="p">(</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span><span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms `exog` to numpy ndarray with the shape needed for Direct</span>
<span class="sd">    forecasting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    exog : numpy ndarray, shape(samples,)</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    steps : int.</span>
<span class="sd">        Number of steps that will be predicted using exog.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    exog_transformed : numpy ndarray</span>
<span class="sd">        Exogenous variables transformed.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`exog` must be a numpy ndarray. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">exog</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">exog</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
    <span class="n">exog_transformed</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
        <span class="n">exog_column_transformed</span> <span class="o">=</span> <span class="n">exog</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">n_rows</span> <span class="o">-</span> <span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">)]</span>
        <span class="n">exog_transformed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exog_column_transformed</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog_transformed</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">exog_transformed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">exog_transformed</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">exog_transformed</span> <span class="o">=</span> <span class="n">exog_column_transformed</span>

    <span class="k">return</span> <span class="n">exog_transformed</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.expand_index"></a>
    <div class="doc doc-contents first">

      <p>Create a new index of length <code>steps</code> starting at the end of the index.</p>
<h3 id="skforecast.utils.utils.expand_index--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.expand_index--parameters" title="Permanent link">&para;</a></h3>
<p>index : pandas Index, None
    Original index.
steps : int
    Number of steps to expand.</p>
<h3 id="skforecast.utils.utils.expand_index--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.expand_index--returns" title="Permanent link">&para;</a></h3>
<p>new_index : pandas Index
    New index.</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">expand_index</span><span class="p">(</span>
    <span class="n">index</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> 
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new index of length `steps` starting at the end of the index.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    index : pandas Index, None</span>
<span class="sd">        Original index.</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of steps to expand.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    new_index : pandas Index</span>
<span class="sd">        New index.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
            <span class="n">new_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
                            <span class="n">start</span>   <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">index</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span>
                            <span class="n">periods</span> <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                            <span class="n">freq</span>    <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">freq</span>
                        <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">):</span>
            <span class="n">new_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
                            <span class="n">start</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                            <span class="n">stop</span>  <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">steps</span>
                        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">new_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
                        <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="n">stop</span>  <span class="o">=</span> <span class="n">steps</span>
                    <span class="p">)</span>

    <span class="k">return</span> <span class="n">new_index</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.transform_series"></a>
    <div class="doc doc-contents first">

      <p>Transform raw values of pandas Series with a scikit-learn alike transformer
(preprocessor). The transformer used must have the following methods: fit, 
transform, fit_transform and inverse_transform. ColumnTransformers are not 
allowed since they do not have inverse_transform method.</p>
<h3 id="skforecast.utils.utils.transform_series--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.transform_series--parameters" title="Permanent link">&para;</a></h3>
<p>series : pandas Series
    Series to be transformed.
transformer : scikit-learn alike transformer (preprocessor).
    scikit-learn alike transformer (preprocessor) with methods: fit, transform,
    fit_transform and inverse_transform. ColumnTransformers are not allowed 
    since they do not have inverse_transform method.
fit : bool, default <code>False</code>
    Train the transformer before applying it.
inverse_transform : bool, default <code>False</code>
    Transform back the data to the original representation.</p>
<h3 id="skforecast.utils.utils.transform_series--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.transform_series--returns" title="Permanent link">&para;</a></h3>
<p>series_transformed : pandas Series, pandas DataFrame
    Transformed Series. Depending on the transformer used, the output may 
    be a Series or a DataFrame.</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">transform_series</span><span class="p">(</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">transformer</span><span class="p">,</span>
    <span class="n">fit</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">inverse_transform</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;      </span>
<span class="sd">    Transform raw values of pandas Series with a scikit-learn alike transformer</span>
<span class="sd">    (preprocessor). The transformer used must have the following methods: fit, </span>
<span class="sd">    transform, fit_transform and inverse_transform. ColumnTransformers are not </span>
<span class="sd">    allowed since they do not have inverse_transform method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    series : pandas Series</span>
<span class="sd">        Series to be transformed.</span>
<span class="sd">    transformer : scikit-learn alike transformer (preprocessor).</span>
<span class="sd">        scikit-learn alike transformer (preprocessor) with methods: fit, transform,</span>
<span class="sd">        fit_transform and inverse_transform. ColumnTransformers are not allowed </span>
<span class="sd">        since they do not have inverse_transform method.</span>
<span class="sd">    fit : bool, default `False`</span>
<span class="sd">        Train the transformer before applying it.</span>
<span class="sd">    inverse_transform : bool, default `False`</span>
<span class="sd">        Transform back the data to the original representation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    series_transformed : pandas Series, pandas DataFrame</span>
<span class="sd">        Transformed Series. Depending on the transformer used, the output may </span>
<span class="sd">        be a Series or a DataFrame.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`series` argument must be a pandas Series. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">series</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">transformer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">series</span>

    <span class="k">if</span> <span class="n">series</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">series</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;no_name&#39;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">fit</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">transformer</span><span class="p">,</span> <span class="s1">&#39;fit&#39;</span><span class="p">):</span>
        <span class="n">transformer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># If argument feature_names_in_ exits, is overwritten to allow using the </span>
    <span class="c1"># transformer on other series than those that were passed during fit.</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">transformer</span><span class="p">,</span> <span class="s1">&#39;feature_names_in_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">transformer</span><span class="o">.</span><span class="n">feature_names_in_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">transformer</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">transformer</span><span class="p">)</span>
        <span class="n">transformer</span><span class="o">.</span><span class="n">feature_names_in_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">inverse_transform</span><span class="p">:</span>
        <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>   

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">values_transformed</span><span class="p">,</span> <span class="s1">&#39;toarray&#39;</span><span class="p">):</span>
        <span class="c1"># If the returned values are in sparse matrix format, it is converted to dense array.</span>
        <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">values_transformed</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_transformed</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">values_transformed</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">series_transformed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
                                 <span class="n">data</span>  <span class="o">=</span> <span class="n">values_transformed</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                                 <span class="n">index</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                                 <span class="n">name</span>  <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                             <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_transformed</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="ow">and</span> <span class="n">values_transformed</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">series_transformed</span> <span class="o">=</span> <span class="n">values_transformed</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">series_transformed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                                 <span class="n">data</span>    <span class="o">=</span> <span class="n">values_transformed</span><span class="p">,</span>
                                 <span class="n">index</span>   <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                                 <span class="n">columns</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>
                             <span class="p">)</span>

    <span class="k">return</span> <span class="n">series_transformed</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.transform_dataframe"></a>
    <div class="doc doc-contents first">

      <p>Transform raw values of pandas DataFrame with a scikit-learn alike
transformer, preprocessor or ColumnTransformer. <code>inverse_transform</code> is not 
available when using ColumnTransformers.</p>
<h3 id="skforecast.utils.utils.transform_dataframe--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.transform_dataframe--parameters" title="Permanent link">&para;</a></h3>
<p>df : pandas DataFrame
    DataFrame to be transformed.
transformer : scikit-learn alike transformer, preprocessor or ColumnTransformer.
    scikit-learn alike transformer, preprocessor or ColumnTransformer.
fit : bool, default <code>False</code>
    Train the transformer before applying it.
inverse_transform : bool, default <code>False</code>
    Transform back the data to the original representation. This is not available
    when using transformers of class scikit-learn ColumnTransformers.</p>
<h3 id="skforecast.utils.utils.transform_dataframe--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.transform_dataframe--returns" title="Permanent link">&para;</a></h3>
<p>df_transformed : pandas DataFrame
    Transformed DataFrame.</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">transform_dataframe</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">transformer</span><span class="p">,</span>
    <span class="n">fit</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">inverse_transform</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;      </span>
<span class="sd">    Transform raw values of pandas DataFrame with a scikit-learn alike</span>
<span class="sd">    transformer, preprocessor or ColumnTransformer. `inverse_transform` is not </span>
<span class="sd">    available when using ColumnTransformers.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pandas DataFrame</span>
<span class="sd">        DataFrame to be transformed.</span>
<span class="sd">    transformer : scikit-learn alike transformer, preprocessor or ColumnTransformer.</span>
<span class="sd">        scikit-learn alike transformer, preprocessor or ColumnTransformer.</span>
<span class="sd">    fit : bool, default `False`</span>
<span class="sd">        Train the transformer before applying it.</span>
<span class="sd">    inverse_transform : bool, default `False`</span>
<span class="sd">        Transform back the data to the original representation. This is not available</span>
<span class="sd">        when using transformers of class scikit-learn ColumnTransformers.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df_transformed : pandas DataFrame</span>
<span class="sd">        Transformed DataFrame.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`df` argument must be a pandas DataFrame. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">transformer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="k">if</span> <span class="n">inverse_transform</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transformer</span><span class="p">,</span> <span class="n">ColumnTransformer</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">&quot;`inverse_transform` is not available when using ColumnTransformers.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">inverse_transform</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fit</span><span class="p">:</span>
            <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">values_transformed</span><span class="p">,</span> <span class="s1">&#39;toarray&#39;</span><span class="p">):</span>
        <span class="c1"># If the returned values are in sparse matrix format, it is converted to dense</span>
        <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">values_transformed</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">transformer</span><span class="p">,</span> <span class="s1">&#39;get_feature_names_out&#39;</span><span class="p">):</span>
        <span class="n">feature_names_out</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">transformer</span><span class="p">,</span> <span class="s1">&#39;categories_&#39;</span><span class="p">):</span>   
        <span class="n">feature_names_out</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">categories_</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">feature_names_out</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>

    <span class="n">df_transformed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                         <span class="n">data</span>    <span class="o">=</span> <span class="n">values_transformed</span><span class="p">,</span>
                         <span class="n">index</span>   <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                         <span class="n">columns</span> <span class="o">=</span> <span class="n">feature_names_out</span>
                     <span class="p">)</span>

    <span class="k">return</span> <span class="n">df_transformed</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.check_optional_dependency"></a>
    <div class="doc doc-contents first">

      <p>Check if an optional dependency is installed, if not raise an ImportError<br />
with installation instructions.</p>
<h3 id="skforecast.utils.utils.check_optional_dependency--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.check_optional_dependency--parameters" title="Permanent link">&para;</a></h3>
<p>package_name : str
    Name of the package to check.</p>
<h3 id="skforecast.utils.utils.check_optional_dependency--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.check_optional_dependency--returns" title="Permanent link">&para;</a></h3>
<p>None</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_optional_dependency</span><span class="p">(</span>
    <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if an optional dependency is installed, if not raise an ImportError  </span>
<span class="sd">    with installation instructions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    package_name : str</span>
<span class="sd">        Name of the package to check.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">find_spec</span><span class="p">(</span><span class="n">package_name</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">extra</span><span class="p">,</span> <span class="n">package_version</span> <span class="o">=</span> <span class="n">_find_optional_dependency</span><span class="p">(</span><span class="n">package_name</span><span class="o">=</span><span class="n">package_name</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&#39;</span><span class="si">{</span><span class="n">package_name</span><span class="si">}</span><span class="s2">&#39; is an optional dependency not included in the default &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;skforecast installation. Please run: `pip install </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">package_version</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">` to install it.&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Alternately, you can install it by running `pip install skforecast[</span><span class="si">{</span><span class="n">extra</span><span class="si">}</span><span class="s2">]`&quot;</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&#39;</span><span class="si">{</span><span class="n">package_name</span><span class="si">}</span><span class="s2">&#39; is needed but not installed. Please install it.&quot;</span>

        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.multivariate_time_series_corr"></a>
    <div class="doc doc-contents first">

      <p>Compute correlation between a time_series and the lagged values of other 
time series. </p>
<h3 id="skforecast.utils.utils.multivariate_time_series_corr--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.multivariate_time_series_corr--parameters" title="Permanent link">&para;</a></h3>
<p>time_series : pandas Series
    Target time series.
other : pandas DataFrame
    Time series whose lagged values are correlated to <code>time_series</code>.
lags : int, list, numpy ndarray
    Lags to be included in the correlation analysis.
method : str, default 'pearson'
    - 'pearson': standard correlation coefficient.
    - 'kendall': Kendall Tau correlation coefficient.
    - 'spearman': Spearman rank correlation.</p>
<h3 id="skforecast.utils.utils.multivariate_time_series_corr--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.multivariate_time_series_corr--returns" title="Permanent link">&para;</a></h3>
<p>corr : pandas DataFrame
    Correlation values.</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">multivariate_time_series_corr</span><span class="p">(</span>
    <span class="n">time_series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">lags</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">],</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span>
<span class="p">)</span><span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute correlation between a time_series and the lagged values of other </span>
<span class="sd">    time series. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    time_series : pandas Series</span>
<span class="sd">        Target time series.</span>
<span class="sd">    other : pandas DataFrame</span>
<span class="sd">        Time series whose lagged values are correlated to `time_series`.</span>
<span class="sd">    lags : int, list, numpy ndarray</span>
<span class="sd">        Lags to be included in the correlation analysis.</span>
<span class="sd">    method : str, default &#39;pearson&#39;</span>
<span class="sd">        - &#39;pearson&#39;: standard correlation coefficient.</span>
<span class="sd">        - &#39;kendall&#39;: Kendall Tau correlation coefficient.</span>
<span class="sd">        - &#39;spearman&#39;: Spearman rank correlation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    corr : pandas DataFrame</span>
<span class="sd">        Correlation values.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`time_series` and `other` must have the same length.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">time_series</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`time_series` and `other` must have the same index.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">lags</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span>

    <span class="n">corr</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">lag_values</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="n">lags</span><span class="p">:</span>
            <span class="n">lag_values</span><span class="p">[</span><span class="n">lag</span><span class="p">]</span> <span class="o">=</span> <span class="n">other</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span>

        <span class="n">lag_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lag_values</span><span class="p">)</span>
        <span class="n">lag_values</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">time_series</span><span class="p">)</span>
        <span class="n">corr</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">lag_values</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="n">corr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
    <span class="n">corr</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
    <span class="n">corr</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;lag&quot;</span>

    <span class="k">return</span> <span class="n">corr</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">

<a id="skforecast.utils.utils.check_backtesting_input"></a>
    <div class="doc doc-contents first">

      <p>This is a helper function to check most inputs of backtesting functions in 
modules <code>model_selection</code>, <code>model_selection_multiseries</code> and 
<code>model_selection_sarimax</code>.</p>
<h3 id="skforecast.utils.utils.check_backtesting_input--parameters">Parameters<a class="headerlink" href="#skforecast.utils.utils.check_backtesting_input--parameters" title="Permanent link">&para;</a></h3>
<p>forecaster : object
    Forecaster model.
steps : int, list
    Number of future steps predicted.
metric : str, Callable, list
    Metric used to quantify the goodness of fit of the model.
y : pandas Series
    Training time series for uni-series forecasters.
series : pandas DataFrame
    Training time series for multi-series forecasters.
initial_train_size : int, default <code>None</code>
    Number of samples in the initial train split. If <code>None</code> and <code>forecaster</code> 
    is already trained, no initial train is done and all data is used to 
    evaluate the model.
fixed_train_size : bool, default <code>True</code>
    If True, train size doesn't increase but moves by <code>steps</code> in each iteration.
gap : int, default <code>0</code>
    Number of samples to be excluded after the end of each training set and 
    before the test set.
allow_incomplete_fold : bool, default <code>True</code>
    Last fold is allowed to have a smaller number of samples than the 
    <code>test_size</code>. If <code>False</code>, the last fold is excluded.
refit : bool, default <code>False</code>
    Whether to re-fit the forecaster in each iteration.
interval : list, default <code>None</code>
    Confidence of the prediction interval estimated. Sequence of percentiles
    to compute, which must be between 0 and 100 inclusive.
alpha : float, default <code>None</code>
    The confidence intervals used in ForecasterSarimax are (1 - alpha) %. 
n_boot : int, default <code>500</code>
    Number of bootstrapping iterations used to estimate prediction
    intervals.
random_state : int, default <code>123</code>
    Sets a seed to the random generator, so that boot intervals are always 
    deterministic.
in_sample_residuals : bool, default <code>True</code>
    If <code>True</code>, residuals from the training data are used as proxy of prediction 
    error to create prediction intervals.  If <code>False</code>, out_sample_residuals 
    are used if they are already stored inside the forecaster.<br />
verbose : bool, default <code>False</code>
    Print number of folds and index of training and validation sets used 
    for backtesting.</p>
<div class="admonition show_progress">
<p class="admonition-title">bool, default <code>True</code></p>
<p>Whether to show a progress bar. Defaults to True.</p>
</div>
<h3 id="skforecast.utils.utils.check_backtesting_input--returns">Returns<a class="headerlink" href="#skforecast.utils.utils.check_backtesting_input--returns" title="Permanent link">&para;</a></h3>
<p>None</p>

        <details class="quote">
          <summary>Source code in <code>skforecast/utils/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_backtesting_input</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a helper function to check most inputs of backtesting functions in </span>
<span class="sd">    modules `model_selection`, `model_selection_multiseries` and </span>
<span class="sd">    `model_selection_sarimax`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : object</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    steps : int, list</span>
<span class="sd">        Number of future steps predicted.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series for uni-series forecasters.</span>
<span class="sd">    series : pandas DataFrame</span>
<span class="sd">        Training time series for multi-series forecasters.</span>
<span class="sd">    initial_train_size : int, default `None`</span>
<span class="sd">        Number of samples in the initial train split. If `None` and `forecaster` </span>
<span class="sd">        is already trained, no initial train is done and all data is used to </span>
<span class="sd">        evaluate the model.</span>
<span class="sd">    fixed_train_size : bool, default `True`</span>
<span class="sd">        If True, train size doesn&#39;t increase but moves by `steps` in each iteration.</span>
<span class="sd">    gap : int, default `0`</span>
<span class="sd">        Number of samples to be excluded after the end of each training set and </span>
<span class="sd">        before the test set.</span>
<span class="sd">    allow_incomplete_fold : bool, default `True`</span>
<span class="sd">        Last fold is allowed to have a smaller number of samples than the </span>
<span class="sd">        `test_size`. If `False`, the last fold is excluded.</span>
<span class="sd">    refit : bool, default `False`</span>
<span class="sd">        Whether to re-fit the forecaster in each iteration.</span>
<span class="sd">    interval : list, default `None`</span>
<span class="sd">        Confidence of the prediction interval estimated. Sequence of percentiles</span>
<span class="sd">        to compute, which must be between 0 and 100 inclusive.</span>
<span class="sd">    alpha : float, default `None`</span>
<span class="sd">        The confidence intervals used in ForecasterSarimax are (1 - alpha) %. </span>
<span class="sd">    n_boot : int, default `500`</span>
<span class="sd">        Number of bootstrapping iterations used to estimate prediction</span>
<span class="sd">        intervals.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random generator, so that boot intervals are always </span>
<span class="sd">        deterministic.</span>
<span class="sd">    in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of prediction </span>
<span class="sd">        error to create prediction intervals.  If `False`, out_sample_residuals </span>
<span class="sd">        are used if they are already stored inside the forecaster.  </span>
<span class="sd">    verbose : bool, default `False`</span>
<span class="sd">        Print number of folds and index of training and validation sets used </span>
<span class="sd">        for backtesting.</span>
<span class="sd">    show_progress: bool, default `True`</span>
<span class="sd">        Whether to show a progress bar. Defaults to True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">forecasters_uni</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoreg&#39;</span><span class="p">,</span> <span class="s1">&#39;ForecasterAutoregCustom&#39;</span><span class="p">,</span> 
                       <span class="s1">&#39;ForecasterAutoregDirect&#39;</span><span class="p">,</span> <span class="s1">&#39;ForecasterSarimax&#39;</span><span class="p">]</span>
    <span class="n">forecasters_multi</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> 
                         <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">,</span> 
                         <span class="s1">&#39;ForecasterAutoregMultiVariate&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">in</span> <span class="n">forecasters_uni</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`y` must be a pandas Series.&quot;</span><span class="p">)</span>
        <span class="n">data_name</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">in</span> <span class="n">forecasters_multi</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`series` must be a pandas DataFrame.&quot;</span><span class="p">)</span>
        <span class="n">data_name</span> <span class="o">=</span> <span class="s1">&#39;series&#39;</span>
        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">steps</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`steps` must be an integer greater than or equal to 1. Got </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gap</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">gap</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`gap` must be an integer greater than or equal to 0. Got </span><span class="si">{</span><span class="n">gap</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`metric` must be a string, a callable function, or a list containing &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;multiple strings and/or callables. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">initial_train_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If used, `initial_train_size` must be an integer greater than the &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;window_size of the forecaster. Got type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">initial_train_size</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">initial_train_size</span> <span class="o">&gt;=</span> <span class="n">data_length</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If used, `initial_train_size` must be an integer smaller &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;than the length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` (</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
            <span class="p">)</span>    
        <span class="k">if</span> <span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If used, `initial_train_size` must be an integer greater than &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;the window_size of the forecaster (</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">gap</span> <span class="o">&gt;=</span> <span class="n">data_length</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The combination of initial_train_size </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2"> and &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;gap </span><span class="si">{</span><span class="n">gap</span><span class="si">}</span><span class="s2"> cannot be greater than the length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ForecasterSarimax&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer smaller than the &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` (</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
            <span class="p">)</span>    
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">fitted</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
                    <span class="p">(</span><span class="s2">&quot;`forecaster` must be already trained if no `initial_train_size` &quot;</span>
                     <span class="s2">&quot;is provided.&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">refit</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;`refit` is only allowed when `initial_train_size` is not `None`.&quot;</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fixed_train_size</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`fixed_train_size` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">allow_incomplete_fold</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`allow_incomplete_fold` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">refit</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`refit` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n_boot</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">n_boot</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`n_boot` must be an integer greater than 0. Got </span><span class="si">{</span><span class="n">n_boot</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_state</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">random_state</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`random_state` must be an integer greater than 0. Got </span><span class="si">{</span><span class="n">random_state</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_sample_residuals</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`in_sample_residuals` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`verbose` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">show_progress</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`show_progress` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">interval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_incomplete_fold</span> <span class="ow">and</span> <span class="n">data_length</span> <span class="o">-</span> <span class="p">(</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">gap</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">steps</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There is not enough data to evaluate </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2"> steps in a single &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;fold. Set `allow_incomplete_fold` to `True` to allow incomplete folds.</span><span class="se">\n</span><span class="s2">&quot;</span>
             <span class="sa">f</span><span class="s2">&quot;    Data available for test : </span><span class="si">{</span><span class="n">data_length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gap</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
             <span class="sa">f</span><span class="s2">&quot;    Steps                   : </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>


  




                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="plot.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: plot" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              plot
            </div>
          </div>
        </a>
      
      
        
        <a href="exceptions.html" class="md-footer__link md-footer__link--next" aria-label="Next: exceptions" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              exceptions
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 - 2023 Joaquín Amat Rodrigo, Javier Escobar Ortiz
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  

<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input type="checkbox" class="md-toggle" id="__settings">
<div class="md-consent__settings">
  <ul class="task-list">
    
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        <label>
      </li>
    
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        <label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);console.log(new FormData(form)),__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top"], "search": "../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.37e9125f.min.js"></script>
      
    
  </body>
</html>